<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><meta name="theme-color" content="#123456"><meta name="generator" content="Hexo 4.2.0"><title>åˆ†ç±»: æ·±åº¦å­¦ä¹  - Hello, NilEra :-)</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hello, NilEra :-)"><meta name="msapplication-TileImage" content="/img/StarLogo.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hello, NilEra :-)"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="åŠªåŠ›åšè‡ªå·±å–œæ¬¢çš„äº‹"><meta property="og:type" content="blog"><meta property="og:title" content="Hello, NilEra :-)"><meta property="og:url" content="https://hello-nilera.com/"><meta property="og:site_name" content="Hello, NilEra :-)"><meta property="og:description" content="åŠªåŠ›åšè‡ªå·±å–œæ¬¢çš„äº‹"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hello-nilera.com/img/og_image.png"><meta property="article:author" content="NilEra"><meta property="article:tag" content="Hello NilEra"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://hello-nilera.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hello-nilera.com"},"headline":"Hello, NilEra :-)","image":["https://hello-nilera.com/img/og_image.png"],"author":{"@type":"Person","name":"NilEra"},"publisher":{"@type":"Organization","name":"Hello, NilEra :-)","logo":{"@type":"ImageObject","url":"https://hello-nilera.com/img/StarLogo.svg"}},"description":"åŠªåŠ›åšè‡ªå·±å–œæ¬¢çš„äº‹"}</script><link rel="icon" href="/img/StarLogo.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?249654dcf9a3bf70708fdfc6e2b1ec2b";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><meta name="msvalidate.01" content="F6BD78C6BD0096D2218CF88334111125"><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/StarLogo.svg" alt="Hello, NilEra :-)" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">ç›®å½•</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/about">å…³äº</a><a class="navbar-item" href="/me">æˆ‘</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/NilEra-K"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">åˆ†ç±»</a></li><li class="is-active"><a href="#" aria-current="page">æ·±åº¦å­¦ä¹ </a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-17T01:24:42.000Z" title="2024/8/17 09:24:42">2024-08-17</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-08-18T14:04:43.176Z" title="2024/8/18 22:04:43">2024-08-18</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Kaggle/">Kaggle</a></span><span class="level-item">13 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦1942ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/17/RSNA-2024/">RSNA-2024</a></p><div class="content"><h2 id="RSNA-2024-Lumbar-Spine-Degenerative-Classification-è…°æ¤é€€è¡Œæ€§åˆ†ç±»"><a href="#RSNA-2024-Lumbar-Spine-Degenerative-Classification-è…°æ¤é€€è¡Œæ€§åˆ†ç±»" class="headerlink" title="RSNA 2024 Lumbar Spine Degenerative Classification è…°æ¤é€€è¡Œæ€§åˆ†ç±»"></a>RSNA 2024 Lumbar Spine Degenerative Classification è…°æ¤é€€è¡Œæ€§åˆ†ç±»</h2><p>Classify lumbar spine degenerative conditionsï¼šå¯¹è…°æ¤é€€è¡Œæ€§ç–¾ç—…è¿›è¡Œåˆ†ç±»</p>
<p>[TOC]</p>
<h3 id="Overview-æ¦‚è¿°"><a href="#Overview-æ¦‚è¿°" class="headerlink" title="Overview æ¦‚è¿°"></a>Overview æ¦‚è¿°</h3><p><em>The goal of this competition is to create models that can be used to aid in the detection and classification of degenerative spine conditions using lumbar spine MR images. Competitors will develop models that simulate a radiologistâ€™s performance in diagnosing spine conditions.</em></p>
<p>æœ¬æ¬¡ç«èµ›çš„ç›®æ ‡æ˜¯åˆ›å»ºå¯ç”¨äºå¸®åŠ©ä½¿ç”¨è…°æ¤ MR å›¾åƒæ£€æµ‹å’Œåˆ†ç±»è„ŠæŸ±é€€è¡Œæ€§ç–¾ç—…çš„æ¨¡å‹ã€‚å‚èµ›è€…å°†å¼€å‘æ¨¡å‹æ¥æ¨¡æ‹Ÿæ”¾å°„ç§‘åŒ»ç”Ÿè¯Šæ–­è„ŠæŸ±ç–¾ç—…çš„è¡¨ç°ã€‚</p>
<h4 id="Description-æè¿°"><a href="#Description-æè¿°" class="headerlink" title="Description æè¿°"></a>Description æè¿°</h4><p><em>Low back pain is the leading cause of disability worldwide, according to the World Health Organization, affecting 619 million people in 2020. Most people experience low back pain at some point in their lives, with the frequency increasing with age. Pain and restricted mobility are often symptoms of spondylosis, a set of degenerative spine conditions including degeneration of intervertebral discs and subsequent narrowing of the spinal canal (spinal stenosis), subarticular recesses, or neural foramen with associated compression or irritations of the nerves in the low back.</em></p>
<p>æ ¹æ®ä¸–ç•Œå«ç”Ÿç»„ç»‡çš„æ•°æ®ï¼Œè…°ç—›æ˜¯å…¨çƒèŒƒå›´å†…å¯¼è‡´æ®‹ç–¾çš„ä¸»è¦åŸå› ï¼Œåˆ° 2020 å¹´ï¼Œè…°ç—›å°†å½±å“ 6.19 äº¿äººã€‚å¤§å¤šæ•°äººåœ¨ä¸€ç”Ÿä¸­çš„æŸä¸ªé˜¶æ®µéƒ½ä¼šç»å†è…°ç—›ï¼Œä¸”é¢‘ç‡éšç€å¹´é¾„çš„å¢é•¿è€Œå¢åŠ ã€‚ç–¼ç—›å’Œæ´»åŠ¨å—é™é€šå¸¸æ˜¯è„Šæ¤ç—…çš„ç—‡çŠ¶ï¼Œè¿™æ˜¯ä¸€ç»„é€€è¡Œæ€§è„ŠæŸ±ç–¾ç—…ï¼ŒåŒ…æ‹¬æ¤é—´ç›˜é€€å˜å’Œéšåçš„æ¤ç®¡å˜çª„ï¼ˆæ¤ç®¡ç‹­çª„ï¼‰ã€å…³èŠ‚ä¸‹éšçªæˆ–ç¥ç»å­”ï¼Œå¹¶ä¼´æœ‰ä¸‹è‚¢ç¥ç»å—å‹æˆ–åˆºæ¿€ã€‚</p>
<p><em>Magnetic resonance imaging (MRI) provides a detailed view of the lumbar spine vertebra, discs and nerves, enabling radiologists to assess the presence and severity of these conditions. Proper diagnosis and grading of these conditions help guide treatment and potential surgery to help alleviate back pain and improve overall health and quality of life for patients.</em></p>
<p>ç£å…±æŒ¯æˆåƒ (MRI) æä¾›è…°æ¤ã€æ¤é—´ç›˜å’Œç¥ç»çš„è¯¦ç»†è§†å›¾ï¼Œä½¿æ”¾å°„ç§‘åŒ»ç”Ÿèƒ½å¤Ÿè¯„ä¼°è¿™äº›ç—…ç—‡çš„å­˜åœ¨å’Œä¸¥é‡ç¨‹åº¦ã€‚å¯¹è¿™äº›ç—…ç—‡çš„æ­£ç¡®è¯Šæ–­å’Œåˆ†çº§æœ‰åŠ©äºæŒ‡å¯¼æ²»ç–—å’Œæ½œåœ¨çš„æ‰‹æœ¯ï¼Œä»¥å¸®åŠ©å‡è½»èƒŒç—›å¹¶æ”¹å–„æ‚£è€…çš„æ•´ä½“å¥åº·å’Œç”Ÿæ´»è´¨é‡ã€‚</p>
<p><em>RSNA has teamed with the <a target="_blank" rel="noopener" href="https://www.asnr.org/">American Society of Neuroradiology (ASNR)</a> to conduct this competition exploring whether artificial intelligence can be used to aid in the detection and classification of degenerative spine conditions using lumbar spine MR images.</em></p>
<p>RSNA ä¸<a target="_blank" rel="noopener" href="https://www.asnr.org/">ç¾å›½ç¥ç»æ”¾å°„å­¦ä¼š (ASNR)</a>åˆä½œä¸¾åŠäº†æœ¬æ¬¡ç«èµ›ï¼Œæ¢è®¨äººå·¥æ™ºèƒ½æ˜¯å¦å¯ä»¥åˆ©ç”¨è…°æ¤ MR å›¾åƒæ¥å¸®åŠ©æ£€æµ‹å’Œåˆ†ç±»è„ŠæŸ±é€€è¡Œæ€§ç–¾ç—…ã€‚</p>
<p><em>The challenge will focus on the classification of five lumbar spine degenerative conditions: Left Neural Foraminal Narrowing, Right Neural Foraminal Narrowing, Left Subarticular Stenosis, Right Subarticular Stenosis, and Spinal Canal Stenosis. For each imaging study in the dataset, weâ€™ve provided severity scores (Normal&#x2F;Mild, Moderate, or Severe) for each of the five conditions across the intervertebral disc levels L1&#x2F;L2, L2&#x2F;L3, L3&#x2F;L4, L4&#x2F;L5, and L5&#x2F;S1.</em></p>
<p>æŒ‘æˆ˜å°†é›†ä¸­äºäº”ç§è…°æ¤é€€è¡Œæ€§ç–¾ç—…çš„åˆ†ç±»ï¼šå·¦ç¥ç»æ¤é—´å­”ç‹­çª„ã€å³ç¥ç»æ¤é—´å­”ç‹­çª„ã€å·¦å…³èŠ‚ä¸‹ç‹­çª„ã€å³å…³èŠ‚ä¸‹ç‹­çª„å’Œæ¤ç®¡ç‹­çª„ã€‚å¯¹äºæ•°æ®é›†ä¸­çš„æ¯é¡¹å½±åƒå­¦ç ”ç©¶ï¼Œæˆ‘ä»¬ä¸ºæ¤é—´ç›˜ L1&#x2F;L2ã€L2&#x2F;L3ã€L3&#x2F;L4ã€L4&#x2F;L5 çº§åˆ«çš„äº”ç§æƒ…å†µä¸­çš„æ¯ä¸€ç§æä¾›äº†ä¸¥é‡æ€§è¯„åˆ†ï¼ˆæ­£å¸¸&#x2F;è½»åº¦ã€ä¸­åº¦æˆ–ä¸¥é‡ï¼‰å’Œ L5&#x2F;S1ã€‚</p>
<p><em>To create the ground truth dataset, the RSNA challenge planning task force collected imaging data sourced from eight sites on five continents. This multi-institutional, expertly curated dataset promises to improve standardized classification of degenerative lumbar spine conditions and enable development of tools to automate accurate and rapid disease classification.</em></p>
<p>ä¸ºäº†åˆ›å»ºå®å†µæ•°æ®é›†ï¼ŒRSNA æŒ‘æˆ˜è®¡åˆ’å·¥ä½œç»„æ”¶é›†äº†æ¥è‡ªäº”å¤§æ´²å…«ä¸ªç«™ç‚¹çš„æˆåƒæ•°æ®ã€‚è¿™ä¸ªå¤šæœºæ„ã€ä¸“ä¸šç­–åˆ’çš„æ•°æ®é›†æœ‰æœ›æ”¹å–„é€€è¡Œæ€§è…°æ¤ç–¾ç—…çš„æ ‡å‡†åŒ–åˆ†ç±»ï¼Œå¹¶æ”¯æŒå¼€å‘è‡ªåŠ¨åŒ–å‡†ç¡®ã€å¿«é€Ÿçš„ç–¾ç—…åˆ†ç±»å·¥å…·ã€‚</p>
<p><em>Challenge winners will be recognized at an event during the RSNA 2024 annual meeting. For more information on the challenge, contact RSNA Informatics staff at <a href="mailto:informatics@rsna.org">informatics@rsna.org</a>.</em></p>
<p>æŒ‘æˆ˜èµ›è·èƒœè€…å°†åœ¨ RSNA 2024 å¹´å¹´ä¼šæœŸé—´çš„æ´»åŠ¨ä¸­è·å¾—è¡¨å½°ã€‚æœ‰å…³æŒ‘æˆ˜çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è”ç³» RSNA ä¿¡æ¯å­¦å·¥ä½œäººå‘˜ï¼š <a href="mailto:informatics@rsna.org">informatics@rsna.org</a> ã€‚</p>
<h4 id="Evaluation-è¯„ä¼°"><a href="#Evaluation-è¯„ä¼°" class="headerlink" title="Evaluation è¯„ä¼°"></a>Evaluation è¯„ä¼°</h4><p><em>Submissions are evaluated using the average of sample weighted log losses and an <code>any_severe_spinal</code> prediction generated by the metric. The <a target="_blank" rel="noopener" href="https://www.kaggle.com/code/metric/rsna-lumbar-metric-71549">metric notebook can be found here</a>.</em></p>
<p>ä½¿ç”¨æ ·æœ¬åŠ æƒå¯¹æ•°æŸå¤±çš„å¹³å‡å€¼å’Œç”±è¯¥æŒ‡æ ‡ç”Ÿæˆçš„<code>any_severe_spinal</code>é¢„æµ‹æ¥è¯„ä¼°æäº¤çš„ç»“æœã€‚<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/metric/rsna-lumbar-metric-71549">å…¬åˆ¶ç¬”è®°æœ¬å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°</a>ã€‚</p>
<p><em>The sample weights are as follows:</em></p>
<p>æ ·æœ¬æƒé‡å¦‚ä¸‹ï¼š</p>
<ul>
<li>1 for normal&#x2F;mild. 1 ä¸ºæ­£å¸¸&#x2F;è½»åº¦ã€‚</li>
<li>2 for moderate. 2ä¸ºä¸­ç­‰ã€‚</li>
<li>4 for severe. 4ä¸ºä¸¥é‡ã€‚</li>
</ul>
<p><em>For each row ID in the test set, you must predict a probability for each of the different severity levels. The file should contain a header and have the following format:</em></p>
<p>å¯¹äºæµ‹è¯•é›†ä¸­çš„æ¯ä¸ªè¡Œ IDï¼Œæ‚¨å¿…é¡»é¢„æµ‹æ¯ä¸ªä¸åŒä¸¥é‡æ€§çº§åˆ«çš„æ¦‚ç‡ã€‚è¯¥æ–‡ä»¶åº”åŒ…å«æ ‡å¤´å¹¶å…·æœ‰ä»¥ä¸‹æ ¼å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">row_id,normal_mild,moderate,severe</span><br><span class="line">123456_left_neural_foraminal_narrowing_l1_l2,0.333,0.333,0.333</span><br><span class="line">123456_left_neural_foraminal_narrowing_l2_l3,0.333,0.333,0.333</span><br><span class="line">123456_left_neural_foraminal_narrowing_l3_l4,0.333,0.333,0.333</span><br><span class="line">etc.</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>row_id</th>
<th>normal_mild</th>
<th>moderate</th>
<th>severe</th>
</tr>
</thead>
<tbody><tr>
<td>123456_left_neural_foraminal_narrowing_l1_l2</td>
<td>0.333</td>
<td>0.333</td>
<td>0.333</td>
</tr>
<tr>
<td>123456_left_neural_foraminal_narrowing_l2_l3</td>
<td>0.333</td>
<td>0.333</td>
<td>0.333</td>
</tr>
<tr>
<td>123456_left_neural_foraminal_narrowing_l3_l4</td>
<td>0.333</td>
<td>0.333</td>
<td>0.333</td>
</tr>
<tr>
<td>etc.</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><em>In rare cases the lowest vertebrae arenâ€™t visible in the imagery. You still need to make predictions (nulls will cause errors), but those rows will not be scored.</em></p>
<p>åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå›¾åƒä¸­çœ‹ä¸åˆ°æœ€ä½çš„æ¤éª¨ã€‚æ‚¨ä»ç„¶éœ€è¦è¿›è¡Œé¢„æµ‹ï¼ˆç©ºå€¼ä¼šå¯¼è‡´é”™è¯¯ï¼‰ï¼Œä½†è¿™äº›è¡Œä¸ä¼šè¢«è¯„åˆ†ã€‚</p>
<p><em>For this competition, the</em> <code>any_severe_scalar</code> <em>has been set to</em> <code>1.0</code>.</p>
<p>å¯¹äºæœ¬æ¬¡æ¯”èµ›ï¼Œ<code>any_severe_scalar</code>å·²è®¾ç½®ä¸º<code>1.0</code> ã€‚</p>
<h3 id="Dataset-Description-æ•°æ®é›†æè¿°"><a href="#Dataset-Description-æ•°æ®é›†æè¿°" class="headerlink" title="Dataset Description æ•°æ®é›†æè¿°"></a>Dataset Description æ•°æ®é›†æè¿°</h3><p>The goal of this competition is to identify medical conditions affecting the lumbar spine in MRI scans.<br>æœ¬æ¬¡æ¯”èµ›çš„ç›®æ ‡æ˜¯é€šè¿‡ MRI æ‰«æè¯†åˆ«å½±å“è…°æ¤çš„åŒ»ç–—çŠ¶å†µã€‚</p>
<p>This competition uses a hidden test. When your submitted notebook is scored, the actual test data (including a full length sample submission) will be made available to your notebook.<br>æœ¬æ¬¡æ¯”èµ›é‡‡ç”¨éšè—æµ‹è¯•æ–¹å¼ã€‚å½“æ‚¨æäº¤çš„ç¬”è®°æœ¬ç”µè„‘è¢«è¯„åˆ†æ—¶ï¼Œå®é™…çš„æµ‹è¯•æ•°æ®ï¼ˆåŒ…æ‹¬å®Œæ•´é•¿åº¦çš„æ ·æœ¬æäº¤ï¼‰å°†æä¾›ç»™æ‚¨çš„ç¬”è®°æœ¬ç”µè„‘ã€‚</p>
<h4 id="Files-æ–‡ä»¶"><a href="#Files-æ–‡ä»¶" class="headerlink" title="Files æ–‡ä»¶"></a>Files æ–‡ä»¶</h4><p><strong>train.csv</strong> <em>Labels for the train set</em>. è®­ç»ƒé›†çš„æ ‡ç­¾ã€‚</p>
<ul>
<li><code>study_id</code> - <em>The study ID. Each study may include multiple series of images.</em><br><code>study_id</code> - ç ”ç©¶ IDï¼Œæ¯ä¸ªç ”ç©¶å¯èƒ½åŒ…æ‹¬å¤šä¸ªç³»åˆ—çš„å›¾åƒã€‚</li>
<li><code>[condition]_[level]</code> - <em>The target labels, such as</em> <code>spinal_canal_stenosis_l1_l2</code> <em>, with the severity levels of</em> <code>Normal/Mild</code><em>,</em> <code>Moderate</code> <em>, or</em> <code>Severe</code> <em>. Some entries have incomplete labels.</em><br><code>[condition]_[level]</code> - ç›®æ ‡æ ‡ç­¾ï¼Œä¾‹å¦‚<code>spinal_canal_stenosis_l1_l2</code> ï¼Œä¸¥é‡ç¨‹åº¦çº§åˆ«ä¸º <code>Normal/Mild</code> ã€ <code>Moderate</code> æˆ– <code>Severe</code>ã€‚æœ‰äº›æ¡ç›®çš„æ ‡ç­¾ä¸å®Œæ•´ã€‚</li>
</ul>
<p><strong>train_label_coordinates.csv<br>è®­ç»ƒæ ‡ç­¾åæ ‡.csv</strong></p>
<ul>
<li><code>study_id</code></li>
<li><code>series_id</code> - The imagery series ID.<br><code>series_id</code> - å›¾åƒç³»åˆ— IDã€‚</li>
<li><code>instance_number</code> - The imageâ€™s order number within the 3D stack.<br><code>instance_number</code> - å›¾åƒåœ¨ 3D å †æ ˆä¸­çš„é¡ºåºå·ã€‚</li>
<li><code>condition</code> - There are three core conditions: spinal canal stenosis, neural_foraminal_narrowing, and subarticular_stenosis. The latter two are considered for each side of the spine.<br><code>condition</code> - å…±æœ‰ä¸‰ç§æ ¸å¿ƒç—…ç—‡ï¼šæ¤ç®¡ç‹­çª„ã€ç¥ç»æ¤é—´å­”ç‹­çª„å’Œå…³èŠ‚ä¸‹ç‹­çª„ã€‚è„ŠæŸ±çš„æ¯ä¸€ä¾§éƒ½è€ƒè™‘åä¸¤è€…ã€‚</li>
<li><code>level</code> - The relevant vertebrae, such as <code>l3_l4</code><br><code>level</code> - ç›¸å…³æ¤éª¨ï¼Œä¾‹å¦‚<code>l3_l4</code></li>
<li><code>[x/y]</code> - The x&#x2F;y coordinates for the center of the area that defined the label.<br><code>[x/y]</code> - å®šä¹‰æ ‡ç­¾çš„åŒºåŸŸä¸­å¿ƒçš„ x&#x2F;y åæ ‡ã€‚</li>
</ul>
<p><strong>sample_submission.csv æ ·æœ¬æäº¤.csv</strong></p>
<ul>
<li><code>row_id</code> - A slug of the study ID, condition, and level such as <code>12345_spinal_canal_stenosis_l3_l4</code>.<br><code>row_id</code> - ç ”ç©¶ IDã€æ¡ä»¶å’Œçº§åˆ«çš„ slugï¼Œä¾‹å¦‚<code>12345_spinal_canal_stenosis_l3_l4</code> ã€‚</li>
<li><code>[normal_mild/moderate/severe]</code> - The three prediction columns.<br><code>[normal_mild/moderate/severe]</code> - ä¸‰ä¸ªé¢„æµ‹åˆ—ã€‚</li>
</ul>
<p><strong>[train&#x2F;test]_images&#x2F;[study_id]&#x2F;[series_id]&#x2F;[instance_number].dcm</strong> The imagery data.å›¾åƒæ•°æ®ã€‚</p>
<p><strong>[train&#x2F;test]_series_descriptions.csv</strong></p>
<ul>
<li><p><code>study_id</code></p>
</li>
<li><p><code>series_id</code></p>
</li>
<li><p><code>series_description</code> The scanâ€™s orientation.<br><code>series_description</code> æ‰«ææ–¹å‘ã€‚</p>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-13T12:19:01.000Z" title="2024/8/13 20:19:01">2024-08-13</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-08-14T11:24:28.794Z" title="2024/8/14 19:24:28">2024-08-14</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></span><span class="level-item">6 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦857ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/13/Deploy-LLMs-ON-Linux/">Deploy_LLMs_ON_Linux</a></p><div class="content"><h2 id="å¦‚ä½•åœ¨-Linux-æœåŠ¡å™¨ä¸Šæ­å»ºæœ¬åœ°LLMs-ğŸ¤”"><a href="#å¦‚ä½•åœ¨-Linux-æœåŠ¡å™¨ä¸Šæ­å»ºæœ¬åœ°LLMs-ğŸ¤”" class="headerlink" title="å¦‚ä½•åœ¨ Linux æœåŠ¡å™¨ä¸Šæ­å»ºæœ¬åœ°LLMs ğŸ¤”"></a>å¦‚ä½•åœ¨ Linux æœåŠ¡å™¨ä¸Šæ­å»ºæœ¬åœ°LLMs ğŸ¤”</h2><p>å¦‚ä½•åœ¨ <code>Linux</code> æœåŠ¡å™¨ä¸Šéƒ¨ç½²å¤§è¯­è¨€æ¨¡å‹ï¼Œä»¥ <code>qwen1_5-32b-chat-q8_k_0</code> ä¸ºä¾‹ã€‚æœåŠ¡å™¨ä½¿ç”¨æ˜¾å¡ <code>A4000</code>ï¼Œé¢„ç®—ï¼š$5950$ å…ƒã€‚</p>
<h3 id="æ­å»º-qwen1-5-32b-chat-q8-k-0"><a href="#æ­å»º-qwen1-5-32b-chat-q8-k-0" class="headerlink" title="æ­å»º qwen1_5-32b-chat-q8_k_0"></a>æ­å»º <code>qwen1_5-32b-chat-q8_k_0</code></h3><ol>
<li><p>ä¸‹è½½ ğŸ¤—<code>Hugging Face</code> åº“ï¼Œè¿™ä¸ªåº“ä¸»è¦æ˜¯ç”¨äºä¸‹è½½æ¨¡å‹ä½¿ç”¨ã€‚å½“ç„¶ä¸ºäº†ä¿è¯é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>wget</code> å‘½ä»¤æ›¿ä»£ä»–ã€‚å¦‚æœä½ å†³å®šä½¿ç”¨ <code>wget</code> å‘½ä»¤ï¼Œä½ å¯ä»¥é€‰æ‹©è·³è¿‡è¿™ä¸€æ­¥ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹å¼åœ¨ç¬¬äº”æ­¥å‘ˆç°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ pip install huggingface_hub</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…æ˜¯ç›´æ¥ä¸‹è½½ <code>modelscope</code> åº“ï¼Œä½¿ç”¨ <code>modelscope</code> ä¸‹è½½æ¨¡å‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ pip install modelscope</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºä¸€ä¸ª <code>LocalGit</code> æ–‡ä»¶å¤¹ï¼Œå¹¶è¿›å…¥è¯¥æ–‡ä»¶å¤¹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ <span class="built_in">mkdir</span> LocalGit</span><br><span class="line">(base) âœ  ~ <span class="built_in">cd</span> LocalGit</span><br><span class="line">(base) âœ  LocalGit </span><br></pre></td></tr></table></figure>
</li>
<li><p>å…‹éš† <code>llama.cpp</code> çš„ä»“åº“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  LocalGit git <span class="built_in">clone</span> https://github.com/ggerganov/llama.cpp</span><br><span class="line">(base) âœ  LocalGit <span class="built_in">cd</span> llama.cpp</span><br><span class="line">(base) âœ  llama.cpp git:(master)</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æœ‰ <code>GPU</code> çš„ç¯å¢ƒä¸‹ç¼–è¯‘ <code>llama.cpp</code></p>
<p><strong>å‰ç½®æ¡ä»¶ï¼š</strong>å®‰è£… <code>nvcc</code> + <code>cmake</code></p>
<p>æ‰§è¡Œä»£ç è¿›è¡Œç¼–è¯‘ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) make LLAMA_CUBLAS=1 LLAMA_CUDA_NVCC=/usr/local/cuda/bin/nvcc</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°é”™è¯¯ï¼š<code>(base) âœ  llama.cpp git:(master) make LLAMA_CUBLAS=1 LLAMA_CUDA_NVCC=/usr/local/cuda/bin/nvcc Makefile:76: *** LLAMA_CUBLAS is removed. Use GGML_CUDA instead..  Stop.</code></p>
<p>ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) make GGML_CUDA=1 LLAMA_CUDA_NVCC=/usr/local/cuda/bin/nvcc</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä»¥ä¸‹å‘½ä»¤æ·»åŠ å‚æ•° <code>j</code>ï¼Œ<code>j</code> åé¢çš„æ•°å­—è¡¨ç¤ºåŒæ—¶ç¼–è¯‘çš„çº¿ç¨‹æ•°ï¼ˆå¯æ ¹æ® <code>CPU</code> æ ¸æ•°å†³å®šï¼‰ï¼Œå®æµ‹èƒ½ç¼©çŸ­çº¦ $1&#x2F;3$ çš„æ—¶é—´ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) make -j6 GGML_CUDA=1 LLAMA_CUDA_NVCC=/usr/local/cuda/bin/nvcc</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸‹è½½ç›¸åº”çš„æ¨¡å‹</p>
<p>â‘  ä½¿ç”¨ <code>Hugging Face</code> ä¸‹è½½ç›¸åº”æ¨¡å‹ï¼Œå®æµ‹æœåŠ¡å™¨ç½‘é€Ÿåœ¨ <code>3M~6M</code> å·¦å³ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ huggingface-cli download Qwen/Qwen1.5-32B-Chat-GGUF qwen1_5-32b-chat-q8_0.gguf --local-dir . --local-dir-use-symlinks False</span><br></pre></td></tr></table></figure>

<p>â‘¡ ä½¿ç”¨ <code>wget</code> ä¸‹è½½ <code>modelscope</code> çš„æ¨¡å‹æ–‡ä»¶ï¼Œå®æµ‹ç½‘é€Ÿåœ¨ <code>10M~22M</code> å·¦å³ï¼Œè¿™éœ€è¦ä½ å…ˆè·å–åˆ°æ¨¡å‹çš„ä¸‹è½½é“¾æ¥ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ wget https://www.modelscope.cn/models/qwen/Qwen1.5-32B-Chat-GGUF/resolve/master/qwen1_5-32b-chat-q8_0.gguf</span><br></pre></td></tr></table></figure>

<p>â‘¢ ç›´æ¥ä½¿ç”¨ <code>modelscope</code> åº“ä¸‹è½½æ¨¡å‹ï¼Œå®æµ‹ç½‘é€Ÿåœ¨ <code>18M~65M</code> å·¦å³ï¼Œå…·ä½“æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  ~ <span class="built_in">cd</span> LocalGit </span><br><span class="line">(base) âœ  LocalGit <span class="built_in">mkdir</span> models</span><br><span class="line">(base) âœ  LocalGit <span class="built_in">cd</span> models</span><br><span class="line">(base) âœ  models modelscope download --model=qwen/Qwen2-7B-Instruct-GGUF --local_dir . qwen2-7b-instruct-q8_0.gguf</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ <code>llama.cpp</code> çš„ç›¸å…³å‘½ä»¤è¿›è¡Œæ“ä½œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) ./main -m ../models/qwen1_5-32b-chat-q8_0.gguf -n 512 --color -i -cml -f prompts/chat-with-qwen.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) ./llama-server -m ../models/qwen1_5-32b-chat-q8_0.gguf -ngl 80 -fa</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯ <code>Qwen2-7B-Instruct-GGUF</code>ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://www.modelscope.cn/models/qwen/qwen2-7b-instruct-gguf">Qwen2-7B-Instruct-GGUF Â· æ¨¡å‹åº“ â€” Qwen2-7B-Instruct-GGUF Â· æ¨¡å‹åº“ (modelscope.cn)</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) âœ  llama.cpp git:(master) ./llama-server -m qwen2-7b-instruct-q8_0.gguf -ngl 29 -fa</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¼å®¹ <code>OpenAI API</code>ï¼Œä½¿ç”¨ <code>Python</code> ä»£ç æµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import openai</span><br><span class="line"></span><br><span class="line">client = openai.OpenAI(</span><br><span class="line">    base_url=<span class="string">&quot;http://localhost:8080/v1&quot;</span>, <span class="comment"># &quot;http://&lt;Your api-server IP&gt;:port&quot;</span></span><br><span class="line">    api_key = <span class="string">&quot;sk-no-key-required&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">completion = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;qwen&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant.&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;tell me something about michael jordan&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(completion.choices[0].message.content)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‘½ä»¤å¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./llama-cli -m qwen2-7b-instruct-q5_k_m.gguf \</span><br><span class="line">  -n 512 -co -i -<span class="keyword">if</span> -f prompts/chat-with-qwen.txt \</span><br><span class="line">  --in-prefix <span class="string">&quot;&lt;|im_start|&gt;user\n&quot;</span> \</span><br><span class="line">  --in-suffix <span class="string">&quot;&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant\n&quot;</span> \</span><br><span class="line">  -ngl 24 -fa</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="æ‹“å±•è¡¥å……"><a href="#æ‹“å±•è¡¥å……" class="headerlink" title="æ‹“å±•è¡¥å……"></a>æ‹“å±•è¡¥å……</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/shebao3333/article/details/139428868">Llama.cppå¤§æ¨¡å‹é‡åŒ–ç®€æ˜æ‰‹å†Œ_llamacppé‡åŒ–-CSDNåšå®¢</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-12T15:10:23.000Z" title="2024/8/12 23:10:23">2024-08-12</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-08-13T09:55:49.971Z" title="2024/8/13 17:55:49">2024-08-13</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></span><span class="level-item">2 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦226ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/12/Windows-Build-llama-cpp/">Windows Build llama.cpp</a></p><div class="content"><h2 id="Windows-å¹³å°ä¸‹æ„å»º-llama-cpp"><a href="#Windows-å¹³å°ä¸‹æ„å»º-llama-cpp" class="headerlink" title="Windows å¹³å°ä¸‹æ„å»º llama.cpp"></a>Windows å¹³å°ä¸‹æ„å»º <code>llama.cpp</code></h2><p>åœ¨ä½¿ç”¨ <code>LM-Studio</code> æ—¶ï¼Œå¯¹äºä¸€äº›å‚æ•°é‡ä¸æ˜¯å¾ˆå¤§çš„æ¨¡å‹æ¥è¯´ï¼Œå¤§å¤šæ•°ä¸éœ€è¦è¿›è¡Œæ¨¡å‹çš„åˆå¹¶ï¼Œå¦‚ <code>qwen2-7b</code> ç­‰ã€‚è¿™äº›æ¨¡å‹å¾€å¾€åªéœ€è¦ä¸‹è½½ååŠ è½½åˆ° <code>LM-Studio</code> ä¸­å³å¯ã€‚</p>
<p>ä½†æ˜¯å¯¹äºå‚æ•°é‡å¾ˆå¤§çš„æ¨¡å‹ï¼Œå¦‚ <code>qwen2-72b-instruct</code> ç­‰ï¼Œå› ä¸ºæ¨¡å‹æ–‡ä»¶è¾ƒå¤§ä¸åˆ©äºä¼ è¾“ï¼Œå› æ­¤æ¨¡å‹å¼€å‘è€…å¯èƒ½ä¼šä½¿ç”¨ <code>llama.cpp</code> å¯¹ <code>GGUF</code> æ¨¡å‹è¿›è¡Œæ‹†åˆ†ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åœ¨ä¸‹è½½æ¨¡å‹æ—¶å°±éœ€è¦è¿›è¡Œæ¨¡å‹çš„åˆå¹¶ã€‚</p>
<p><code>qwen2-72b-instruct</code> åœ¨ <code>q8</code> é‡åŒ–ç»™å‡ºäº†ä¸¤ä¸ªæ¨¡å‹æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">qwen2-72b-instruct-q8_k_m-00001-of-00002.gguf</span><br><span class="line">qwen2-72b-instruct-q8_k_m-00002-of-00002.gguf</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ä½¿ç”¨è¿™äº›åˆ†å‰²åçš„ <code>GGUF</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>llama-gguf-split</code> åˆå¹¶ä»–ä»¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">llama-gguf-spilt --merge input.gguf output.gguf</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-05T02:37:16.000Z" title="2024/8/5 10:37:16">2024-08-05</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-08-14T10:13:32.001Z" title="2024/8/14 18:13:32">2024-08-14</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></span><span class="level-item">8 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦1240ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/05/Deploy-LLMs-ON-PC/">Deploy_LLMs_ON_PC</a></p><div class="content"><h2 id="å¦‚ä½•æ­å»ºè¿è¡Œåœ¨æœ¬åœ°çš„-LLMs-ğŸ¤”"><a href="#å¦‚ä½•æ­å»ºè¿è¡Œåœ¨æœ¬åœ°çš„-LLMs-ğŸ¤”" class="headerlink" title="å¦‚ä½•æ­å»ºè¿è¡Œåœ¨æœ¬åœ°çš„ LLMs ğŸ¤”"></a>å¦‚ä½•æ­å»ºè¿è¡Œåœ¨æœ¬åœ°çš„ LLMs ğŸ¤”</h2><p>[TOC]</p>
<h3 id="ğŸ¤—-1-åŸºäº-LM-Studio"><a href="#ğŸ¤—-1-åŸºäº-LM-Studio" class="headerlink" title="ğŸ¤— 1. åŸºäº LM-Studio"></a>ğŸ¤— 1. åŸºäº <code>LM-Studio</code></h3><ol>
<li><p>è®¿é—® <code>LM-Studio</code>ï¼Œç½‘å€ï¼š<a target="_blank" rel="noopener" href="https://lmstudio.ai/">LM Studio - Discover, download, and run local LLMs</a></p>
<p>ä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„å®‰è£…åŒ…ï¼Œç„¶ååŒå‡»è¿è¡Œå³å¯ã€‚</p>
</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/LM_Studio_Website.png">

<ol start="2">
<li>è®¿é—® <code>ModelScope</code><a target="_blank" rel="noopener" href="https://community.modelscope.cn/">é­”æ­ç¤¾åŒº</a> æˆ–è€… ğŸ¤—<code>Hugging Face</code><a target="_blank" rel="noopener" href="https://huggingface.co/">Hugging Face</a>ï¼Œè¿™é‡Œä»¥ <code>ModelScope</code> ä¸ºä¾‹ï¼Œè¿›å…¥æ¨¡å‹åº“ï¼Œä¸‹è½½ç›¸åº”æ¨¡å‹ã€‚</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/ModelScope.png">

<center>é­”æ­ç¤¾åŒºå®˜ç½‘</center>

<img src="./Deploy_LLMs_ON_PC/ModelScopeDownloadModels.png">

<center>æ‰¾åˆ°éœ€è¦çš„æ¨¡å‹å¹¶ä¸‹è½½</center>

<ol start="3">
<li>ä¸‹è½½å¥½å“åº”çš„æ¨¡å‹åï¼Œå°†æ¨¡å‹ç»„ç»‡å¥½ï¼Œæ”¾åˆ°ç›¸åº”çš„æ–‡ä»¶å¤¹ä¸­ï¼Œè¿™é‡ŒæŒ‰ç…§ <code>models/Publisher/Repository/*.gguf</code> çš„è·¯å¾„ç»„ç»‡æ¨¡å‹è·¯å¾„ï¼Œç„¶åé€‰æ‹© <code>Change</code> æ›´æ”¹æ¨¡å‹çš„ä½ç½®ã€‚å¦‚æœä¸æŒ‰ç…§è¯¥è·¯å¾„ç»„ç»‡ï¼Œåˆ™ä¼šå‡ºç° <code>You have 1 uncategorized model files.</code> é”™è¯¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/Error_With_Wrong_Project_Structure.png">

<img src="./Deploy_LLMs_ON_PC/LM_Studio_Change_ModelFile.png">

<ol start="4">
<li>ä½†æ˜¯é‚£ç§æ–¹å¼æ˜¯ä¸å¤ªæ¨èçš„ï¼Œæˆ‘ä»¬ç»„ç»‡ <code>USER/MODEL_NAME/*.gguf</code> çš„ç»“æ„ï¼Œè¿™ç§ç»“æ„ä¼šæ¯”è¾ƒæ˜äº†ï¼š</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/LM_Studio_Change_ModelFile0002.png">

<ol start="5">
<li>å®Œæˆæ¨¡å‹æ–‡ä»¶çš„ä¸‹è½½å’Œç»„ç»‡åï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥èŠå¤©é¡µé¢ï¼Œé€‰æ‹©æ¨¡å‹è¿›è¡ŒåŠ è½½ã€‚è¿™é‡Œä¸ºäº†èŠ‚çº¦ç©ºé—´ï¼Œæˆ‘åˆ é™¤äº† <code>nilera/Qwen1.5-7B-Chat-Q4-GGUF</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/SelectAModel2Load.png">

<ol start="6">
<li>é€‰æ‹©æ¨¡å‹åŠ è½½ï¼Œç­‰å¾…åŠ è½½å®Œæˆå³å¯åƒå¹³æ—¶ä½¿ç”¨å…¶ä»–å¤§æ¨¡å‹çš„æ—¶å€™ä¸€æ ·ä½¿ç”¨è¿™äº›æ¨¡å‹ã€‚</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/LM_Studio_Change_Test_qwen1_5.png">

<ol start="7">
<li>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨æˆ‘ä»¬çš„å¤§æ¨¡å‹åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€‰æ‹© <code>LM-Studio</code> çš„ <code>Local Server</code> èœå•é¡¹ï¼Œé€‰æ‹© <code>Start Server</code> å³å¯éƒ¨ç½²åˆ°ä¸€ä¸ªæœ¬åœ°æŒ‡å®šçš„ç«¯å£ï¼ˆé»˜è®¤æ˜¯ <code>1234</code>ï¼‰ã€‚</li>
</ol>
<img src="./Deploy_LLMs_ON_PC/LM_Studio_Change_Start_Local_Server0001.png">

<img src="./Deploy_LLMs_ON_PC/LM_Studio_Change_Start_Local_Server_0002.png">

<ol start="8">
<li>å³ä¾§æœ‰è®¸å¤šæ ·ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€æ®µæ ·ä¾‹ï¼Œå¦‚ï¼š<code>chat(python)</code>ï¼Œè¿™é‡Œå¯¹è¿™æ®µä»£ç è¿›è¡Œç®€å•çš„è§£é‡Šã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example: reuse your existing OpenAI setup</span></span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line"><span class="comment"># Point to the local server</span></span><br><span class="line">client = OpenAI(base_url=<span class="string">&quot;http://localhost:1234/v1&quot;</span>, api_key=<span class="string">&quot;lm-studio&quot;</span>)</span><br><span class="line"></span><br><span class="line">completion = client.chat.completions.create(</span><br><span class="line">  model=<span class="string">&quot;Publisher/Repository&quot;</span>,									<span class="comment"># å¯ä»¥ç†è§£ä¸ºæ¨¡å‹è·¯å¾„, è¿™é‡Œä»¥å¯åŠ¨åœ¨è¿™ä¸ªç«¯å£çš„æ¨¡å‹ä¸ºå‡†</span></span><br><span class="line">  messages=[</span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Always answer in Chinese.&quot;</span>&#125;,	<span class="comment"># ç³»ç»Ÿè®¾ç½®: æ¯æ¬¡éƒ½ç”¨ä¸­æ–‡å›ç­”</span></span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Introduce yourself.&quot;</span>&#125;			<span class="comment"># å¯¹è¯è®¾ç½®: è¿™é‡Œå¸Œæœ› AI ä»‹ç»ä¸€ä¸‹ä»–è‡ªå·±</span></span><br><span class="line">  ],</span><br><span class="line">  temperature=<span class="number">0.7</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(completion.choices[<span class="number">0</span>].message)							<span class="comment"># è·å–æ¨¡å‹çš„å›å¤</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ <code>Python</code> è°ƒç”¨æˆ‘ä»¬çš„æœ¬åœ°å¤§æ¨¡å‹äº†ã€‚</li>
</ol>
<h3 id="â›µ-2-ä½¿ç”¨-PowerInfer-æ¡†æ¶"><a href="#â›µ-2-ä½¿ç”¨-PowerInfer-æ¡†æ¶" class="headerlink" title="â›µ 2. ä½¿ç”¨ PowerInfer æ¡†æ¶"></a>â›µ 2. ä½¿ç”¨ <code>PowerInfer</code> æ¡†æ¶</h3><p><code>PowerInfer</code> æ¡†æ¶ <em>GitHub</em> é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/SJTU-IPADS/PowerInfer">SJTU-IPADS&#x2F;PowerInfer: High-speed Large Language Model Serving on PCs with Consumer-grade GPUs (github.com)</a></p>
<p>$2024$ å¹´å‘å¸ƒè®ºæ–‡ <code>PowerInfer-2</code>ï¼š<font color=Blue>[</font><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2406.06282">2406.06282] PowerInfer-2: Fast Large Language Model Inference on a Smartphone (arxiv.org)</a></p>
<p><code>Anaconda</code> å‘½ä»¤ä½¿ç”¨ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/miracleoa/article/details/106115730">ã€anacondaã€‘condaåˆ›å»ºã€æŸ¥çœ‹ã€åˆ é™¤è™šæ‹Ÿç¯å¢ƒï¼ˆanacondaå‘½ä»¤é›†ï¼‰_conda åˆ›å»ºç¯å¢ƒ-CSDNåšå®¢</a></p>
<p>å‚è€ƒåšå®¢ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42232045/article/details/135113112">å¤§æ¨¡å‹ç¬”è®°ä¹‹-3090æ˜¾å¡æ¨ç†70Bå‚æ•°æ¨¡å‹|åŸºäºPowerInfer ä¸€ä¸ª CPU&#x2F;GPU LLM æ¨ç†å¼•æ“-CSDNåšå®¢</a></p>
<ol>
<li>ä½¿ç”¨ <code>Conda</code> åˆ›å»ºç¯å¢ƒï¼Œè¿™é‡Œ Python ç‰ˆæœ¬éœ€è¦å¤§äº <code>3.8</code>ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n powerinfer1 python=3.8</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æ¿€æ´» <code>Conda</code> ç¯å¢ƒï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate powerinfer1</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å…‹éš† <code>PowerInfer</code> æ¡†æ¶ä»£ç ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:SJTU-IPADS/PowerInfer.git</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>å®‰è£…æ‰€éœ€ä¾èµ–ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>ä½¿ç”¨ <code>CMake</code> è¿›è¡Œç¼–è¯‘ï¼ˆ<code>CMake</code> ç‰ˆæœ¬éœ€è¦å¤§äºï¼š<code>3.17+</code>ï¼‰</p>
<p>è¿™é‡Œå¾ˆå¤§æ¦‚ç‡å¯èƒ½ä¼šå‡ºç°ç¼–è¯‘å™¨ç‰ˆæœ¬ä¸ CUDA ç‰ˆæœ¬ä¸ä¸€è‡´çš„æƒ…å†µï¼Œè§£å†³æ–¹æ¡ˆï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/lishiyu93/article/details/114599859">fatal error C1189: #error: â€“ unsupported Microsoft Visual Studio version! - CSDNåšå®¢</a></p>
<p>è¿™é‡Œæˆ‘æœ‰ä¸‰ä¸ª <code>CUDA</code> ç‰ˆæœ¬ï¼Œè²Œä¼¼ä¿®æ”¹å…¶ä¸­ä»»æ„ä¸€ä¸ªå°±å¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä¿®æ”¹çš„æ˜¯ <code>CUDA v11.6</code> ç‰ˆæœ¬ã€‚</p>
<p>â‘  å¦‚æœæ˜¯ <code>NVIDIA GPUs</code>ï¼Œéœ€è¦ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œç¼–è¯‘ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -S . -B build -DLLAMA_CUBLAS=ON</span><br><span class="line">cmake --build build --config Release</span><br></pre></td></tr></table></figure>

<p>â‘¡ å¦‚æœæ˜¯ <code>AMD GPUs</code>ï¼Œéœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Replace &#x27;1100&#x27; to your card architecture name, you can get it by rocminfo</span></span><br><span class="line">CC=/opt/rocm/llvm/bin/clang CXX=/opt/rocm/llvm/bin/clang++ cmake -S . -B build -</span><br><span class="line">DLLAMA_HIPBLAS=ON -DAMDGPU_TARGETS=gfx1100</span><br><span class="line">cmake --build build --config Release</span><br></pre></td></tr></table></figure>

<p>â‘¢ å¦‚æœæ˜¯ <code>CPU ONLY</code>ï¼Œéœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è¿›è¡Œç¼–è¯‘ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmake -S . -B build</span><br><span class="line">cmake --build build --config Release</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘æœ‰ä¸€å— <code>Nvidia 1050ti</code> æ‰€ä»¥æˆ‘ä½¿ç”¨<strong>æ–¹å¼ â‘ </strong>è¿›è¡Œç¼–è¯‘ã€‚</p>
</li>
<li><p>å¯¹äºæˆ‘ä»¬ä¸‹è½½çš„æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨æä¾›çš„æ–¹å¼è¿›è¡Œè½¬åŒ–ï¼Œè½¬åŒ–ä¸º PowerInfer å¯ä»¥ä½¿ç”¨çš„ç±»å‹ï¼š</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># make sure that you have done `pip install -r requirements.txt`</span></span><br><span class="line">python convert.py --outfile /PATH/TO/POWERINFER/GGUF/REPO/MODELNAME.powerinfer.gguf /PATH/TO/ORIGINAL/MODEL /PATH/TO/PREDICTOR</span><br><span class="line"><span class="comment"># python convert.py --outfile ./ReluLLaMA-70B-PowerInfer-GGUF/llama-70b-relu.powerinfer.gguf ./SparseLLM/ReluLLaMA-70B ./PowerInfer/ReluLLaMA-70B-Predictor</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python convert.py --outfile D:/LMStudio/models/Publisher/Repository/qwen1_5-7b-chat-q4_0.gguf ./SparseLLM/ReluLLaMA-70B ./PowerInfer/ReluLLaMA-70B-Predictor</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>æˆ–è€…å°†è¦ åŸå§‹æ¨¡å‹è½¬åŒ–ä¸º GGUF æ¨¡å‹</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python convert-dense.py --outfile /PATH/TO/DENSE/GGUF/REPO/MODELNAME.gguf /PATH/TO/ORIGINAL/MODEL</span><br></pre></td></tr></table></figure>

<ol start="8">
<li>è¿è¡Œæ¨¡å‹</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./build/bin/Release/main.exe -m C:/Users/NilEra/Downloads/llama-7b-relu.powerinfer.gguf -n 128 -t 2 -p <span class="string">&quot;Once upon a time&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­/home/user/data/ReluLLaMA-70B-PowerInfer-GGUF/llama-70b-relu.q4.powerinfer.ggufä¸ºGPTQé‡åŒ–è¿‡çš„æ¨¡å‹æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<ol start="9">
<li>ä¸€äº›é—®é¢˜ï¼š</li>
</ol>
<p><img src="/./Deploy_LLMs_ON_PC/Issues22.png" alt="Issus22"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-08-01T07:29:16.000Z" title="2024/8/1 15:29:16">2024-08-01</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-08-13T12:18:19.674Z" title="2024/8/13 20:18:19">2024-08-13</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></span><span class="level-item">2 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦289ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/08/01/LLM-General-Education/">LLM_General_Education</a></p><div class="content"><h2 id="ğŸ¤—-å¤§è¯­è¨€æ¨¡å‹é€šè¯†"><a href="#ğŸ¤—-å¤§è¯­è¨€æ¨¡å‹é€šè¯†" class="headerlink" title="ğŸ¤— å¤§è¯­è¨€æ¨¡å‹é€šè¯†"></a>ğŸ¤— å¤§è¯­è¨€æ¨¡å‹é€šè¯†</h2><h3 id="å¤§è¯­è¨€æ¨¡å‹çš„é…ç½®éœ€æ±‚"><a href="#å¤§è¯­è¨€æ¨¡å‹çš„é…ç½®éœ€æ±‚" class="headerlink" title="å¤§è¯­è¨€æ¨¡å‹çš„é…ç½®éœ€æ±‚"></a>å¤§è¯­è¨€æ¨¡å‹çš„é…ç½®éœ€æ±‚</h3><p>é¦–å…ˆè¦ææ¸…æ¥šï¼Œæœ¬åœ°å¯ä»¥éƒ¨ç½²ä»€ä¹ˆå¤§æ¨¡å‹ï¼Œå–å†³äºä¸ªäººç”µè„‘çš„ç¡¬ä»¶é…ç½®ï¼Œå°¤å…¶éœ€è¦å…³æ³¨ <code>GPU</code> çš„æ˜¾å­˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªè¦æœ¬åœ°æœºå™¨ <code>GPU</code> çš„æ˜¾å­˜èƒ½å¤Ÿæ»¡è¶³å¤§æ¨¡å‹çš„è¦æ±‚ï¼Œé‚£åŸºæœ¬ä¸Šéƒ½å¯ä»¥æœ¬åœ°éƒ¨ç½²ã€‚</p>
<p>é‚£ä¹ˆå¤§æ¨¡å‹ç±»åˆ«è¿™ä¹ˆå¤šï¼Œæœ‰ $7B$ã€$13B$ã€$70B$ ç­‰ç­‰ï¼Œ<code>GPU</code> æ˜¾å­˜å¦‚ä½•å‡†å¤‡å‘¢ï¼Ÿ</p>
<p>åœ¨æ²¡æœ‰è€ƒè™‘ä»»ä½•æ¨¡å‹é‡åŒ–æŠ€æœ¯çš„å‰æä¸‹ï¼Œæœ‰å…¬å¼å¦‚ä¸‹ï¼š<br>$$<br>GB &#x3D; B Ã— 2<br>$$</p>
<p>å…¶ä¸­ä¸º $GB$ æ¨¡å‹æ˜¾å­˜å ç”¨ï¼Œ$B$ ä¸ºå¤§æ¨¡å‹å‚æ•°é‡ã€‚</p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv33371756/">AIå¤§æ¨¡å‹æœ¬åœ°åŒ–éƒ¨ç½²Q&#x2F;Aç¡¬ä»¶ç¯‡</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35054222/article/details/139123564">å¦‚ä½•æ‰¾åˆ°æœ€æ–°çš„å¤§æ¨¡å‹ã€å¦‚ä½•åˆ¤æ–­æœ¬åœ°ç¡¬ä»¶æ˜¯å¦æ»¡è¶³å¤§æ¨¡å‹éœ€æ±‚ã€å¦‚ä½•å¿«é€Ÿéƒ¨ç½²å¤§æ¨¡å‹</a></p>
<p><a target="_blank" rel="noopener" href="https://www.datalearner.com/ai-models/leaderboard/datalearner-llm-leaderboard">å¤§æ¨¡å‹ç»¼åˆè¯„æµ‹å¯¹æ¯” | å½“å‰ä¸»æµå¤§æ¨¡å‹åœ¨å„è¯„æµ‹æ•°æ®é›†ä¸Šçš„è¡¨ç°æ€»æ¦œå• | æ•°æ®å­¦ä¹  (DataLearner)</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-05-19T08:33:06.000Z" title="2024/5/19 16:33:06">2024-05-19</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-07-29T07:32:43.979Z" title="2024/7/29 15:32:43">2024-07-29</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Kaggle/">Kaggle</a></span><span class="level-item">38 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦5697ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/05/19/BELKA-2024/">BELKA_2024</a></p><div class="content"><p>[TOC]</p>
<h1 id="Leash-Bio-Predict-New-Medicines-with-BELKA"><a href="#Leash-Bio-Predict-New-Medicines-with-BELKA" class="headerlink" title="Leash Bio - Predict New Medicines with BELKA"></a>Leash Bio - Predict New Medicines with BELKA</h1><p>ç”¨ <em><strong>BELKA</strong></em> é¢„æµ‹æ–°è¯</p>
<p>Predict small molecule-protein interactions using the Big Encoded Library for Chemical Assessment (BELKA)</p>
<p>ä½¿ç”¨åŒ–å­¦è¯„ä¼°å¤§ç¼–ç åº“ï¼ˆBELKAï¼‰é¢„æµ‹å°åˆ†å­è›‹ç™½è´¨ç›¸äº’ä½œç”¨</p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>In this competition, youâ€™ll develop machine learning (ML) models to predict the binding affinity of small molecules to specific protein targets â€“ a critical step in drug development for the pharmaceutical industry that would pave the way for more accurate drug discovery. Youâ€™ll help predict which drug-like small molecules (chemicals) will bind to three possible protein targets.</p>
<p>åœ¨è¿™åœºæ¯”èµ›ä¸­ï¼Œä½ å°†å¼€å‘æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰æ¨¡å‹æ¥é¢„æµ‹å°åˆ†å­ä¸ç‰¹å®š<strong>è›‹ç™½è´¨é¶æ ‡ï¼ˆç›®æ ‡è›‹ç™½ï¼‰</strong>çš„ç»“åˆäº²å’ŒåŠ›â€”â€”è¿™æ˜¯åˆ¶è¯è¡Œä¸šè¯ç‰©å¼€å‘çš„å…³é”®ä¸€æ­¥ï¼Œå°†ä¸ºæ›´å‡†ç¡®çš„è¯ç‰©å‘ç°é“ºå¹³é“è·¯ã€‚ä½ å°†å¸®åŠ©é¢„æµ‹å“ªç§è¯ç‰©æ ·çš„å°åˆ†å­ï¼ˆåŒ–å­¦ç‰©è´¨ï¼‰å°†ä¸ä¸‰ç§å¯èƒ½çš„è›‹ç™½è´¨é¶ç‚¹ç»“åˆã€‚</p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>Small molecule drugs are chemicals that interact with cellular protein machinery and affect the functions of this machinery in some way. Often, drugs are meant to inhibit the activity of single protein targets, and those targets are thought to be involved in a disease process. A classic approach to identify such candidate molecules is to physically make them, one by one, and then expose them to the protein target of interest and test if the two interact. This can be a fairly laborious and time-intensive process.</p>
<p><em>å°åˆ†å­è¯ç‰©æ˜¯ä¸ç»†èƒè›‹ç™½è´¨æœºåˆ¶ç›¸äº’ä½œç”¨å¹¶ä»¥æŸç§æ–¹å¼å½±å“è¯¥æœºåˆ¶åŠŸèƒ½çš„åŒ–å­¦ç‰©è´¨ã€‚é€šå¸¸ï¼Œè¯ç‰©æ—¨åœ¨æŠ‘åˆ¶å•ä¸ªè›‹ç™½è´¨é¶æ ‡çš„æ´»æ€§ï¼Œè€Œè¿™äº›é¶æ ‡è¢«è®¤ä¸ºä¸ç–¾ç—…è¿‡ç¨‹æœ‰å…³ã€‚è¯†åˆ«è¿™ç±»å€™é€‰åˆ†å­çš„ä¸€ç§ç»å…¸æ–¹æ³•æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿›è¡Œç‰©ç†åˆ¶é€ ï¼Œç„¶åå°†å…¶æš´éœ²äºæ„Ÿå…´è¶£çš„è›‹ç™½è´¨é¶ç‚¹ï¼Œå¹¶æµ‹è¯•ä¸¤è€…æ˜¯å¦ç›¸äº’ä½œç”¨ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªç›¸å½“è´¹åŠ›å’Œè€—æ—¶çš„è¿‡ç¨‹ã€‚</em></p>
<p>The US Food and Drug Administration (FDA) has approved roughly <a target="_blank" rel="noopener" href="https://www.fda.gov/drugs/development-approval-process-drugs/new-drugs-fda-cders-new-molecular-entities-and-new-therapeutic-biological-products">2,000 novel molecular entities</a> in its <a target="_blank" rel="noopener" href="https://www.fda.gov/about-fda/histories-fda-regulated-products/summary-nda-approvals-receipts-1938-present">entire history</a>. However, the number of chemicals in druglike space has been <a target="_blank" rel="noopener" href="https://www.nature.com/articles/432823a">estimated to be 10^60</a>, a space far too big to physically search. There are likely effective treatments for human ailments hiding in that chemical space, and better methods to find such treatments are desirable to us all.</p>
<p><em>ç¾å›½é£Ÿå“è¯å“ç›‘ç£ç®¡ç†å±€ï¼ˆFDAï¼‰å·²ç»æ‰¹å‡†äº†å¤§çº¦<a target="_blank" rel="noopener" href="https://www.fda.gov/drugs/development-approval-process-drugs/new-drugs-fda-cders-new-molecular-entities-and-new-therapeutic-biological-products">2000ç§æ–°å‹åˆ†å­å®ä½“</a>åœ¨å…¶<a target="_blank" rel="noopener" href="https://www.fda.gov/about-fda/histories-fda-regulated-products/summary-nda-approvals-receipts-1938-present">æ•´ä¸ªå†å²</a>. ç„¶è€Œï¼Œç±»è¯ç‰©é¢†åŸŸçš„åŒ–å­¦ç‰©è´¨æ•°é‡<a target="_blank" rel="noopener" href="https://www.nature.com/articles/432823a">ä¼°è®¡ä¸º$10^60$</a>ï¼Œè¿™ä¸ªç©ºé—´å¤ªå¤§äº†ï¼Œæ— æ³•è¿›è¡Œç‰©ç†æœç´¢ã€‚åœ¨è¿™ä¸ªåŒ–å­¦ç©ºé—´é‡Œï¼Œå¯èƒ½æœ‰æœ‰æ•ˆçš„æ²»ç–—äººç±»ç–¾ç—…çš„æ–¹æ³•ï¼Œè€Œæ‰¾åˆ°æ›´å¥½çš„æ²»ç–—æ–¹æ³•å¯¹æˆ‘ä»¬æ‰€æœ‰äººæ¥è¯´éƒ½æ˜¯å¯å–çš„ã€‚</em></p>
<p>To evaluate potential search methods in small molecule chemistry, competition host Leash Biosciences physically tested some 133M small molecules for their ability to interact with one of three protein targets using DNA-encoded chemical library (DEL) technology. This dataset, the Big Encoded Library for Chemical Assessment (BELKA), provides an excellent opportunity to develop predictive models that may advance drug discovery.</p>
<p><em>ä¸ºäº†è¯„ä¼°å°åˆ†å­åŒ–å­¦ä¸­æ½œåœ¨çš„æœç´¢æ–¹æ³•ï¼Œæ¯”èµ›ä¸»åŠæ–¹Leash Biosciencesä½¿ç”¨DNAç¼–ç åŒ–å­¦æ–‡åº“ï¼ˆDELï¼‰æŠ€æœ¯å¯¹çº¦133Mä¸ªå°åˆ†å­è¿›è¡Œäº†ç‰©ç†æµ‹è¯•ï¼Œä»¥ç¡®å®šå®ƒä»¬ä¸ä¸‰ä¸ªè›‹ç™½è´¨é¶æ ‡ä¹‹ä¸€ç›¸äº’ä½œç”¨çš„èƒ½åŠ›ã€‚è¯¥æ•°æ®é›†ï¼Œå³åŒ–å­¦è¯„ä¼°å¤§ç¼–ç åº“ï¼ˆBELKAï¼‰ï¼Œä¸ºå¼€å‘å¯èƒ½ä¿ƒè¿›è¯ç‰©å‘ç°çš„é¢„æµ‹æ¨¡å‹æä¾›äº†æå¥½çš„æœºä¼šã€‚</em></p>
<p>Datasets of this size are rare and restricted to large pharmaceutical companies. The current best-curated public dataset of this kind is perhaps <a target="_blank" rel="noopener" href="https://www.bindingdb.org/rwd/bind/index.jsp">bindingdb</a>, which, at 2.8M binding measurements, is much smaller than BELKA.</p>
<p><em>è¿™ç§è§„æ¨¡çš„æ•°æ®é›†éå¸¸ç½•è§ï¼Œä»…é™äºå¤§å‹åˆ¶è¯å…¬å¸ã€‚ç›®å‰è¿™ç±»æœ€å¥½çš„å…¬å…±æ•°æ®é›†å¯èƒ½æ˜¯<a target="_blank" rel="noopener" href="https://www.bindingdb.org/rwd/bind/index.jsp">bindingdb</a>ï¼Œåœ¨2.8Mçš„ç»“åˆæµ‹é‡å€¼ä¸‹ï¼Œæ¯”BELKAå°å¾—å¤šã€‚</em></p>
<p>This competition aims to revolutionize small molecule binding prediction by harnessing ML techniques. Recent advances in ML approaches suggest it might be possible to search chemical space by inference using well-trained computational models rather than running <a target="_blank" rel="noopener" href="https://blog.research.google/2020/06/unlocking-chemome-with-dna-encoded.html">laboratory</a> <a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acs.jmedchem.0c00452">experiments</a>. Similar progress in <a target="_blank" rel="noopener" href="https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf">other</a> <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">fields</a> suggest using ML to search across vast spaces could be a generalizable approach applicable to many domains. We hope that by providing BELKA we will democratize aspects of computational drug discovery and assist the community in finding new lifesaving medicines.</p>
<p><em>è¿™é¡¹ç«èµ›æ—¨åœ¨é€šè¿‡åˆ©ç”¨MLæŠ€æœ¯å½»åº•æ”¹å˜å°åˆ†å­ç»“åˆé¢„æµ‹ã€‚MLæ–¹æ³•çš„æœ€æ–°è¿›å±•è¡¨æ˜ï¼Œä½¿ç”¨è®­ç»ƒæœ‰ç´ çš„è®¡ç®—æ¨¡å‹è€Œä¸æ˜¯è¿›è¡Œ<a target="_blank" rel="noopener" href="https://blog.research.google/2020/06/unlocking-chemome-with-dna-encoded.html">å®éªŒå®¤</a> <a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acs.jmedchem.0c00452">å®éªŒ</a>ï¼Œé€šè¿‡æ¨ç†æœç´¢åŒ–å­¦ç©ºé—´æ˜¯å¯èƒ½çš„ã€‚<a target="_blank" rel="noopener" href="https://proceedings.neurips.cc/paper_files/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf">å…¶ä»–</a> <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1706.03762">é¢†åŸŸ</a>çš„ç±»ä¼¼è¿›å±•è¡¨æ˜ï¼Œä½¿ç”¨MLåœ¨å¹¿é˜”çš„ç©ºé—´ä¸­æœç´¢å¯èƒ½æ˜¯ä¸€ç§é€‚ç”¨äºè®¸å¤šé¢†åŸŸçš„é€šç”¨æ–¹æ³•ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡æä¾›BELKAï¼Œæˆ‘ä»¬å°†ä½¿è®¡ç®—è¯ç‰©å‘ç°çš„å„ä¸ªæ–¹é¢æ°‘ä¸»åŒ–ï¼Œå¹¶å¸®åŠ©ç¤¾åŒºå¯»æ‰¾æ–°çš„æ•‘å‘½è¯ç‰©ã€‚</em></p>
<p>Here, youâ€™ll build predictive models to estimate the binding affinity of unknown chemical compounds to specified protein targets. You may use the training data provided; alternatively, there are a number of methods to make small molecule binding predictions without relying on empirical binding data (e.g. <a target="_blank" rel="noopener" href="https://github.com/gcorso/DiffDock">DiffDock</a>, and this contest was designed to allow for such submissions).</p>
<p><em>åœ¨è¿™é‡Œï¼Œä½ å°†å»ºç«‹é¢„æµ‹æ¨¡å‹æ¥ä¼°è®¡æœªçŸ¥åŒ–åˆç‰©ä¸ç‰¹å®šè›‹ç™½è´¨é¶æ ‡çš„ç»“åˆäº²å’ŒåŠ›ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æä¾›çš„åŸ¹è®­æ•°æ®ï¼›æˆ–è€…ï¼Œæœ‰è®¸å¤šæ–¹æ³•å¯ä»¥åœ¨ä¸ä¾èµ–ç»éªŒç»“åˆæ•°æ®çš„æƒ…å†µä¸‹è¿›è¡Œå°åˆ†å­ç»“åˆé¢„æµ‹ï¼ˆä¾‹å¦‚<a target="_blank" rel="noopener" href="https://github.com/gcorso/DiffDock">DiffDock</a>ï¼Œè€Œæœ¬æ¬¡ç«èµ›æ—¨åœ¨å…è®¸æ­¤ç±»æäº¤ï¼‰ã€‚</em></p>
<p>Your work will contribute to advances in small molecule chemistry used to accelerate drug discovery.</p>
<p><em>ä½ çš„å·¥ä½œå°†æœ‰åŠ©äºä¿ƒè¿›ç”¨äºåŠ é€Ÿè¯ç‰©å‘ç°çš„å°åˆ†å­åŒ–å­¦çš„è¿›æ­¥ã€‚</em></p>
<h2 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h2><p>This metric for this competition is the average precision calculated for each (protein, split group) and then averaged for the final score. Please see this <a target="_blank" rel="noopener" href="https://www.kaggle.com/competitions/leash-BELKA/discussion/503232">forum post</a> for important details.</p>
<p><em>è¿™é¡¹æ¯”èµ›çš„æŒ‡æ ‡æ˜¯ä¸ºæ¯ä¸ªï¼ˆè›‹ç™½è´¨ã€åˆ†ç»„ï¼‰è®¡ç®—çš„å¹³å‡ç²¾åº¦ï¼Œç„¶åä¸ºæœ€ç»ˆå¾—åˆ†å–å¹³å‡å€¼ã€‚è¯·å‚é˜…æ­¤<a target="_blank" rel="noopener" href="https://www.kaggle.com/competitions/leash-BELKA/discussion/503232">è®ºå›å¸–å­</a>äº†è§£é‡è¦ç»†èŠ‚ã€‚</em></p>
<p>Hereâ€™s the <a target="_blank" rel="noopener" href="https://www.kaggle.com/code/metric/leash-average-map">code</a> for the implementation.</p>
<p><em>è¿™æ˜¯<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/metric/leash-average-map">ä»£ç </a>ä»¥ä¾›å®æ–½ã€‚</em></p>
<h3 id="Submission-File"><a href="#Submission-File" class="headerlink" title="Submission File"></a>Submission File</h3><p>For each <code>id</code> in the test set, you must predict a probability for the binary target <code>binds</code> target. The file should contain a header and have the following format:</p>
<p><em>å¯¹äºæµ‹è¯•é›†ä¸­çš„æ¯ä¸ª</em><code>id</code>ï¼Œ<em>æ‚¨å¿…é¡»é¢„æµ‹äºŒè¿›åˆ¶ç›®æ ‡â€œç»‘å®šâ€ç›®æ ‡çš„æ¦‚ç‡ã€‚è¯¥æ–‡ä»¶åº”åŒ…å«ä¸€ä¸ªæ ‡å¤´ï¼Œå¹¶å…·æœ‰ä»¥ä¸‹æ ¼å¼ï¼š</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id,binds</span><br><span class="line">295246830,0.5</span><br><span class="line">295246831,0.5</span><br><span class="line">295246832,0.5</span><br><span class="line">etc.</span><br></pre></td></tr></table></figure>

<h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul>
<li><strong>April 4, 2024</strong> - Start Date.</li>
<li><strong>July 1, 2024</strong> - Entry Deadline. You must accept the competition rules before this date in order to compete.</li>
<li><strong>July 1, 2024</strong> - Team Merger Deadline. This is the last day participants may join or merge teams.</li>
<li><strong>July 8, 2024</strong> - Final Submission Deadline.</li>
</ul>
<p>All deadlines are at 11:59 PM UTC on the corresponding day unless otherwise noted. The competition organizers reserve the right to update the contest timeline if they deem it necessary.</p>
<h2 id="Prizes"><a href="#Prizes" class="headerlink" title="Prizes"></a>Prizes</h2><ul>
<li>First Prize: $12,000</li>
<li>Second Prize: $10,000</li>
<li>Third Prize: $10,000</li>
<li>Fourth Prize: $8,000</li>
<li>Fifth Prize: $5,000</li>
<li>Top Student Group: $5,000 to the highest performing student team. A team would be considered a student team if majority members (e.g. at least 3 out of a 5 member team) are students enrolled in a high school or university degree. In the case of an even number of members, half of them must be students.</li>
</ul>
<h2 id="Competition-Host"><a href="#Competition-Host" class="headerlink" title="Competition Host"></a>Competition Host</h2><p><a target="_blank" rel="noopener" href="https://www.leash.bio/">Leash Biosciences</a> is a discovery-stage biotechnology company that seeks to improve medicinal chemistry with machine learning approaches and massive data collection. Leash is comprised of wet lab scientists and dry lab scientists in equal numbers, and is proudly headquartered in Salt Lake City, Utah, USA.</p>
<h2 id="Additional-Details"><a href="#Additional-Details" class="headerlink" title="Additional Details"></a>Additional Details</h2><h3 id="Chemical-Representations"><a href="#Chemical-Representations" class="headerlink" title="Chemical Representations"></a>Chemical Representations</h3><p>One of the goals of this competition is to explore and compare many different ways of representing molecules. Small molecules <a target="_blank" rel="noopener" href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-020-00460-5">have</a> <a target="_blank" rel="noopener" href="https://wires.onlinelibrary.wiley.com/doi/10.1002/wcms.1603">been</a> [represented](<a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acsinfocus.7e7006?ref=infocus/AI_&">https://pubs.acs.org/doi/10.1021/acsinfocus.7e7006?ref=infocus%2FAI_&amp;</a> Machine Learning) <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10689004/">with</a> SMILES, graphs, 3D structures, and more, including more esoteric methods <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.10130">such as spherical convolutional neural nets</a>. We encourage competitors to explore not only different methods of making predictions but also to try different ways of representing the molecules.</p>
<p>We provide the molecules in SMILES format.</p>
<p><em>è¿™åœºæ¯”èµ›çš„ç›®æ ‡ä¹‹ä¸€æ˜¯æ¢ç´¢å’Œæ¯”è¾ƒè®¸å¤šä¸åŒçš„åˆ†å­è¡¨ç°æ–¹å¼ã€‚å°åˆ†å­å·²ç»ç”¨SMILESã€å›¾å½¢ã€3Dç»“æ„ç­‰è¡¨ç¤ºï¼ŒåŒ…æ‹¬æ›´æ·±å¥¥çš„æ–¹æ³•ï¼Œå¦‚çƒå½¢å·ç§¯ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬é¼“åŠ±ç«äº‰å¯¹æ‰‹ä¸ä»…æ¢ç´¢ä¸åŒçš„é¢„æµ‹æ–¹æ³•ï¼Œè¿˜å°è¯•ä¸åŒçš„åˆ†å­è¡¨ç¤ºæ–¹æ³•ã€‚</em></p>
<p><em>æˆ‘ä»¬æä¾›SMILESæ ¼å¼çš„åˆ†å­ã€‚</em></p>
<h3 id="SMILES"><a href="#SMILES" class="headerlink" title="SMILES"></a>SMILES</h3><p>SMILES is a concise string notation used to represent the structure of chemical molecules. It encodes the molecular graph, including atoms, bonds, connectivity, and stereochemistry as a linear sequence of characters, by traversing the molecule graph. SMILES is widely used in machine learning applications for chemistry, such as molecular property prediction, drug discovery, and materials design, as it provides a standardized and machine-readable format for representing and manipulating chemical structures.</p>
<p>The SMILES in this dataset should be sufficient to be translated into any other chemical representation format that you want to try. A simple way to perform some of these translations is with <a target="_blank" rel="noopener" href="https://www.rdkit.org/docs/GettingStartedInPython.html">RDKit</a>.</p>
<p><em>SMILESæ˜¯ä¸€ç§ç®€æ˜çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ³•ï¼Œç”¨äºè¡¨ç¤ºåŒ–å­¦åˆ†å­çš„ç»“æ„ã€‚å®ƒé€šè¿‡éå†åˆ†å­å›¾ï¼Œå°†åˆ†å­å›¾ï¼ˆåŒ…æ‹¬åŸå­ã€é”®ã€è¿æ¥æ€§å’Œç«‹ä½“åŒ–å­¦ï¼‰ç¼–ç ä¸ºçº¿æ€§å­—ç¬¦åºåˆ—ã€‚SMILESå¹¿æ³›ç”¨äºåŒ–å­¦çš„æœºå™¨å­¦ä¹ åº”ç”¨ï¼Œå¦‚åˆ†å­æ€§è´¨é¢„æµ‹ã€è¯ç‰©å‘ç°å’Œææ–™è®¾è®¡ï¼Œå› ä¸ºå®ƒä¸ºè¡¨ç¤ºå’Œæ“çºµåŒ–å­¦ç»“æ„æä¾›äº†æ ‡å‡†åŒ–å’Œæœºå™¨å¯è¯»çš„æ ¼å¼ã€‚</em><br><em>è¯¥æ•°æ®é›†ä¸­çš„SMILESåº”è¯¥è¶³ä»¥è½¬æ¢ä¸ºæ‚¨æƒ³è¦å°è¯•çš„ä»»ä½•å…¶ä»–åŒ–å­¦è¡¨ç¤ºæ ¼å¼ã€‚æ‰§è¡Œå…¶ä¸­ä¸€äº›ç¿»è¯‘çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨<a target="_blank" rel="noopener" href="https://www.rdkit.org/docs/GettingStartedInPython.html">RDKit</a>.</em></p>
<h3 id="Details-about-the-experiments"><a href="#Details-about-the-experiments" class="headerlink" title="Details about the experiments"></a>Details about the experiments</h3><h3 id="DELs-are-libraries-of-small-molecules-with-unique-DNA-barcodes-covalently-attached"><a href="#DELs-are-libraries-of-small-molecules-with-unique-DNA-barcodes-covalently-attached" class="headerlink" title="DELs are libraries of small molecules with unique DNA barcodes covalently attached"></a>DELs are libraries of small molecules with unique DNA barcodes covalently attached</h3><p>Traditional <a target="_blank" rel="noopener" href="https://www.nature.com/articles/nrd3368">high-throughput screening</a> requires keeping individual small molecules in separate, identifiable tubes and demands a lot of liquid handling to test each one of those against the protein target of interest in a separate reaction. The logistical overhead of these efforts tends to restrict screening collections, called libraries, to 50K-5M small molecules. A scalable solution to this problem, DNA-encoded chemical libraries, was <a target="_blank" rel="noopener" href="https://www.nature.com/articles/nchembio.211">described in 2009</a>. As DNA sequencing got <a target="_blank" rel="noopener" href="https://www.genome.gov/about-genomics/fact-sheets/Sequencing-Human-Genome-cost">cheaper and cheaper</a>, it became clear that DNA itself could be used as a label to identify, and deconvolute, collections of molecules in a complex mixture. <a target="_blank" rel="noopener" href="https://www.nature.com/articles/s41573-023-00713-6">DELs</a> <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8369695/">leverage</a> this DNA sequencing technology.</p>
<p>These barcoded small molecules are in a pool (many in a single tube, rather than one tube per small molecule) and are exposed to the protein target of interest in solution. The protein target of interest is then rinsed to remove small molecules in the DEL that donâ€™t bind the target, and the remaining binders are collected and their DNA sequenced.</p>
<p><strong>DELæ˜¯å…±ä»·è¿æ¥æœ‰ç‹¬ç‰¹DNAæ¡å½¢ç çš„å°åˆ†å­åº“</strong><br><em>ä¼ ç»Ÿ<a target="_blank" rel="noopener" href="https://www.nature.com/articles/nrd3368">é«˜é€šé‡ç­›é€‰</a>éœ€è¦å°†å•ä¸ªå°åˆ†å­ä¿æŒåœ¨å•ç‹¬çš„ã€å¯è¯†åˆ«çš„ç®¡ä¸­ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æ¶²ä½“å¤„ç†æ¥åœ¨å•ç‹¬çš„ååº”ä¸­é’ˆå¯¹æ„Ÿå…´è¶£çš„è›‹ç™½è´¨é¶æ ‡æµ‹è¯•å…¶ä¸­çš„æ¯ä¸€ä¸ªã€‚è¿™äº›å·¥ä½œçš„åå‹¤å¼€é”€å¾€å¾€å°†ç­›é€‰æ”¶è—ï¼ˆç§°ä¸ºæ–‡åº“ï¼‰é™åˆ¶åœ¨5000ä¸‡è‡³500ä¸‡ä¸ªå°åˆ†å­ä»¥å†…ã€‚è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªå¯æ‰©å±•çš„è§£å†³æ–¹æ¡ˆï¼ŒDNAç¼–ç çš„åŒ–å­¦æ–‡åº“ï¼Œ<a target="_blank" rel="noopener" href="https://www.nature.com/articles/nchembio.211">åœ¨2009å¹´æè¿°</a>. éšç€DNAæµ‹åºå˜å¾—<a target="_blank" rel="noopener" href="https://www.genome.gov/about-genomics/fact-sheets/Sequencing-Human-Genome-cost">è¶Šæ¥è¶Šä¾¿å®œ</a>ï¼Œå¾ˆæ˜æ˜¾ï¼ŒDNAæœ¬èº«å¯ä»¥ç”¨ä½œæ ‡ç­¾æ¥è¯†åˆ«å’Œæ¶ˆé™¤å¤æ‚æ··åˆç‰©ä¸­åˆ†å­çš„èšé›†ã€‚<a target="_blank" rel="noopener" href="https://www.nature.com/articles/s41573-023-00713-6%E5%BD%B1%E5%93%8D%E5%8A%9Bhttps://www.ncbi.nlm.nih.gov/pmc/articles/PMC8369695/">DELs</a>è¿™ç§DNAæµ‹åºæŠ€æœ¯ã€‚</em><br><em>è¿™äº›æ¡å½¢ç å°åˆ†å­åœ¨ä¸€ä¸ªæ± ä¸­ï¼ˆè®¸å¤šåœ¨å•ç®¡ä¸­ï¼Œè€Œä¸æ˜¯æ¯ä¸ªå°åˆ†å­ä¸€ç®¡ï¼‰ï¼Œå¹¶æš´éœ²äºæº¶æ¶²ä¸­æ„Ÿå…´è¶£çš„è›‹ç™½è´¨é¶æ ‡ã€‚ç„¶åå†²æ´—æ„Ÿå…´è¶£çš„è›‹ç™½è´¨é¶æ ‡ï¼Œä»¥å»é™¤DELä¸­ä¸ä¸é¶æ ‡ç»“åˆçš„å°åˆ†å­ï¼Œæ”¶é›†å‰©ä½™çš„ç»“åˆç‰©å¹¶å¯¹å…¶DNAè¿›è¡Œæµ‹åºã€‚</em></p>
<h3 id="DELs-are-manufactured-by-combining-different-building-blocks"><a href="#DELs-are-manufactured-by-combining-different-building-blocks" class="headerlink" title="DELs are manufactured by combining different building blocks"></a>DELs are manufactured by combining different building blocks</h3><p>An intuitive way to think about DELs is to imagine a Mickey Mouse head as an example of a small molecule in the DEL. We attach the DNA barcode to Mickeyâ€™s chin. Mickeyâ€™s left ear is connected by a zipper; Mickeyâ€™s right ear is connected by velcro. These attachment points of zippers and velcro are analogies to different chemical reactions one might use to construct the DEL.</p>
<p>We could purchase ten different Mickey Mouse faces, ten different zipper ears, and ten different velcro ears, and use them to construct our small molecule library. By creating every combination of these three, weâ€™ll have 1,000 small molecules, but we only needed thirty building blocks (faces and ears) to make them. This combinatorial approach is what allows DELs to have so many members: the library in this competition is composed of 133M small molecules. The 133M small molecule library used here, AMA014, was provided by <a target="_blank" rel="noopener" href="https://www.alphama.com.cn/en/about/">AlphaMa</a>. It has a triazine core and superficially resembles the DELs described <a target="_blank" rel="noopener" href="https://www.nature.com/articles/nchembio.211">here</a>.</p>
<p><strong>DELæ˜¯é€šè¿‡ç»„åˆä¸åŒçš„æ„å»ºå—æ¥åˆ¶é€ çš„</strong><br>ä¸€ä¸ªæ€è€ƒDELçš„ç›´è§‚æ–¹æ³•æ˜¯æƒ³è±¡ä¸€ä¸ªç±³è€é¼ çš„å¤´ä½œä¸ºDELä¸­ä¸€ä¸ªå°åˆ†å­çš„ä¾‹å­ã€‚æˆ‘ä»¬æŠŠDNAæ¡å½¢ç è´´åœ¨ç±³å¥‡çš„ä¸‹å·´ä¸Šã€‚ç±³å¥‡çš„å·¦è€³ç”±æ‹‰é“¾è¿æ¥ï¼›ç±³å¥‡çš„å³è€³æ˜¯ç”¨å°¼é¾™æ­æ‰£è¿æ¥çš„ã€‚æ‹‰é“¾å’Œå°¼é¾™æ­æ‰£çš„è¿™äº›è¿æ¥ç‚¹ç±»ä¼¼äºå¯èƒ½ç”¨äºæ„å»ºDELçš„ä¸åŒåŒ–å­¦ååº”ã€‚<br>æˆ‘ä»¬å¯ä»¥è´­ä¹°åä¸ªä¸åŒçš„ç±³è€é¼ è„¸ã€åä¸ªä¸åŒæ‹‰é“¾è€³æœµå’Œåä¸ªä¸åŒå°¼é¾™æ­æ‰£è€³æœµï¼Œå¹¶ç”¨å®ƒä»¬æ¥æ„å»ºæˆ‘ä»¬çš„å°åˆ†å­åº“ã€‚é€šè¿‡åˆ›å»ºè¿™ä¸‰è€…çš„æ¯ä¸€ä¸ªç»„åˆï¼Œæˆ‘ä»¬å°†æ‹¥æœ‰1000ä¸ªå°åˆ†å­ï¼Œä½†æˆ‘ä»¬åªéœ€è¦30ä¸ªæ„å»ºå—ï¼ˆè„¸å’Œè€³æœµï¼‰å°±å¯ä»¥åˆ¶é€ å®ƒä»¬ã€‚è¿™ç§ç»„åˆæ–¹æ³•ä½¿DELèƒ½å¤Ÿæ‹¥æœ‰å¦‚æ­¤å¤šçš„æˆå‘˜ï¼šè¿™åœºç«äº‰ä¸­çš„æ–‡åº“ç”±133Mä¸ªå°åˆ†å­ç»„æˆã€‚è¿™é‡Œä½¿ç”¨çš„133Må°åˆ†å­æ–‡åº“AMA014ç”±<a target="_blank" rel="noopener" href="https://www.alphama.com.cn/en/about/">AlphaMa</a>æä¾›ã€‚å®ƒæœ‰ä¸€ä¸ªä¸‰å—ªæ ¸å¿ƒï¼Œè¡¨é¢ä¸Šç±»ä¼¼äº<a target="_blank" rel="noopener" href="https://www.nature.com/articles/nchembio.211">æ­¤å¤„</a>æè¿°çš„DELã€‚</p>
<img src="https://www.googleapis.com/download/storage/v1/b/kaggle-user-content/o/inbox%2F1095143%2F1901c6caa0c6c011617f4dec525d7bbe%2FKaggle%20v2%20(1).png?generation=1712179256934503&alt=media">

<h2 id="Acknowledgements"><a href="#Acknowledgements" class="headerlink" title="Acknowledgements"></a>Acknowledgements</h2><p>Leash Biosciences is grateful for the generous cosponsorship of <a target="_blank" rel="noopener" href="https://www.topharvestcap.com/">Top Harvest Capital</a> and <a target="_blank" rel="noopener" href="https://www.alphama.com.cn/en/about/">AlphaMa</a>.</p>
<h2 id="Citation"><a href="#Citation" class="headerlink" title="Citation"></a>Citation</h2><p>Andrew Blevins, Ian K Quigley, Brayden J Halverson, Nate Wilkinson, Rebecca S Levin, Agastya Pulapaka, Walter Reade, Addison Howard. (2024). Leash Bio - Predict New Medicines with BELKA. Kaggle. <a target="_blank" rel="noopener" href="https://kaggle.com/competitions/leash-BELKA">https://kaggle.com/competitions/leash-BELKA</a></p>
<hr>
<h2 id="Dataset-Description"><a href="#Dataset-Description" class="headerlink" title="Dataset Description"></a>Dataset Description</h2><h2 id="Overview-1"><a href="#Overview-1" class="headerlink" title="Overview"></a><strong>Overview</strong></h2><p>The examples in the competition dataset are represented by a binary classification of whether a given small molecule is a binder or not to one of three protein targets. The data were collected using DNA-encoded chemical library (DEL) technology.</p>
<p><em>æ¯”èµ›æ•°æ®é›†ä¸­çš„ä¾‹å­ç”±ç»™å®šå°åˆ†å­æ˜¯å¦ä¸ä¸‰ä¸ªè›‹ç™½è´¨é¶æ ‡ä¹‹ä¸€ç»“åˆçš„äºŒå…ƒåˆ†ç±»è¡¨ç¤ºã€‚ä½¿ç”¨DNAç¼–ç åŒ–å­¦æ–‡åº“ï¼ˆDELï¼‰æŠ€æœ¯æ”¶é›†æ•°æ®ã€‚</em></p>
<p>We represent chemistry with SMILES (<a target="_blank" rel="noopener" href="https://archive.epa.gov/med/med_archive_03/web/html/smiles.html">Simplified Molecular-Input Line-Entry System</a>) and the labels as binary binding classifications, one per protein target of three targets.</p>
<p>æˆ‘ä»¬ç”¨SMILESï¼ˆ<a target="_blank" rel="noopener" href="https://archive.epa.gov/med/med_archive_03/web/html/smiles.html">ç®€åŒ–åˆ†å­è¾“å…¥ è¡Œè¾“å…¥ç³»ç»Ÿ</a>)å’ŒäºŒå…ƒç»‘å®šåˆ†ç±»æ¥è¡¨ç¤ºåŒ–å­¦ï¼Œä¸‰ä¸ªé¶æ ‡ä¸­çš„æ¯ä¸ªè›‹ç™½è´¨é¶æ ‡éƒ½æœ‰ä¸€ä¸ªã€‚</p>
<h2 id="Files"><a href="#Files" class="headerlink" title="Files"></a><strong>Files</strong></h2><p><strong>[train&#x2F;test].[csv&#x2F;parquet]</strong> - The train or test data, available in both the csv and parquet formats.</p>
<ul>
<li><code>id</code> - A unique example_id that we use to identify the molecule-binding target pair.</li>
<li><code>buildingblock1_smiles</code> - The structure, in SMILES, of the first building block</li>
<li><code>buildingblock2_smiles</code> - The structure, in SMILES, of the second building block</li>
<li><code>buildingblock3_smiles</code> - The structure, in SMILES, of the third building block</li>
<li><code>molecule_smiles</code> - The structure of the fully assembled molecule, in SMILES. This includes the three building blocks and the triazine core. Note we use a <code>[Dy]</code> as the stand-in for the DNA linker.</li>
<li><code>protein_name</code> - The protein target name</li>
<li><code>binds</code> - The target column. A binary class label of whether the molecule binds to the protein. Not available for the test set.</li>
</ul>
<p><strong>sample_submission.csv</strong> - A sample submission file in the correct format</p>
<p><strong>[train&#x2F;test].[csv&#x2F;parquet]</strong> - è®­ç»ƒæˆ–æµ‹è¯•æ•°æ®ï¼Œcsvå’Œparquetæ ¼å¼å‡å¯ã€‚</p>
<ul>
<li><code>id</code> - æˆ‘ä»¬ç”¨æ¥è¯†åˆ«åˆ†å­ç»“åˆé¶æ ‡å¯¹çš„å”¯ä¸€ç¤ºä¾‹_idã€‚</li>
<li><code>buildingblock1_smiles</code> - ç¬¬ä¸€ä¸ªæ„å»ºå—çš„ç»“æ„ï¼Œä»¥SMILESè¡¨ç¤º</li>
<li><code>buildingblock2_smiles</code> - ç¬¬äºŒä¸ªæ„å»ºå—çš„ç»“æ„ï¼Œä»¥SMILESè¡¨ç¤º</li>
<li><code>buildingblock3_smiles</code> - ç¬¬ä¸‰ä¸ªæ„å»ºå—çš„ç»“æ„ï¼Œä»¥SMILESè¡¨ç¤º</li>
<li><code>molecule_smiles</code> - å®Œå…¨ç»„è£…çš„åˆ†å­çš„ç»“æ„ï¼Œä»¥SMILESè¡¨ç¤ºã€‚è¿™åŒ…æ‹¬ä¸‰ä¸ªæ„å»ºå—å’Œä¸‰å—ªæ ¸å¿ƒã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>[Dy]</code>ä½œä¸ºDNAè¿æ¥å­çš„æ›¿ä»£ã€‚</li>
<li><code>protein_name</code> - è›‹ç™½è´¨é¶æ ‡åç§°</li>
<li><code>binds</code> - ç›®æ ‡åˆ—ã€‚åˆ†å­æ˜¯å¦ä¸è›‹ç™½è´¨ç»“åˆçš„äºŒè¿›åˆ¶ç±»æ ‡ç­¾ã€‚ä¸é€‚ç”¨äºæµ‹è¯•é›†ã€‚</li>
</ul>
<h2 id="Competition-data"><a href="#Competition-data" class="headerlink" title="Competition data"></a><strong>Competition data</strong></h2><p>All data were generated in-house at Leash Biosciences. We are providing roughly 98M training examples per protein, 200K validation examples per protein, and 360K test molecules per protein. To test generalizability, the test set contains building blocks that are not in the training set. These datasets are very imbalanced: roughly 0.5% of examples are classified as binders; we used 3 rounds of selection in triplicate to identify binders experimentally. Following the competition, Leash will make all the data available for future use (3 targets Ã— 3 rounds of selection Ã— 3 replicates Ã— 133M molecules, or 3.6B measurements).</p>
<p><em>æ‰€æœ‰æ•°æ®å‡ç”±Leash Bioscienceså…¬å¸å†…éƒ¨ç”Ÿæˆã€‚æˆ‘ä»¬ä¸ºæ¯ç§è›‹ç™½è´¨æä¾›äº†å¤§çº¦ 98M ä¸ªè®­ç»ƒå®ä¾‹ï¼Œä¸ºæ¯ç§è›‹ç™½æä¾›äº† 200K ä¸ªéªŒè¯å®ä¾‹ï¼Œä¸ºæ¯ä¸ªè›‹ç™½è´¨æä¾›äº† 360K ä¸ªæµ‹è¯•åˆ†å­ã€‚ä¸ºäº†æµ‹è¯•å¯æ¨å¹¿æ€§ï¼Œæµ‹è¯•é›†åŒ…å«ä¸åœ¨è®­ç»ƒé›†ä¸­çš„æ„å»ºå—ã€‚è¿™äº›æ•°æ®é›†éå¸¸ä¸å¹³è¡¡ï¼šå¤§çº¦0.5%çš„ç¤ºä¾‹è¢«å½’ç±»ä¸ºç»‘å®šï¼›æˆ‘ä»¬ä½¿ç”¨äº†ä¸‰è½®ä¸€å¼ä¸‰ä»½çš„é€‰æ‹©æ¥å®éªŒé‰´å®šç²˜åˆå‰‚ã€‚æ¯”èµ›ç»“æŸåï¼ŒLeashå°†æä¾›æ‰€æœ‰æ•°æ®ä¾›æœªæ¥ä½¿ç”¨ï¼ˆ3ä¸ªé¶æ ‡Ã—3è½®é€‰æ‹©Ã—3ä¸ªé‡å¤Ã—3.33Mä¸ªåˆ†å­ï¼Œæˆ–3.6Bæµ‹é‡å€¼ï¼‰ã€‚</em></p>
<h2 id="Targets"><a href="#Targets" class="headerlink" title="Targets"></a><strong>Targets</strong></h2><p>Proteins are encoded in the genome, and names of the genes encoding those proteins are typically bestowed by their discoverers and regulated by the <a target="_blank" rel="noopener" href="https://www.genenames.org/">Hugo Gene Nomenclature Committee</a>. The protein products of these genes can sometimes have different names, often due to the history of their discovery.</p>
<p>We screened three protein targets for this competition.</p>
<p>è›‹ç™½è´¨åœ¨åŸºå› ç»„ä¸­ç¼–ç ï¼Œç¼–ç è¿™äº›è›‹ç™½è´¨çš„åŸºå› çš„åç§°é€šå¸¸ç”±å…¶å‘ç°è€…å‘½åï¼Œå¹¶ç”±<a target="_blank" rel="noopener" href="https://www.genenames.org/">é›¨æœåŸºå› å‘½åå§”å‘˜ä¼š</a>ç›‘ç®¡ã€‚è¿™äº›åŸºå› çš„è›‹ç™½è´¨äº§ç‰©æœ‰æ—¶å¯èƒ½æœ‰ä¸åŒçš„åç§°ï¼Œé€šå¸¸æ˜¯ç”±äºå®ƒä»¬çš„å‘ç°å†å²ã€‚<br>æˆ‘ä»¬ä¸ºè¿™æ¬¡æ¯”èµ›ç­›é€‰äº†ä¸‰ä¸ªè›‹ç™½è´¨é¶ç‚¹ã€‚</p>
<h3 id="EPHX2-sEH"><a href="#EPHX2-sEH" class="headerlink" title="EPHX2 (sEH)"></a><strong>EPHX2 (sEH)</strong></h3><p>The first target, epoxide hydrolase 2, is encoded by the EPHX2 genetic locus, and its protein product is commonly named â€œsoluble epoxide hydrolaseâ€, or abbreviated to sEH. Hydrolases are enzymes that catalyze certain chemical reactions, and EPHX2&#x2F;sEH also hydrolyzes certain phosphate groups. EPHX2&#x2F;sEH is a potential drug target for high blood pressure and diabetes progression, and small molecules inhibiting EPHX2&#x2F;sEH from earlier DEL efforts <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8429121/">made it to clinical trials</a>.</p>
<p>EPHX2&#x2F;sEH was also screened with DELs, and hits predicted with ML approaches, in a <a target="_blank" rel="noopener" href="https://blog.research.google/2020/06/unlocking-chemome-with-dna-encoded.html">recent</a> <a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acs.jmedchem.0c00452">study</a> but the screening data were not published. We included EPHX2&#x2F;sEH to allow contestants an external gut check for model performance by comparing to these previously-published results.</p>
<p>We screened EPHX2&#x2F;sEH <a target="_blank" rel="noopener" href="https://www.caymanchem.com/product/10011669/soluble-epoxide-hydrolase-(human-recombinant)">purchased from Cayman Chemical</a>, a life sciences commercial vendor. For those contestants wishing to incorporate protein structural information in their submissions, the amino sequence is positions 2-555 from UniProt entry <a target="_blank" rel="noopener" href="https://www.uniprot.org/uniprotkb/P34913/entry#sequences">P34913</a>, the crystal structure can be found in <a target="_blank" rel="noopener" href="https://www.rcsb.org/structure/3i28">PDB entry 3i28</a>, and predicted structure can be found in AlphaFold2 entry <a target="_blank" rel="noopener" href="https://alphafold.ebi.ac.uk/entry/P34913">34913</a>. Additional EPHX2&#x2F;sEH crystal structures with ligands bound can be found in PDB.</p>
<p>ç¬¬ä¸€ä¸ªé¶æ ‡ç¯æ°§åŒ–ç‰©æ°´è§£é…¶2ç”±EPHX2åŸºå› åº§ç¼–ç ï¼Œå…¶è›‹ç™½äº§ç‰©é€šå¸¸è¢«å‘½åä¸ºâ€œå¯æº¶æ€§ç¯æ°§åŒ–ç‰©æ°´è§£é…¶â€ï¼Œæˆ–ç¼©å†™ä¸ºsEHã€‚æ°´è§£é…¶æ˜¯å‚¬åŒ–æŸäº›åŒ–å­¦ååº”çš„é…¶ï¼ŒEPHX2&#x2F;sEHä¹Ÿæ°´è§£æŸäº›ç£·é…¸åŸºå›¢ã€‚EPHX2&#x2F;sEHæ˜¯é«˜è¡€å‹å’Œç³–å°¿ç—…è¿›å±•çš„æ½œåœ¨è¯ç‰©é¶ç‚¹ï¼Œæ—©æœŸDELç ”ç©¶ä¸­æŠ‘åˆ¶EPHX2&#x2F;s EHçš„å°åˆ†å­<a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8429121/">å·²è¿›å…¥ä¸´åºŠè¯•éªŒ</a>.<br>EPHX2&#x2F;sEHä¹Ÿç”¨DELè¿›è¡Œäº†ç­›é€‰ï¼Œå¹¶ç”¨MLæ–¹æ³•é¢„æµ‹äº†å‘½ä¸­ç‡(<a target="_blank" rel="noopener" href="https://blog.research.google/2020/06/unlocking-chemome-with-dna-encoded.html%E5%AD%A6%E4%B9%A0https://pubs.acs.org/doi/10.1021/acs.jmedchem.0c00452)%E4%BD%86%E7%AD%9B%E9%80%89%E6%95%B0%E6%8D%AE%E6%B2%A1%E6%9C%89%E5%85%AC%E5%B8%83%E3%80%82%E6%88%91%E4%BB%AC%E7%BA%B3%E5%85%A5%E4%BA%86EPHX2/sEH%EF%BC%8C%E9%80%9A%E8%BF%87%E4%B8%8E%E4%B9%8B%E5%89%8D%E5%85%AC%E5%B8%83%E7%9A%84%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83%EF%BC%8C%E8%AE%A9%E5%8F%82%E8%B5%9B%E8%80%85%E8%83%BD%E5%A4%9F%E5%AF%B9%E6%A8%A1%E5%9E%8B%E6%80%A7%E8%83%BD%E8%BF%9B%E8%A1%8C%E5%A4%96%E9%83%A8%E6%A3%80%E6%9F%A5%E3%80%82">https://blog.research.google/2020/06/unlocking-chemome-with-dna-encoded.htmlå­¦ä¹ https://pubs.acs.org/doi/10.1021/acs.jmedchem.0c00452)ä½†ç­›é€‰æ•°æ®æ²¡æœ‰å…¬å¸ƒã€‚æˆ‘ä»¬çº³å…¥äº†EPHX2/sEHï¼Œé€šè¿‡ä¸ä¹‹å‰å…¬å¸ƒçš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œè®©å‚èµ›è€…èƒ½å¤Ÿå¯¹æ¨¡å‹æ€§èƒ½è¿›è¡Œå¤–éƒ¨æ£€æŸ¥ã€‚</a><br>æˆ‘ä»¬ç­›é€‰äº†EPHX2&#x2F;sEH<a target="_blank" rel="noopener" href="https://www.caymanchem.com/product/10011669/soluble-epoxide-hydrolase-%EF%BC%88%E4%BA%BA%E7%B1%BB%E9%87%8D%E7%BB%84%EF%BC%89%EF%BC%89%EF%BC%8C%E4%B8%80%E5%AE%B6%E7%94%9F%E5%91%BD%E7%A7%91%E5%AD%A6%E5%95%86%E4%B8%9A%E4%BE%9B%E5%BA%94%E5%95%86%E3%80%82%E5%AF%B9%E4%BA%8E%E9%82%A3%E4%BA%9B%E5%B8%8C%E6%9C%9B%E5%9C%A8%E5%8F%82%E8%B5%9B%E4%BD%9C%E5%93%81%E4%B8%AD%E5%8A%A0%E5%85%A5%E8%9B%8B%E7%99%BD%E8%B4%A8%E7%BB%93%E6%9E%84%E4%BF%A1%E6%81%AF%E7%9A%84%E5%8F%82%E8%B5%9B%E8%80%85%EF%BC%8C%E6%B0%A8%E5%9F%BA%E9%85%B8%E5%BA%8F%E5%88%97%E4%BD%8D%E4%BA%8EUniProt%E6%9D%A1%E7%9B%AE%E7%9A%842-555%E4%BD%8D[P34913](https://www.uniprot.org/uniprotkb/P34913/entry#sequences)%EF%BC%8C%E6%99%B6%E4%BD%93%E7%BB%93%E6%9E%84%E5%8F%AF%E4%BB%A5%E5%9C%A8[PDB%E6%9D%A1%E7%9B%AE3i28]%E4%B8%AD%E6%89%BE%E5%88%B0(https://www.rcsb.org/structure/3i28)%EF%BC%8C%E9%A2%84%E6%B5%8B%E7%BB%93%E6%9E%84%E5%8F%AF%E5%9C%A8AlphaFold2%E6%9D%A1%E7%9B%AE[34913]%E4%B8%AD%E6%89%BE%E5%88%B0(https://alphafold.ebi.ac.uk/entry/P34913">è´­è‡ªå¼€æ›¼åŒ–å­¦</a>. åœ¨PDBä¸­å¯ä»¥å‘ç°å…·æœ‰ç»“åˆé…ä½“çš„é¢å¤–çš„EPHX2&#x2F;sEHæ™¶ä½“ç»“æ„ã€‚</p>
<h3 id="BRD4"><a href="#BRD4" class="headerlink" title="BRD4"></a><strong>BRD4</strong></h3><p>The second target, bromodomain 4, is encoded by the BRD4 locus and its protein product is also named BRD4. Bromodomains bind to protein spools in the nucleus that DNA wraps around (called histones) and affect the likelihood that the DNA nearby is going to be transcribed, producing new gene products. Bromodomains play roles in cancer progression and a number of drugs <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10096006/">have been discovered to inhibit their activities</a>.</p>
<p>BRD4 <a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acs.jmedchem.9b01670">has been screened with DEL approaches previously</a> but the screening data were not published. We included BRD4 to allow contestants to evaluate candidate molecules for oncology indications.</p>
<p>We screened BRD4 <a target="_blank" rel="noopener" href="https://www.activemotif.com/catalog/details/31594/recombinant-brd4-44-460-protein">purchased from Active Motif</a>, a life sciences commercial vendor. For those contestants wishing to incorporate protein structural information in their submissions, the amino acid sequence is positions 44-460 from UniProt entry <a target="_blank" rel="noopener" href="https://www.uniprot.org/uniprotkb/O60885/entry#sequences">O60885-1</a>, the crystal structure (for a single domain) can be found in PDB entry <a target="_blank" rel="noopener" href="https://www.rcsb.org/structure/7USK">7USK</a> and predicted structure can be found in AlphaFold2 entry <a target="_blank" rel="noopener" href="https://alphafold.ebi.ac.uk/entry/O60885">O60885</a>. Additional BRD4 crystal structures with ligands bound can be found in PDB.</p>
<h3 id="ALB-HSA"><a href="#ALB-HSA" class="headerlink" title="ALB (HSA)"></a><strong>ALB (HSA)</strong></h3><p>The third target, serum albumin, is encoded by the ALB locus and its protein product is also named ALB. The protein product is sometimes abbreviated as HSA, for â€œhuman serum albuminâ€. ALB, the most <a target="_blank" rel="noopener" href="https://www.ncbi.nlm.nih.gov/books/NBK459198/">common protein in the blood</a>, is used to drive osmotic pressure (to bring fluid back from tissues into blood vessels) and to transport many ligands, hormones, fatty acids, and more.</p>
<p>Albumin, being the most abundant protein in the blood, often plays a role in absorbing candidate drugs in the body and sequestering them from their target tissues. Adjusting candidate drugs to bind less to albumin and other blood proteins <a target="_blank" rel="noopener" href="https://pubs.acs.org/doi/10.1021/acsptsci.2c00115">is a strategy to help these candidate drugs be more effective</a>.</p>
<p>ALB <a target="_blank" rel="noopener" href="https://pubmed.ncbi.nlm.nih.gov/25650139/">has been screened with DEL approaches previously</a> but the screening data were not published. We included ALB to allow contestants to build models that might have a larger impact on drug discovery across many disease types. The ability to predict ALB binding well would allow drug developers to improve their candidate small molecule therapies much more quickly than physically manufacturing many variants and testing them against ALB empirically in an iterative process.</p>
<p>We screened ALB <a target="_blank" rel="noopener" href="https://www.abcam.com/products/proteins-peptides/recombinant-human-serum-albumin-protein-his-tag-ab217817.html">purchased from Active Motif</a>. For those contestants wishing to incorporate protein structural information in their submissions, the amino acid sequence is positions 25 to 609 from UniProt entry <a target="_blank" rel="noopener" href="https://www.uniprot.org/uniprotkb/P02768/entry#sequences">P02768</a>, the crystal structure can be found in PDB entry <a target="_blank" rel="noopener" href="https://www.ebi.ac.uk/pdbe/entry/pdb/1AO6">1AO6</a>, and predicted structure can be found in AlphaFold2 entry <a target="_blank" rel="noopener" href="https://alphafold.ebi.ac.uk/entry/P02768">P02768</a>. Additional ALB crystal structures with ligands bound can be found in PDB.</p>
<p>Good luck!</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-03-20T00:21:24.000Z" title="2024/3/20 08:21:24">2024-03-20</time>å‘è¡¨</span><span class="level-item"><time dateTime="2024-06-22T08:19:59.876Z" title="2024/6/22 16:19:59">2024-06-22</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a><span>Â /Â </span><a class="link-muted" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/PyTorch/">PyTorch</a></span><span class="level-item">1 å°æ—¶è¯»å®Œ (å¤§çº¦6804ä¸ªå­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/03/20/PyTorch%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/">PyTorchå¿«é€Ÿä¸Šæ‰‹æŒ‡å—</a></p><div class="content"><h1 id="PyTorch-æ·±åº¦å­¦ä¹ æ¡†æ¶å¿«é€Ÿä¸Šæ‰‹æŒ‡å—"><a href="#PyTorch-æ·±åº¦å­¦ä¹ æ¡†æ¶å¿«é€Ÿä¸Šæ‰‹æŒ‡å—" class="headerlink" title="PyTorch æ·±åº¦å­¦ä¹ æ¡†æ¶å¿«é€Ÿä¸Šæ‰‹æŒ‡å—"></a>PyTorch æ·±åº¦å­¦ä¹ æ¡†æ¶å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</h1><p>PyTorch å¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ , å¸¸åº”ç”¨äºæ­å»ºæ·±åº¦å­¦ä¹ ç½‘ç»œ , å®Œæˆä¸€äº›æ·±åº¦å­¦ä¹ ä»»åŠ¡ (CVã€NLPé¢†åŸŸ)</p>
<p>è¦æƒ³å¿«é€Ÿä¸Šæ‰‹ PyTorch , ä½ éœ€è¦çŸ¥é“ä»€ä¹ˆ :</p>
<ol>
<li>ä¸€ä¸ªé¡¹ç›®çš„å®Œæ•´æµç¨‹ , å³åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹</li>
<li>å‡ ä¸ªå¸¸ç”¨ (æˆ–è€…è¯´å¿…å¤‡çš„) ç»„ä»¶</li>
</ol>
<p>å‰©ä¸‹çš„æ—¶é—´ä½ å°±éœ€è¦äº†è§£ , å®Œæˆä»€ä¹ˆä»»åŠ¡ , éœ€è¦ä»€ä¹ˆç½‘ç»œ , è€Œä¸”éœ€è¦ç”¨å¤§é‡çš„æ—¶é—´å»åšè¿™ä»¶äº‹æƒ… <p><br>$^{(e.g.)}$ä¾‹å¦‚ : ä½ ç°åœ¨æœ‰ä¸€ä¸ª<strong>å›¾åƒåˆ†ç±»ä»»åŠ¡</strong> , å®Œæˆè¯¥ä»»åŠ¡éœ€è¦ä»€ä¹ˆç½‘ç»œ, ä½ éœ€è¦é€šè¿‡<strong>æŸ¥æ‰¾èµ„æ–™</strong>æ¥äº†è§£éœ€è¦æŸ¥æ‰¾ä»€ä¹ˆç½‘ç»œã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ , æœ‰ä¸€äº›å¸¸è¯†æ€§çš„é—®é¢˜ä½ å¿…é¡»çŸ¥é“ , ä¾‹å¦‚: å›¾åƒå±‚é¢æ— æ³•æˆ–å¾ˆéš¾ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³• , å·ç§¯ç¥ç»ç½‘ç»œæœ€å¤šçš„æ˜¯åº”ç”¨äºå›¾åƒé¢†åŸŸç­‰</p>
<hr>
<h2 id="ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„åˆ†ç±»é¡¹ç›®æµç¨‹æ¥è®²è¿°åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹"><a href="#ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„åˆ†ç±»é¡¹ç›®æµç¨‹æ¥è®²è¿°åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹" class="headerlink" title="ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„åˆ†ç±»é¡¹ç›®æµç¨‹æ¥è®²è¿°åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹"></a>ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„<strong>åˆ†ç±»é¡¹ç›®</strong>æµç¨‹æ¥è®²è¿°<strong>åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹</strong></h2><p>ä¸€ä¸ªå®Œæ•´çš„ PyTorch åˆ†ç±»é¡¹ç›®éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ–¹é¢:</p>
<ol>
<li>å‡†å¤‡æ•°æ®é›†</li>
<li>åŠ è½½æ•°æ®é›†</li>
<li>ä½¿ç”¨å˜æ¢(Transformsæ¨¡å—)</li>
<li>æ„å»ºæ¨¡å‹</li>
<li>è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹</li>
<li>æ¨ç†æ¨¡å‹</li>
</ol>
<hr>
<ol>
<li><strong>å‡†å¤‡æ•°æ®é›†</strong> ä¸€èˆ¬æ¥è¯´ , æ¯”èµ›ä¼šç»™å‡ºä½ æ•°æ®é›†, ä¸åŒæ•°æ®é›†çš„ç»„ç»‡æ–¹å¼ä¸åŒ , æˆ‘ä»¬è¦æƒ³åŠæ³•æŠŠä»–æ„é€ æˆæˆ‘ä»¬æœŸå¾…çš„æ ·å­<ul>
<li>åˆ†ç±»æ•°æ®é›†ä¸€èˆ¬æ¯”è¾ƒç®€å•, ä¸€èˆ¬æ˜¯å°†æŸä¸ªåˆ†ç±»çš„æ–‡ä»¶å…¨éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­, ä¾‹å¦‚:</li>
<li>äºŒåˆ†ç±»é—®é¢˜ : Fake(æ–‡ä»¶å¤¹) &#x2F; Real(æ–‡ä»¶å¤¹)</li>
<li>å¤šåˆ†ç±»é—®é¢˜ : åˆ†ç±» 1(æ–‡ä»¶å¤¹) &#x2F; åˆ†ç±» 2(æ–‡ä»¶å¤¹) &#x2F; â€¦ &#x2F; åˆ†ç±» N(æ–‡ä»¶å¤¹)</li>
<li>å½“ç„¶æœ‰äº›æ—¶å€™ä»–ä»¬ä¼šç»™å‡ºå…¶ä»–æ–¹å¼ , å¦‚ <strong>UBC-OCEAN</strong> , ä»–ä»¬å°†æ‰€æœ‰çš„å›¾ç‰‡æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ , å¹¶ç”¨ csv æ–‡ä»¶å­˜å‚¨è¿™äº›æ–‡ä»¶çš„è·¯å¾„(æˆ–è€…æ˜¯æ–‡ä»¶å) , ç„¶ååœ¨ csv æ–‡ä»¶ä¸­è¿›è¡Œæ ‡æ³¨(å¦‚ä¸‹): <p><img src="https://img-blog.csdnimg.cn/direct/b8c54d7db30e40b2a99165a3daf72059.png#pic_center"  width = "426" height = "217">
<img src="https://img-blog.csdnimg.cn/direct/e61c1682065e4520a5cc460cff4d78d4.png#pic_center" width = "621" height = "217"></li>
<li>ä»¥åä½ å¯èƒ½è¿˜ä¼šé‡åˆ°æ›´å¤æ‚çš„ç›®æ ‡æ£€æµ‹çš„æ•°æ®é›†, è¿™ç§æ•°æ®é›†ä¼šæœ‰ä¸€äº›å›ºå®šæ ¼å¼ , å¦‚ <strong>VOCæ ¼å¼</strong> , <strong>COCOæ ¼å¼</strong>ç­‰</li>
<li>åœ¨æ•°æ®é›†æ–¹é¢ , éœ€è¦æ˜ç¡®ä¸‰ä¸ªæ¦‚å¿µâ€”â€”è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›† , è¯·åŠ¡å¿…æ˜ç¡®è¿™ä¸‰ä¸ªæ¦‚å¿µ , è¿™æ˜¯<strong>åŸºæœ¬ä¸­çš„åŸºæœ¬</strong><ul>
<li><em>è®­ç»ƒé›†(Train)</em> : å­—å¦‚å…¶å , ç®€å•æ¥è¯´å°±æ˜¯<strong>çŸ¥é“æ•°æ®</strong> , ä¹Ÿ<strong>çŸ¥é“æ ‡ç­¾</strong> çš„æ•°æ® , æˆ‘ä»¬ç”¨å…¶è¿›è¡Œè®­ç»ƒ</li>
<li><em>éªŒè¯é›†(Valid)</em> : <em>éªŒè¯é›†</em> å’Œ <em>æµ‹è¯•é›†</em> æ˜¯éå¸¸å®¹æ˜“æ··æ·†çš„æ¦‚å¿µ , ç®€å•æ¥è¯´ , éªŒè¯é›†å°±æ˜¯æˆ‘ä»¬ä¹Ÿ<strong>çŸ¥é“æ•°æ®å’Œæ ‡ç­¾</strong> , ä½†æ˜¯æˆ‘ä»¬çš„ä¸€èˆ¬ä¸å°†è¿™äº›æ•°æ®ç”¨äºè®­ç»ƒ , è€Œæ˜¯å°†ä»–ä»¬å½“ä½œ<strong>æˆ‘ä»¬çš„æµ‹è¯•é›†</strong> , å³æˆ‘ä»¬å·²ç»ç«™åœ¨äº†å‡ºé¢˜äººçš„è§’åº¦ , ç»™å‡ºå‚èµ›è€…è¾“å…¥æ•°æ® , è€Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°æ®å¯¹åº”çš„è¾“å‡º , ä½†æ˜¯æˆ‘ä»¬ä¸è®©æ¨¡å‹çŸ¥é“</li>
<li><em>æµ‹è¯•é›†(Test)</em> : æµ‹è¯•é›†å°±æ˜¯ , æˆ‘ä»¬<strong>ä¸çŸ¥é“è¾“å…¥æ•°æ®çš„è¾“å‡ºæ ‡ç­¾</strong> , åªæœ‰çœŸæ­£çš„å‡ºé¢˜äººçŸ¥é“ , ä¸€èˆ¬æ¥è¯´ , æˆ‘ä»¬æ— æ³•æ‹¿åˆ°æµ‹è¯•é›† , æµ‹è¯•é›†æ˜¯ç”±å‡ºé¢˜äººæŒæ§çš„</li>
<li><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong> , å¦‚æœä½ é€šè¿‡æŸç§é€”å¾„çŸ¥é“äº†æ‰€æœ‰çš„æµ‹è¯•é›†çš„æ ‡ç­¾æ—¶ , ä¸å¯ä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œè®­ç»ƒ , è¿™æ˜¯<strong>éå¸¸ä¸¥é‡çš„å­¦æœ¯ä¸ç«¯è¡Œä¸º</strong> , ä¼šè¢«å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œå”¾å¼ƒ</li>
</ul>
</li>
</ul>
</li>
</ol>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªæ•°æ®é›† , æˆ‘å°†ä»¥ FAKE_OR_REAL æ•°æ®é›†ä¸ºä¾‹ , å±•ç¤ºæˆ‘ä»¬æ•°æ®é›†çš„ç»“æ„</span></span><br><span class="line"><span class="comment"># D:\REAL_OR_FAKE\DATASET</span></span><br><span class="line"><span class="comment"># â”œâ”€test --------- æµ‹è¯•é›†è·¯å¾„, è¿™é‡Œå¯ä»¥æ”¾ä½ è‡ªå·±çš„æ•°æ®, ä½ ç”šè‡³å¯ä»¥å°†ä»–ä»¬åˆ†ç±», ä½†æ˜¯è¯·æ³¨æ„, å®é™…æƒ…å†µä¸‹ä½ åªèƒ½é€šè¿‡è¿™ç§æ–¹å¼æ¥â€œå¾—åˆ°â€æµ‹è¯•é›†</span></span><br><span class="line"><span class="comment"># â”‚  â”œâ”€fake ------ ä½ è‡ªå·±åˆ†çš„ç±», å¼€å¿ƒå°±å¥½</span></span><br><span class="line"><span class="comment"># â”‚  â””â”€real ------ åŒä¸Š</span></span><br><span class="line"><span class="comment"># â”œâ”€train -------- è®­ç»ƒé›†è·¯å¾„, è¿™é‡Œé¢æ”¾çš„æ˜¯é¢˜ç›®ç»™å‡ºçš„æ•°æ®, ä¸‹é¢æœ‰ fake å’Œ real ä¸¤ä¸ªæ–‡ä»¶å¤¹, è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­å°±æ˜¯ä¸¤ä¸ªç±»åˆ«, æˆ‘ä»¬è¦ç”¨è¿™é‡Œé¢çš„å›¾ç‰‡è¿›è¡Œåˆ†ç±» </span></span><br><span class="line"><span class="comment"># â”‚  â”œâ”€fake</span></span><br><span class="line"><span class="comment"># â”‚  â””â”€real</span></span><br><span class="line"><span class="comment"># â””â”€valid -------- éªŒè¯é›†è·¯å¾„, è¿™é‡Œé¢æ”¾çš„æ˜¯é¢˜ç›®ç»™å‡ºçš„æ•°æ®, ä¸‹é¢æœ‰ fake å’Œ real ä¸¤ä¸ªæ–‡ä»¶å¤¹, è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­å°±æ˜¯ä¸¤ä¸ªç±»åˆ«, è¿™é‡Œé¢çš„å›¾ç‰‡ä¸éœ€è¦è¿›è¡Œè®­ç»ƒ</span></span><br><span class="line"><span class="comment">#     â”œâ”€fake</span></span><br><span class="line"><span class="comment">#     â””â”€real</span></span><br></pre></td></tr></table></figure>
<ol>
<li><strong>åŠ è½½æ•°æ®é›†</strong><ul>
<li>è¯·åŠ¡å¿…è®°ä½ , ä¸ç®¡æ˜¯ä»€ä¹ˆæ•°æ®é›† , æ•°æ®é›†æ˜¯å¦‚ä½•æ„æˆçš„ , åœ¨ä½¿ç”¨ PyTorch æ¡†æ¶æ—¶ , æˆ‘ä»¬éƒ½è¦åƒå°½åŠæ³•å°†ä»–ä»¬åŠ è½½å…¥ <strong><code>Dataset</code></strong> ç±»ä¸­</li>
<li>ç®€å•æ¥è¯´ , <code>Dataset</code> ç±»å°±æ˜¯æè¿°äº†æˆ‘ä»¬æ•°æ®çš„ç»„æˆçš„ç±»</li>
<li>éœ€è¦æ³¨æ„ , PyTorch å®ç°äº†è®¸å¤šè‡ªå·±çš„ <code>Dataset</code> ç±» , è¿™äº›ç±»å¯ä»¥è½»æ¾çš„åŠ è½½<strong>ç‰¹å®šæ ¼å¼</strong>çš„æ•°æ®é›† , ä½†æ˜¯æˆ‘<strong>å¼ºçƒˆå»ºè®®</strong>æ‰€æœ‰çš„æ•°æ®é›†éƒ½è¦è‡ªå·±ç»§æ‰¿<strong>Dataset</strong>ç±» , è‡ªè¡ŒåŠ è½½ , è¿™æ ·æˆ‘ä»¬å¯ä»¥è·Ÿæ¸…æ™°çš„æŒ‡å¯¼æ•°æ®é›†çš„ç»„æˆæ–¹å¼ , ä¹Ÿå¯ä»¥ä½¿å¾—æˆ‘ä»¬åŠ è½½ä»»æ„æ ¼å¼çš„æ•°æ®é›†</li>
<li>å®ç° <code>DataSet</code> ç±»éœ€è¦æˆ‘ä»¬å…ˆç»§æ‰¿ <code>Dataset</code> ç±» , åœ¨ç»§æ‰¿ <code>Dataset</code> ç±»å, æˆ‘ä»¬åªéœ€è¦å®ç°å…¶ä¸­çš„<code>__init__</code>ã€<code>__len__</code>å’Œ<code>__getitem__</code>ä¸‰ä¸ªæ–¹æ³• , å³å¯å®Œæˆå¯¹æ•°æ®é›†çš„åŠ è½½ , è¿™ä¸‰ä¸ªæ–¹æ³•å°±å’Œä»–çš„åå­—ä¸€æ · : <ul>
<li><code>__init__</code> æ–¹æ³•æ˜¯<strong>æ„é€ å‡½æ•°</strong> , ç”¨äºåˆå§‹åŒ–</li>
<li><code>__len__</code> æ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å¤§å°</li>
<li><code>__getitem__</code> æ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å…ƒç´  , æˆ‘å°†ä»ä¸‹é¢çš„ä»£ç ä¸­è¿›è¡Œæ›´è¯¦ç»†çš„è§£é‡Š</li>
</ul>
</li>
<li>æœ‰äº›æ•°æ®é›†å¹¶ä¸åˆ†åˆ«æä¾› Trainè®­ç»ƒé›† å’Œ ValidéªŒè¯é›†, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>random_split()</code> æ–¹æ³•å¯¹æ•°æ®é›†è¿›è¡Œåˆ’åˆ†<ul>
<li><p>éœ€è¦æ³¨æ„çš„æ˜¯, æ¯æ¬¡é‡æ–°åˆ’åˆ†æ•°æ®é›†æ—¶, å¿…é¡»é‡æ–°è®­ç»ƒæ¨¡å‹, å› ä¸º <code>random_split()</code> æ–¹æ³•éšæœºæ€§, åˆ’åˆ†åçš„æ•°æ®ä¸å¯èƒ½å’Œä¹‹å‰çš„æ•°æ®å®Œå…¨é‡åˆ, å› æ­¤ä¼šå¯¼è‡´æ•°æ®äº¤å‰çš„æƒ…å†µ, ä¸‹é¢ä¸€æ®µä½¿ç”¨ <code>random_split()</code> è¿›è¡Œåˆ’åˆ†çš„ <strong>Python</strong> ä»£ç ç¤ºä¾‹ :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹é¢æ¼”ç¤ºä½¿ç”¨ random_split æ¥åˆ’åˆ†æ•°æ®é›†çš„æ“ä½œ</span></span><br><span class="line"><span class="comment"># æˆ‘ä»¬å‡è®¾å·²ç»å®šä¹‰äº† CustomImageDataSet</span></span><br><span class="line">split_ratio = <span class="number">0.8</span>                                    <span class="comment"># è¡¨ç¤ºåˆ’åˆ†æ¯”ä¾‹ä¸º 8 : 2</span></span><br><span class="line">dataset = CustomImageDataSet(fake_dir, real_dir)     <span class="comment"># å®šä¹‰ CustomImageDataSet ç±», å‡è®¾æ­¤æ—¶æ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</span></span><br><span class="line">train_dataset_num = <span class="built_in">int</span>(dataset.lens * split_ratio)  <span class="comment"># å®šä¹‰è®­ç»ƒé›†çš„å¤§å°</span></span><br><span class="line">valid_dataset_num = dataset.lens - train_dataset_num <span class="comment"># å®šä¹‰éªŒè¯é›†çš„å¤§å°</span></span><br><span class="line"><span class="comment"># random_split(dataset, [train_dataset_num, valid_dataset_num]) è¡¨ç¤ºå°† dataset æŒ‰ç…§ [train_dataset_num: valid_dataset_num] çš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†</span></span><br><span class="line">train_dataset, valid_dataset = random_split(dataset, [train_dataset_num, valid_dataset_num])</span><br></pre></td></tr></table></figure>
</li>
<li><p>å½“æ•°æ®é›†ä¸æ˜¯å¾ˆå¤§çš„æ—¶, æ¨èäººä¸ºçš„å°†æ•°æ®é›†è¿›è¡Œåˆ’åˆ†, å¯ä»¥å†™ä¸€ä¸ª <strong>Python è„šæœ¬(.py)</strong> æˆ–è€… <strong>æ‰¹å¤„ç†è„šæœ¬(.bat)</strong> æ¥å®Œæˆè¿™ä¸ªæ“ä½œ</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>å®Œæ•´çš„æ•°æ®é›†åŠ è½½ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª CustomImageDataset(...) ç±», æ‹¬å·ä¸­çš„å†…å®¹è¡¨ç¤ºæˆ‘ä»¬ç»§æ‰¿äº† ... ç±»</span></span><br><span class="line"><span class="comment"># å› æ­¤æˆ‘ä»¬è¿™é‡Œ CustomImageDataset(Dataset): è¡¨ç¤ºæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªâ€œè‡ªå®šä¹‰å›¾ç‰‡â€ç±», è¿™ä¸ªâ€œè‡ªå®šä¹‰å›¾ç‰‡â€ç±»ç»§æ‰¿è‡ª Dataset ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomImageDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="comment"># è¿™é‡Œæˆ‘ä»¬å®ç° __init__ æ–¹æ³•, __init__ æ–¹æ³•å…¶å®å°±æ˜¯ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°, ä»–ä¹Ÿåˆ†æœ‰å‚æ„é€ å’Œæ— å‚æ„é€ , åªæ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬è¯´æ— å‚æ„é€ åŸºæœ¬æ²¡å•¥æ„ä¹‰</span></span><br><span class="line">    <span class="comment"># å› æ­¤æˆ‘ä»¬å¸¸å¸¸å®ç°è¿™ä¸ªç±», ä½¿å¾—å¯ä»¥æŒ‡å®šè¿™ä¸ªç±»çš„è¾“å…¥è¾“å‡º</span></span><br><span class="line">    <span class="comment"># æ¯”å¦‚ä¸‹é¢æˆ‘ä»¬å†™çš„ def __init__(self, fake_dir, real_dir, transform=None):</span></span><br><span class="line">    <span class="comment"># self : è‡ªå·±, æˆ‘ä¸€èˆ¬ç›´æ¥ç†è§£ä¸º this æŒ‡é’ˆ, å¦‚æœæœ‰å…´è¶£äº†è§£æ›´æ·±å±‚çš„ä¸œè¥¿å¯ä»¥æŸ¥é˜…ä¸€äº›èµ„æ–™, è¿™ä¸ªæ˜¯å¿…å¡«çš„</span></span><br><span class="line">    <span class="comment"># fake_dir : ç”¨äºæŒ‡å®š fake ç±»å‹å›¾ç‰‡çš„ä½ç½®çš„</span></span><br><span class="line">    <span class="comment"># real_dir : ç”¨äºæŒ‡å®š real ç±»å‹å›¾ç‰‡çš„ä½ç½®çš„</span></span><br><span class="line">    <span class="comment"># transform : ç”¨äºæŒ‡å®šå˜æ¢, ç®€å•æ¥è¯´å°±æ˜¯å¯¹è¾“å…¥è¿›è¡ŒæŸäº›æ“ä½œ, æˆ‘ä¼šåœ¨ä¸‹é¢çš„æ¿å—ä¸­è¿›è¡Œè¯¦ç»†å™è¿°</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, fake_dir, real_dir, transform=<span class="literal">None</span></span>):</span><br><span class="line">        self.fake_dir = fake_dir        <span class="comment"># è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª fake_dir, å…¶å€¼ä¸ºä¼ å…¥çš„ fake_dir</span></span><br><span class="line">        self.real_dir = real_dir        <span class="comment"># è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª real_dir, å…¶å€¼ä¸ºä¼ å…¥çš„ real_dir</span></span><br><span class="line">        self.transform = transform      <span class="comment"># è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª transform, å…¶å€¼ä¸ºä¼ å…¥çš„ transform, å½“æ²¡æœ‰ä¼ å…¥æ—¶, è¿™ä¸ªå˜é‡ä¸º None</span></span><br><span class="line"></span><br><span class="line">        self.fake_images = os.listdir(fake_dir)     <span class="comment"># ä¼ å…¥çš„ fake_dir æ˜¯ä¸€ä¸ªè·¯å¾„, æˆ‘ä»¬ä½¿ç”¨ os.listdir(fake_dir) å¯ä»¥åŠ è½½ fake_dir æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹, ä¹Ÿå°±æ˜¯æ‰€æœ‰ fake å›¾ç‰‡</span></span><br><span class="line">        self.real_images = os.listdir(real_dir)     <span class="comment"># ä¼ å…¥çš„ real_dir æ˜¯ä¸€ä¸ªè·¯å¾„, æˆ‘ä»¬ä½¿ç”¨ os.listdir(real_dir) å¯ä»¥åŠ è½½ real_dir æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹, ä¹Ÿå°±æ˜¯æ‰€æœ‰ real å›¾ç‰‡</span></span><br><span class="line"></span><br><span class="line">        self.total_images = self.fake_images + self.real_images <span class="comment"># æ€»å›¾ç‰‡åˆ—è¡¨, å°±æ˜¯å°† fake å›¾ç‰‡åˆ—è¡¨å’Œ real å›¾ç‰‡åˆ—è¡¨è¿›è¡Œç»„åˆ</span></span><br><span class="line">        self.labels = [<span class="number">0</span>]*<span class="built_in">len</span>(self.fake_images) + [<span class="number">1</span>]*<span class="built_in">len</span>(self.real_images) <span class="comment"># å¯¹å›¾ç‰‡æ‰“æ ‡ç­¾, fake ä¸º 0, real ä¸º 1</span></span><br><span class="line">                                                                            <span class="comment"># [0] * 10 å¾—åˆ°çš„ç»“æœä¸º [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span><br><span class="line">                                                                            <span class="comment"># [1] * 10 å¾—åˆ°çš„ç»“æœä¸º [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™é‡Œæˆ‘ä»¬å®ç° __len__ æ–¹æ³•, è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å¤§å°</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.total_images)   <span class="comment"># è¿™é‡Œæˆ‘ä»¬ç›´æ¥è¿”å›æ€»å›¾ç‰‡åˆ—è¡¨çš„é•¿åº¦å³å¯, è¿™é‡Œçš„å®ç°æ–¹å¼ä¸å”¯ä¸€, åªè¦èƒ½åšåˆ°è¡¨ç¤ºæ•°æ®é›†å¤§å°å³å¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™é‡Œæˆ‘ä»¬å®ç° __getitem__ æ–¹æ³•, è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æ•°æ®é›†ä¸­çš„æŸä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="comment"># å…¶ä¸­ idx è¡¨ç¤ºç´¢å¼•, è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„, å½“ç„¶å¯ä»¥èµ·å…¶ä»–åå­—, ä¸è¿‡æœ€å¥½è¿˜æ˜¯ä½¿ç”¨ idx</span></span><br><span class="line">    <span class="comment"># __getitem__(self, idx) è¡¨ç¤ºè·å– idx ä½ç½®çš„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        <span class="comment"># è¿™é‡Œè¡¨ç¤ºè·å–ä¸€ä¸ªå…ƒç´ çš„é€»è¾‘</span></span><br><span class="line">        <span class="comment"># å½“ idx ä½ç½®çš„æ ‡ç­¾ä¸º 0 æ—¶, å›¾ç‰‡çš„è·¯å¾„ä¸º fake_dir + self.total_images[idx], idx å³ä¸ºå›¾ç‰‡çš„ç´¢å¼•ä½ç½®</span></span><br><span class="line">        <span class="comment"># å½“ idx ä½ç½®çš„æ ‡ç­¾ä¸º 1 æ—¶, å›¾ç‰‡çš„è·¯å¾„ä¸º real_dir + self.total_images[idx]</span></span><br><span class="line">        image_path = os.path.join(self.fake_dir <span class="keyword">if</span> self.labels[idx] == <span class="number">0</span> <span class="keyword">else</span> self.real_dir, self.total_images[idx])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä½¿ç”¨ PIL åº“åŠ è½½å›¾ç‰‡, é€šè¿‡ image_path æ‰“å¼€å›¾ç‰‡, å¹¶ä¸”å°†å›¾ç‰‡è½¬åŒ–ä¸º RGB æ ¼å¼</span></span><br><span class="line">        image = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿™é‡Œæ˜¯ transform, è¡¨ç¤ºå˜æ¢, å½“å…¶å€¼ä¸º None æ—¶ä¸è¿›è¡Œæ“ä½œ, å½“ä¼ å…¥è‡ªå·±çš„ transform æ—¶å³ä¸ºéç©º, å³å¯¹è¾“å…¥æ•°æ®è¿›è¡Œå˜æ¢</span></span><br><span class="line">        <span class="keyword">if</span> self.transform:</span><br><span class="line">            <span class="comment"># æˆ‘ä»¬å°†å˜æ¢åçš„å›¾ç‰‡ç›´æ¥ä¿å­˜åœ¨åŸä½ç½®</span></span><br><span class="line">            image = self.transform(image)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æœ€åå‡½æ•°çš„è¿”å›å€¼ä¸º image å’Œ self.labels[idx], å³è¡¨ç¤ºç´¢å¼•ä½ç½® idx å¤„çš„å›¾ç‰‡å’Œæ ‡ç­¾</span></span><br><span class="line">        <span class="keyword">return</span> image, self.labels[idx]</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>ä½¿ç”¨ Transforms</strong><ul>
<li>ä¸è¦ç®€å•çš„ä½¿ç”¨åŸå§‹å›¾ç‰‡è¿›è¡Œè®­ç»ƒ , å½“ç„¶å¦‚æœä¸€å®šè¦ä½¿ç”¨åŸå§‹å›¾ç‰‡è¿›è¡Œè®­ç»ƒ, ä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>transforms</strong> æ¨¡å—</li>
<li>ä¸€èˆ¬æ¥è¯´, è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„ <strong>transforms</strong> æ˜¯ä¸åŒçš„, å› ä¸ºæˆ‘ä»¬å¸Œæœ›éªŒè¯é›†å’Œæµ‹è¯•é›†çš„å›¾ç‰‡è´´åˆçœŸå®çš„æƒ…å†µ </li>
<li>ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å®šä¹‰ <strong>transforms</strong></li>
<li>åœ¨å®šä¹‰å®Œ <code>transforms</code> æˆ‘ä»¬å°±å¯ä»¥å®Œå…¨å®šä¹‰æˆ‘ä»¬çš„ <code>Dataset</code> å’Œ <code>Dataloader</code> äº†</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> transforms</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰transform</span></span><br><span class="line"><span class="comment"># transforms.Compose(transforms) å®é™…ä¸Šå°±æ˜¯å°†å¤šä¸ª transform æ–¹æ³•å˜ä¸ºé€æ­¥æ‰§è¡Œ, ä¸€èˆ¬æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å¯¹å›¾ç‰‡è¿›è¡Œè¿ç»­çš„å˜æ¢</span></span><br><span class="line">train_transform = transforms.Compose([</span><br><span class="line">    transforms.RandomHorizontalFlip(),                                      <span class="comment"># éšæœºæ°´å¹³ç¿»è½¬</span></span><br><span class="line">    transforms.RandomVerticalFlip(),                                        <span class="comment"># éšæœºå‚ç›´ç¿»è½¬</span></span><br><span class="line">    transforms.ColorJitter(brightness=<span class="number">0.1</span>, contrast=<span class="number">0.1</span>, saturation=<span class="number">0.1</span>),   <span class="comment"># æ”¹å˜å›¾åƒçš„å±æ€§, å°†å›¾åƒçš„brightnessäº®åº¦/contrastå¯¹æ¯”åº¦/saturationé¥±å’Œåº¦/hueè‰²ç›¸ éšæœºå˜åŒ–ä¸ºåŸå›¾äº®åº¦çš„ 10%</span></span><br><span class="line">    transforms.RandomResizedCrop(<span class="number">224</span>, scale=(<span class="number">0.8</span>, <span class="number">1.0</span>)),                    <span class="comment"># å¯¹å›¾ç‰‡å…ˆè¿›è¡Œéšæœºé‡‡é›†, ç„¶åå¯¹è£å‰ªå¾—åˆ°çš„å›¾åƒç¼©æ”¾ä¸ºåŒä¸€å¤§å°, æ„ä¹‰æ˜¯å³ä½¿åªæ˜¯è¯¥ç‰©ä½“çš„ä¸€éƒ¨åˆ†, æˆ‘ä»¬ä¹Ÿè®¤ä¸ºè¿™æ˜¯è¯¥ç±»ç‰©ä½“</span></span><br><span class="line">    transforms.RandomRotation(<span class="number">40</span>),                                          <span class="comment"># åœ¨[-40, 40]èŒƒå›´å†…éšæœºæ—‹è½¬</span></span><br><span class="line">    transforms.RandomAffine(degrees=<span class="number">0</span>, shear=<span class="number">10</span>, scale=(<span class="number">0.8</span>,<span class="number">1.2</span>)),          <span class="comment"># éšæœºä»¿å°„å˜æ¢</span></span><br><span class="line">    transforms.ColorJitter(brightness=<span class="number">0.2</span>, contrast=<span class="number">0.2</span>, saturation=<span class="number">0.2</span>),   <span class="comment"># è‰²å½©æŠ–åŠ¨</span></span><br><span class="line">    transforms.ToTensor(),                                                  <span class="comment"># [é‡ç‚¹] å°†å›¾ç‰‡è½¬åŒ–ä¸º Tensor å¼ é‡, åœ¨ PyTorch ä¸­, ä¸€åˆ‡çš„è¿ç®—éƒ½åŸºäºå¼ é‡, è¯·ä¸€å®šå°†ä½ çš„è¾“å…¥æ•°æ®è½¬åŒ–ä¸ºå¼ é‡</span></span><br><span class="line">                                                                            <span class="comment"># è¯·ç†è§£ä»€ä¹ˆæ˜¯å¼ é‡ : æˆ‘ä»¬åœ¨çº¿æ€§ä»£æ•°ä¸­æœ‰å‘é‡çš„æ¦‚å¿µ, ç®€å•æ¥è¯´å°±æ˜¯å¼ é‡å°±æ˜¯å‘é‡, åªä¸è¿‡å¼ é‡å¾€å¾€å…·æœ‰æ›´é«˜çš„ç»´åº¦</span></span><br><span class="line">                                                                            <span class="comment"># è€Œå¤§å®¶ä¸€èˆ¬ä¹ æƒ¯å°†é«˜äºä¸‰ç»´çš„å‘é‡ç§°ä¸ºå¼ é‡, æŸäº›äºº(æ¯”å¦‚æˆ‘)ä¹Ÿä¹ æƒ¯æ‰€æœ‰çš„å‘é‡ç»Ÿç§°ä¸ºå¼ é‡</span></span><br><span class="line">                                                                            <span class="comment"># å¯ä»¥ç®€å•çš„å°†æ•°ç»„çš„ç»´æ•°æ¥ç•Œå®šå¼ é‡çš„ç»´åº¦</span></span><br><span class="line">                                                                            <span class="comment"># ä¾‹å¦‚ [ ] ä¸ºä¸€ç»´å¼ é‡, [[ ]] ä¸ºäºŒç»´å¼ é‡, [[[ ]]]ä¸ºä¸‰ç»´å¼ é‡, [[[[ ]]]]ä¸ºå››ç»´å¼ é‡</span></span><br><span class="line">                                                                            <span class="comment"># å¯¹äºå›¾åƒæ¥è¯´, jpg å›¾åƒå®é™…ä¸ºä¸‰ç»´çŸ©é˜µ, png å›¾åƒå®é™…ä¸ºå››ç»´çŸ©é˜µ, è¿™ä¸ªç»´æ•°æ˜¯æ ¹æ®å›¾åƒçš„é€šé“æ•°è¿›è¡Œåˆ’åˆ†çš„</span></span><br><span class="line">                                                                            <span class="comment"># ä¾‹å¦‚ jpg æœ‰ Rã€Gã€Bä¸‰ä¸ªé€šé“, png å…·æœ‰ </span></span><br><span class="line">    transforms.Normalize(mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>], std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>]),    <span class="comment"># å½’ä¸€åŒ–, å¯ä»¥å¯¹çŸ©é˜µè¿›è¡Œå½’ä¸€åŒ–</span></span><br><span class="line">                                                                                    <span class="comment"># è¯¦ç»†æŸ¥çœ‹è¿™ä¸ªBlog : https://blog.csdn.net/qq_38765642/article/details/109779370</span></span><br><span class="line">    transforms.RandomErasing()                                              <span class="comment"># éšæœºæ“¦é™¤</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">valid_transform = transforms.Compose([</span><br><span class="line">    transforms.Resize((<span class="number">256</span>, <span class="number">256</span>)),                                          <span class="comment"># Resize æ“ä½œ, å°†å›¾ç‰‡è½¬æ¢åˆ°æŒ‡å®šçš„å¤§å°</span></span><br><span class="line">    transforms.ToTensor(),</span><br><span class="line">    transforms.Normalize(mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>], std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ Dataset å®ä¾‹</span></span><br><span class="line">train_dataset = CustomImageDataset(fake_dir=<span class="string">&quot;./dataset/train/fake&quot;</span>, real_dir=<span class="string">&quot;./dataset/train/real&quot;</span>, transform=train_transform)</span><br><span class="line">valid_dataset = CustomImageDataset(fake_dir=<span class="string">&quot;./dataset/valid/fake&quot;</span>, real_dir=<span class="string">&quot;./dataset/valid/real&quot;</span>, transform=valid_transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º DataLoader å®ä¾‹</span></span><br><span class="line"><span class="comment"># è¿™é‡Œå°†è¦æ¶‰åŠåˆ°è¶…å‚æ•°çš„æ¦‚å¿µ, ä»€ä¹ˆæ˜¯è¶…å‚æ•°: ç®€å•æ¥å°†, è¶…å‚æ•°å°±æ˜¯æˆ‘ä»¬è‡ªå·±èƒ½æŒ‡å®šçš„ä¸€äº›æ•°æ®, è¶…å‚æ•°çš„é€‰æ‹©å°†å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“æ¨¡å‹çš„æ€§èƒ½</span></span><br><span class="line"><span class="comment"># å› æ­¤ æ·±åº¦å­¦ä¹ é¢†åŸŸçš„å·¥ç¨‹å¸ˆ å¸¸ç§°è‡ªå·±ä¸º ç‚¼ä¸¹å¸ˆã€è°ƒå‚å¸ˆç­‰</span></span><br><span class="line">batch_size = <span class="number">32</span> <span class="comment"># batch_size å°±æ˜¯ä¸€ä¸ªè¶…å‚æ•°, batch å³ä¸º â€œæ‰¹æ¬¡â€, è¡¨ç¤ºä¸€æ¬¡ä½¿ç”¨ DataLoader åŠ è½½å¤šå°‘å¼ å›¾ç‰‡è¿›è¡Œè¿ç®—</span></span><br><span class="line">                <span class="comment"># è¿™ä¸ªæ•°å€¼å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½, ä¹Ÿä¸æ˜¯è¶Šå°è¶Šå¥½, ä½†æ˜¯å¾€å¾€å¤§ä¸€äº›æ¯”è¾ƒå¥½, è¿™ä¸ªæ•°å­—æœ€å¤§èƒ½é€‰æ‹©å¤šå¤§å’Œä½ çš„å›¾ç‰‡å¤§å°å’Œæ˜¾å¡æ˜¾å­˜æœ‰å¾ˆå¤§çš„å…³ç³»</span></span><br><span class="line">                <span class="comment"># å½“å‡ºç° [Out Of Memery] é”™è¯¯æ—¶å¾€å¾€è¡¨æ˜ä½ é€‰å–äº†è¿‡å¤§çš„ batch_size, å¯¼è‡´æ˜¾å¡å‡ºç°äº†çˆ†æ˜¾å­˜çš„é—®é¢˜</span></span><br><span class="line"><span class="comment"># batch_size : æ¯æ¬¡è®­ç»ƒæ—¶ï¼Œæ¨¡å‹æ‰€çœ‹åˆ°çš„æ•°æ®æ•°é‡ã€‚å®ƒæ˜¯å†³å®šè®­ç»ƒé€Ÿåº¦å’Œå†…å­˜ä½¿ç”¨çš„é‡è¦å‚æ•°ã€‚</span></span><br><span class="line"><span class="comment"># shuffle : æ˜¯å¦åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸä¹‹å‰æ‰“ä¹±æ•°æ®é›†çš„é¡ºåºã€‚è¿™å¯¹äºè®¸å¤šæ¨¡å‹ï¼ˆå¦‚å·ç§¯ç¥ç»ç½‘ç»œï¼‰æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æ¨¡å‹é¿å…æ¨¡å¼è¯†åˆ«ã€‚</span></span><br><span class="line"><span class="comment"># sampler : å®šä¹‰å¦‚ä½•ä»æ•°æ®é›†ä¸­æŠ½æ ·ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä½¿ç”¨éšæœºé‡‡æ ·ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ›´å¤æ‚çš„é‡‡æ ·ç­–ç•¥ï¼Œå¦‚å­¦ä¹ ç‡è°ƒåº¦é‡‡æ ·ã€‚</span></span><br><span class="line"><span class="comment"># batch_sampler : ä¸samplerç±»ä¼¼ï¼Œä½†å®ƒåœ¨æ‰¹å¤„ç†çº§åˆ«ä¸Šè¿›è¡Œé‡‡æ ·ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šã€‚è¿™å¯¹äºå†…å­˜ä½¿ç”¨æ•ˆç‡æ›´é«˜çš„åœºæ™¯å¾ˆæœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># num_workers : å®šä¹‰äº†å¤šå°‘ä¸ªå·¥ä½œè¿›ç¨‹ç”¨äºæ•°æ®çš„åŠ è½½ã€‚è¿™å¯ä»¥åŠ å¿«æ•°æ®åŠ è½½çš„é€Ÿåº¦ï¼Œä½†éœ€è¦æ³¨æ„å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚</span></span><br><span class="line">train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=<span class="literal">True</span>)</span><br><span class="line">valid_loader = DataLoader(valid_dataset, batch_size=batch_size, shuffle=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹Dataloaderæ•°æ®</span></span><br><span class="line"><span class="comment"># ä¸ºäº†äº†è§£Dataloaderä¸­çš„æ•°æ®, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥æŸ¥çœ‹:</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ Python çš„ len() å‡½æ•° : æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ len() å‡½æ•°è·å– Dataloader çš„é•¿åº¦, å³æ•°æ®é›†ä¸­æ•°æ®å—çš„æ•°é‡</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ torch.utils.data.DataLoader.len() æ–¹æ³• : è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè¿”å›Dataloaderçš„é•¿åº¦ã€‚</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨ iter() å‡½æ•°ï¼šDataloaderæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡iter()å‡½æ•°å¯¹å…¶è¿›è¡Œè¿­ä»£ï¼Œä»¥è·å–æ¯ä¸ªæ‰¹æ¬¡çš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨torchvision.utils.save_image()å‡½æ•° : å¦‚æœæˆ‘ä»¬æ­£åœ¨å¤„ç†çš„æ˜¯å›¾åƒæ•°æ®é›†ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥ä¿å­˜Dataloaderä¸­çš„å›¾åƒæ•°æ®ã€‚                </span></span><br><span class="line"><span class="built_in">len</span>(train_loader)   <span class="comment"># 401</span></span><br><span class="line"><span class="built_in">len</span>(valid_loader)   <span class="comment"># 100</span></span><br><span class="line">images, labels = <span class="built_in">next</span>(<span class="built_in">iter</span>(train_loader))</span><br><span class="line"><span class="built_in">print</span>(images)</span><br><span class="line"><span class="built_in">print</span>(labels)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><strong>æ„å»ºæ¨¡å‹</strong><ul>
<li>æ„å»ºæ¨¡å‹æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€éƒ¨åˆ†, ä¸€èˆ¬æ¥è¯´åšå¥½æ•°æ®é›†ä¹‹å, æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯ä¿®æ”¹æ¨¡å‹, é€šè¿‡è®­ç»ƒç»“æœæ”¹è¿›æ¨¡å‹, åˆ¤æ–­è‡ªå·±çš„æ¨¡å‹çš„æ­£ç¡®æ€§, è¿™é‡Œå°±æ˜¯æ•´ä¸ªä½ è¦ç”¨åˆ°çš„ç¥ç»ç½‘ç»œçš„éƒ¨åˆ† , éœ€è¦æ³¨æ„çš„æ˜¯ , è¿™é‡ŒæŒ‡å®šä»€ä¹ˆè¾“å…¥ , æ¨ç†çš„æ—¶å€™å°±è¦æŒ‡å®šä»€ä¹ˆè¾“å…¥</li>
<li>ç®€å•ç”¨å‡ ä¸ªç¬¦å·è¯´æ˜ä¸€ä¸‹å°±æ˜¯: $^{Train} model (inputX, inputY, â€¦)$ â†’ $^{Valid} model (inputX, inputY, â€¦)$<ul>
<li>å¦‚ä½•ç¡®å®šè¾“å…¥æ˜¯ä»€ä¹ˆ: çœ‹ <strong><code>forward()</code></strong> çš„è¾“å…¥æ˜¯å•¥æ¨¡å‹çš„è¾“å…¥å°±æ˜¯å•¥</li>
</ul>
</li>
<li>æˆ‘ä¸‹é¢å±•ç°äº†æˆ‘å¤ç°çš„ <strong>ResNet50</strong> , ç”¨è¿™ç§æ–¹å¼å¯ä»¥é¡ºä¾¿æ•™ä½ å¦‚ä½•å¤ç°ç½‘ç»œç»“æ„</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œæ˜¯å¯¹ ResNet50 çš„å®ç°, è¯·å¯¹ç…§è®ºæ–‡æ¥è¿›è¡Œå¯¹ç…§é˜…è¯»</span></span><br><span class="line"><span class="comment"># å®šä¹‰ ResNet50Basicç±», è¿™é‡Œå¹¶ä¸æ˜¯å®Œæ•´çš„æ¨¡å‹, è€Œæ˜¯æ¨¡å‹çš„ä¸€ä¸ªéƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResNet50BasicBlock</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channel, outs, kernerl_size, stride, padding</span>):</span><br><span class="line">        <span class="comment"># super(ResNet50BasicBlock, self).__init__() è¿™é‡Œæ˜¯å¹²ä»€ä¹ˆçš„?</span></span><br><span class="line">        <span class="comment"># 1. é¦–å…ˆæ‰¾åˆ° ResNet50BasicBlock çš„çˆ¶ç±», è¿™é‡Œæ˜¯ nn.Module</span></span><br><span class="line">        <span class="comment"># 2. æŠŠç±» ResNet50BasicBlock çš„å¯¹è±¡selfè½¬æ¢ä¸º nn.Module çš„å¯¹è±¡</span></span><br><span class="line">        <span class="comment"># 3. &quot;è¢«è½¬æ¢&quot;çš„ nn.Module å¯¹è±¡è°ƒç”¨è‡ªå·±çš„ init å‡½æ•°</span></span><br><span class="line">        <span class="comment"># ç®€å•ç†è§£ä¸€ä¸‹å°±æ˜¯ : å­ç±»æŠŠçˆ¶ç±»çš„ __init__ æ”¾åˆ°è‡ªå·±çš„ __init__ å½“ä¸­, è¿™æ ·å­ç±»å°±æœ‰äº†çˆ¶ç±»çš„ __init__ çš„é‚£äº›ä¸œè¥¿</span></span><br><span class="line">        <span class="built_in">super</span>(ResNet50BasicBlock, self).__init__()</span><br><span class="line">        <span class="comment"># è¿™é‡Œåªæ˜¯å®šä¹‰éƒ¨åˆ†, åœ¨è¿™é‡Œçš„å®šä¹‰å¹¶ä¸ä¸€å®šä¼šåœ¨æ¨ç†è¿‡ç¨‹ä¸­ä½¿ç”¨</span></span><br><span class="line">        self.conv1 = nn.Conv2d(in_channel, outs[<span class="number">0</span>], kernel_size=kernerl_size[<span class="number">0</span>], stride=stride[<span class="number">0</span>], padding=padding[<span class="number">0</span>])</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(outs[<span class="number">0</span>])</span><br><span class="line">        self.conv2 = nn.Conv2d(outs[<span class="number">0</span>], outs[<span class="number">1</span>], kernel_size=kernerl_size[<span class="number">1</span>], stride=stride[<span class="number">0</span>], padding=padding[<span class="number">1</span>])</span><br><span class="line">        self.bn2 = nn.BatchNorm2d(outs[<span class="number">1</span>])</span><br><span class="line">        self.conv3 = nn.Conv2d(outs[<span class="number">1</span>], outs[<span class="number">2</span>], kernel_size=kernerl_size[<span class="number">2</span>], stride=stride[<span class="number">0</span>], padding=padding[<span class="number">2</span>])</span><br><span class="line">        self.bn3 = nn.BatchNorm2d(outs[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¾“å…¥æ˜¯å•¥çœ‹ forward(), ä¾‹å¦‚è¿™é‡Œæ˜¯ forward(self, x), åˆ™è¡¨ç¤ºè¾“å…¥æ˜¯ x, ä¹Ÿå°±æ˜¯ä¸€ä¸ª</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># nn.Conv2d æ˜¯å·ç§¯å±‚, è¯·äº†è§£[1]ä»€ä¹ˆæ˜¯å·ç§¯å±‚, ä»¥åŠ[2]å·ç§¯å±‚æ˜¯å¹²å•¥ç”¨çš„, [3]å·ç§¯åä¼šå˜æˆä»€ä¹ˆ</span></span><br><span class="line">        <span class="comment"># å·ç§¯è¿ç®—çš„ç›®çš„æ˜¯æå–è¾“å…¥çš„ä¸åŒç‰¹å¾, ç¬¬ä¸€å±‚å·ç§¯å±‚å¯èƒ½åªèƒ½æå–ä¸€äº›ä½çº§çš„ç‰¹å¾å¦‚è¾¹ç¼˜ã€çº¿æ¡å’Œè§’ç­‰å±‚çº§, æ›´å¤šå±‚çš„ç½‘è·¯èƒ½ä»ä½çº§ç‰¹å¾ä¸­è¿­ä»£æå–æ›´å¤æ‚çš„ç‰¹å¾</span></span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        <span class="comment"># [*] ä»€ä¹ˆæ˜¯ ReLU, ReLUæ˜¯æ¿€æ´»å‡½æ•°, è¯·äº†è§£ [1]ä»€ä¹ˆæ˜¯æ¿€æ´»å‡½æ•°, [2]ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¿€æ´»å‡½æ•°</span></span><br><span class="line">        <span class="comment"># [*] ä»€ä¹ˆæ˜¯ Batch Normalizationå±‚, BN å±‚æ˜¯æ‰¹æ¬¡å½’ä¸€åŒ–å±‚</span></span><br><span class="line">        out = F.relu(self.bn1(out))</span><br><span class="line">        out = self.conv2(out)</span><br><span class="line">        out = F.relu(self.bn2(out))</span><br><span class="line">        out = self.conv3(out)</span><br><span class="line">        out = self.bn3(out)</span><br><span class="line">        <span class="keyword">return</span> F.relu(out + x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ ResNet50DownBlockç±», è¿™é‡Œå¹¶ä¸æ˜¯å®Œæ•´çš„æ¨¡å‹, è€Œæ˜¯æ¨¡å‹çš„ä¸€ä¸ªéƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResNet50DownBlock</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channel, outs, kernel_size, stride, padding</span>):</span><br><span class="line">        <span class="built_in">super</span>(ResNet50DownBlock, self).__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(in_channel, outs[<span class="number">0</span>], kernel_size=kernel_size[<span class="number">0</span>], stride=stride[<span class="number">0</span>], padding=padding[<span class="number">0</span>])</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(outs[<span class="number">0</span>])</span><br><span class="line">        self.conv2 = nn.Conv2d(outs[<span class="number">0</span>], outs[<span class="number">1</span>], kernel_size=kernel_size[<span class="number">1</span>], stride=stride[<span class="number">1</span>], padding=padding[<span class="number">1</span>])</span><br><span class="line">        self.bn2 = nn.BatchNorm2d(outs[<span class="number">1</span>])</span><br><span class="line">        self.conv3 = nn.Conv2d(outs[<span class="number">1</span>], outs[<span class="number">2</span>], kernel_size=kernel_size[<span class="number">2</span>], stride=stride[<span class="number">2</span>], padding=padding[<span class="number">2</span>])</span><br><span class="line">        self.bn3 = nn.BatchNorm2d(outs[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">        self.extra = nn.Sequential(</span><br><span class="line">            nn.Conv2d(in_channel, outs[<span class="number">2</span>], kernel_size=<span class="number">1</span>, stride=stride[<span class="number">3</span>], padding=<span class="number">0</span>),</span><br><span class="line">            nn.BatchNorm2d(outs[<span class="number">2</span>])</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x_shortcut = self.extra(x)</span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = self.bn1(out)</span><br><span class="line">        out = F.relu(out)</span><br><span class="line"></span><br><span class="line">        out = self.conv2(out)</span><br><span class="line">        out = self.bn2(out)</span><br><span class="line">        out = F.relu(out)</span><br><span class="line"></span><br><span class="line">        out = self.conv3(out)</span><br><span class="line">        out = self.bn3(out)</span><br><span class="line">        <span class="keyword">return</span> F.relu(x_shortcut + out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResNet50</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(ResNet50, self).__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">3</span>, <span class="number">64</span>, kernel_size=<span class="number">7</span>, stride=<span class="number">2</span>, padding=<span class="number">3</span>)</span><br><span class="line">        self.maxpool = nn.MaxPool2d(kernel_size=<span class="number">3</span>, stride=<span class="number">2</span>, padding=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Sequential ç±»æ˜¯ torch.nn æ¨¡å—ä¸­çš„ä¸€ä¸ªå®¹å™¨, å¯ä»¥å°†å¤šä¸ªå±‚å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­, æ–¹ä¾¿é¡ºåºè¿æ¥</span></span><br><span class="line">        self.layer1 = nn.Sequential(</span><br><span class="line">            ResNet50DownBlock(<span class="number">64</span>, outs=[<span class="number">64</span>, <span class="number">64</span>, <span class="number">256</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">256</span>, outs=[<span class="number">64</span>, <span class="number">64</span>, <span class="number">256</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">256</span>, outs=[<span class="number">64</span>, <span class="number">64</span>, <span class="number">256</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        self.layer2 = nn.Sequential(</span><br><span class="line">            ResNet50DownBlock(<span class="number">256</span>, outs=[<span class="number">128</span>, <span class="number">128</span>, <span class="number">512</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">512</span>, outs=[<span class="number">128</span>, <span class="number">128</span>, <span class="number">512</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">512</span>, outs=[<span class="number">128</span>, <span class="number">128</span>, <span class="number">512</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">512</span>, outs=[<span class="number">128</span>, <span class="number">128</span>, <span class="number">512</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        self.layer3 = nn.Sequential(</span><br><span class="line">            ResNet50DownBlock(<span class="number">512</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">1024</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50BasicBlock(<span class="number">1024</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernerl_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">1024</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">1024</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">1024</span>, outs=[<span class="number">256</span>, <span class="number">256</span>, <span class="number">1024</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        self.layer4 = nn.Sequential(</span><br><span class="line">            ResNet50DownBlock(<span class="number">1024</span>, outs=[<span class="number">512</span>, <span class="number">512</span>, <span class="number">2048</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">2048</span>, outs=[<span class="number">512</span>, <span class="number">512</span>, <span class="number">2048</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]),</span><br><span class="line">            ResNet50DownBlock(<span class="number">2048</span>, outs=[<span class="number">512</span>, <span class="number">512</span>, <span class="number">2048</span>], kernel_size=[<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>], stride=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        self.avgpool = nn.AvgPool2d(kernel_size=<span class="number">7</span>, stride=<span class="number">1</span>, ceil_mode=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># self.avgpool = nn.AdaptiveAvgPool2d(output_size=(1, 1))</span></span><br><span class="line"></span><br><span class="line">        self.fc = nn.Linear(<span class="number">2048</span>, <span class="number">10</span>)</span><br><span class="line">        <span class="comment"># ä½¿ç”¨å·ç§¯ä»£æ›¿å…¨è¿æ¥</span></span><br><span class="line">        self.conv11 = nn.Conv2d(<span class="number">2048</span>, <span class="number">10</span>, kernel_size=<span class="number">1</span>, stride=<span class="number">1</span>, padding=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = self.maxpool(out)</span><br><span class="line">        out = self.layer1(out)</span><br><span class="line">        out = self.layer2(out)</span><br><span class="line">        out = self.layer3(out)</span><br><span class="line">        out = self.layer4(out)</span><br><span class="line">        <span class="comment"># avgpool å¹³å‡æ± åŒ–å±‚, äº†è§£ä»€ä¹ˆæ˜¯å¹³å‡æ± åŒ–å±‚</span></span><br><span class="line">        out = self.avgpool(out)</span><br><span class="line">        out = self.conv11(out)</span><br><span class="line">        out = out.reshape(x.shape[<span class="number">0</span>], -<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># out = self.fc(out)</span></span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œå±•ç°äº†å¯¹ ResNet çš„ä¸€ä¸ªå…·ä½“çš„åº”ç”¨</span></span><br><span class="line"><span class="comment"># x = torch.randn(1, 3, 224, 224)   # è¿™ä¸ªæ˜¯æˆ‘ä»¬ ResNet50 æœŸå¾…çš„è¾“å…¥æ ·å­, å¯ä»¥çœ‹åˆ°ä»–æ˜¯ [1] ä¸ª [3] é€šé“, å®½åº¦ä¸º[224], é«˜åº¦ä¸º [224]çš„å¼ é‡ </span></span><br><span class="line">image_path = <span class="string">&#x27;./dataset/test/fake/test_fake_1.png&#x27;</span></span><br><span class="line">image = Image.<span class="built_in">open</span>(image_path).convert(<span class="string">&#x27;RGB&#x27;</span>)   <span class="comment"># å›¾ç‰‡åŠ è½½</span></span><br><span class="line">transform = transforms.ToTensor()               <span class="comment"># å°†å›¾ç‰‡è½¬åŒ–ä¸ºå¼ é‡, æ­¤æ—¶çš„ å¼ é‡çš„å½¢çŠ¶ä¸º[3, 1024, 1024]</span></span><br><span class="line"><span class="comment"># å½“è¾“å…¥æ•°æ®çš„ç»´åº¦ä¸è¶³æ—¶, æˆ‘ä»¬å¯ä»¥é€šè¿‡ unsqueeze() æ·»åŠ ç»´åº¦, è¿™ä¸ªä¸œè¥¿ç®€å•ç†è§£ä¸€ä¸‹å°±æ˜¯, åœ¨æŸä¸ªç»´åº¦å¤–é¢åŠ æ‹¬å·[], å³å¯æ‹“å±•å‡ºæ›´é«˜çš„ç»´åº¦</span></span><br><span class="line">img_tensor = transform(image).unsqueeze(dim=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(x.shape) æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ shape æ¥æŸ¥çœ‹ä¸€ä¸ªå¼ é‡çš„å½¢çŠ¶</span></span><br><span class="line"><span class="comment"># print(img_tensor.shape)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡ŒåŠ è½½æˆ‘ä»¬çš„ç½‘ç»œæ¶æ„</span></span><br><span class="line">net = ResNet50()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œè¿›è¡Œè¾“å…¥, è¾“å…¥ img_tensor, è¿›å…¥ forword() éƒ¨åˆ†, ç„¶åå¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„ç»“æœ</span></span><br><span class="line">out = net(img_tensor)</span><br><span class="line"><span class="built_in">print</span>(out)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œä¸ºäº†æ–¹ä¾¿, æˆ‘ä»¬ç›´æ¥åŠ è½½ PyTorch é¢„è®­ç»ƒå¥½çš„ ResNet50 çš„æ¨¡å‹</span></span><br><span class="line"><span class="comment"># PyTorch å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸å°‘å·²ç»é¢„è®­ç»ƒå¥½çš„æ¨¡å‹, æˆ‘ä»¬åªéœ€è¦åŠ è½½ä»–ä»¬ä¸è®­ç»ƒå¥½çš„æ¨¡å‹å³å¯</span></span><br><span class="line"><span class="comment"># ä½†æ˜¯æˆ‘è¿˜æ˜¯å¸Œæœ›ä½ å¯ä»¥æŒæ¡ä¸Šé¢è¿™ç§è‡ªå®šä¹‰æ¨¡å‹çš„æ–¹æ³•, è¿™æ ·é‡åˆ° PyTorch æœªæä¾›çš„æ¨¡å‹, æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•è‡ªå·±å®ç°è¯¥æ¨¡å‹</span></span><br><span class="line">model = models.resnet50(pretrained=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†»ç»“å‚æ•° : å³ä¸æ›´æ–°æ¨¡å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment"># å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç , è¿™é‡Œè¡¨ç¤ºå†»ç»“äº†æ‰€æœ‰å±‚</span></span><br><span class="line"><span class="keyword">for</span> param <span class="keyword">in</span> model.parameters():</span><br><span class="line">    param.requires_grad = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢å±‚æ¥æ¥è§¦æŸäº›å±‚çš„å†»ç»“</span></span><br><span class="line">num_ftrs = model.fc.in_features         <span class="comment"># è¿™é‡Œæ˜¯è·å– ResNet50 çš„ fc å±‚çš„è¾“å…¥ç‰¹å¾æ•°</span></span><br><span class="line">model.fc = torch.nn.Linear(num_ftrs, <span class="number">2</span>) <span class="comment"># è¿™é‡Œæ˜¯å¯¹ fc å±‚è¿›è¡Œä¿®æ”¹, Linear(input_feather_num, output_feather_num)</span></span><br><span class="line">                                        <span class="comment"># è¿™é‡Œè¾“å…¥ç‰¹å¾æ•°æ˜¯ num_ftrs, è¾“å‡ºç‰¹å¾æ•°ä¸º 2 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸€è¡Œå¾ˆé‡è¦, æŒ‡å®šäº†æ¨¡å‹çš„ä½ç½®, cuda å¯ä»¥ç†è§£ä¸º GPU è®¾å¤‡, cuda: 0 è¡¨ç¤ºä½¿ç”¨ç¼–å·ä¸º 0 çš„GPUè¿›è¡Œè®­ç»ƒ</span></span><br><span class="line"><span class="comment"># å½“æœ‰å¤šå— GPU æ—¶, å¯ä»¥ç”¨å…¶ä»–çš„æ–¹å¼æŒ‡å®š GPU</span></span><br><span class="line"><span class="comment"># model = torch.nn.DataParallel(model, device_ids=[0, 1, 2]), å½“ç„¶å‘æˆ‘ä»¬è¿™ç§å°ç™½(ç©·B), å½“ç„¶è¿˜æ˜¯å•å¡ä¸ºä¸»</span></span><br><span class="line"><span class="comment"># ä¸ºäº†é¿å…å‡ºç°å¤šå¡çš„æƒ…å†µ, æˆ‘åœ¨ä¸‹é¢æ”¾å…¥ä¸¤ç¯‡åšå®¢, æœ‰å…´è¶£å¯ä»¥å‚è€ƒè¿™ä¸¤ç¯‡æ–‡ç« è¿›è¡Œå¤šå¡è®­ç»ƒ</span></span><br><span class="line"><span class="comment"># https://zhuanlan.zhihu.com/p/102697821</span></span><br><span class="line"><span class="comment"># https://blog.csdn.net/qq_34243930/article/details/106695877</span></span><br><span class="line">device = torch.device(<span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">model = model.to(device)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><strong>è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹</strong><ul>
<li>è¿™é‡Œéœ€è¦ç›´æ¥å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒ , ä¸€èˆ¬æ¥è¯´ , åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šåŠ å…¥ <strong>tqdm</strong> åº“ä½¿å¾—è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ– , æœ‰æ—¶æˆ‘ä»¬è¿˜ä¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜æ›´å¥½çš„è®­ç»ƒç»“æœ , å¹¶ä¸”è®¾ç½®æ–­ç‚¹è®­ç»ƒç­‰æ“ä½œ , æˆ‘åªä½¿ç”¨æœ€ç®€å•çš„æ–¹å¼è¿›è¡Œé¢„æµ‹</li>
<li><code>train</code> éƒ¨åˆ†çš„ä»£ç å› äººè€Œå¼‚, åŸºæœ¬ä¸Šæ¯ä¸ªäººçš„å†™æ³•éƒ½å¯èƒ½ä¸åŒ, æ²¡æœ‰å›ºå®šçš„å†™æ³•</li>
<li>å¯¹äºè®­ç»ƒå®Œçš„æ¨¡å‹æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œè¯„ä»·, ä¸€èˆ¬æ¥è¯´, è®­ç»ƒå’ŒéªŒè¯éƒ½æ˜¯æ”¾åœ¨ä¸€èµ·çš„, ä¸å¯åˆ†å¼€çš„</li>
<li>è®°å¾—ä¿å­˜ä¸€ä¸‹è®­ç»ƒåçš„æ¨¡å‹, ä½¿ç”¨å¦‚ä¸‹ä»£ç ä¿å­˜&#x2F;åŠ è½½æ•´ä¸ªæ¨¡å‹<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿å­˜æ¨¡å‹</span></span><br><span class="line">model_path = <span class="string">&quot;xxxx.pth&quot;</span>        <span class="comment"># xxxx è¡¨ç¤ºä¸€ä¸ªä½ å–œæ¬¢çš„åå­—</span></span><br><span class="line">torch.save(model, model_path)  <span class="comment"># ä½¿ç”¨ torch.save(model, model_path) ä¿å­˜æ¨¡å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ è½½æ¨¡å‹</span></span><br><span class="line">model = torch.load(model_path) <span class="comment"># ä½¿ç”¨ torch.load(model_path) å³å¯åŠ è½½æ¨¡å‹</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<p>å®Œæ•´çš„â€è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹â€ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> f1_score, accuracy_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span></span><br><span class="line"><span class="comment"># è¿™é‡ŒåŒ…å«äº† PyTorch çš„ 19 ç§æŸå¤±å‡½æ•° https://blog.csdn.net/qq_35988224/article/details/112911110</span></span><br><span class="line">criterion = torch.nn.CrossEntropyLoss()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters())</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— F1 å€¼å’Œ å‡†ç¡®ç‡</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evaluate</span>(<span class="params">loader, model</span>):</span><br><span class="line">    preds = []</span><br><span class="line">    targets = []</span><br><span class="line">    loop = tqdm(loader, total=<span class="built_in">len</span>(loader), leave=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> images, labels <span class="keyword">in</span> loop:</span><br><span class="line">        images, labels = images.to(device), labels.to(device)</span><br><span class="line">        <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">            outputs = model(images)</span><br><span class="line">        _, predicted = torch.<span class="built_in">max</span>(outputs, <span class="number">1</span>)</span><br><span class="line">        preds.extend(predicted.cpu().numpy())</span><br><span class="line">        targets.extend(labels.cpu().numpy())</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Update the progress bar</span></span><br><span class="line">        loop.set_description(<span class="string">&quot;Evaluating&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> f1_score(targets, preds), accuracy_score(targets, preds)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒå¾ªç¯</span></span><br><span class="line">best_f1 = <span class="number">0.0</span></span><br><span class="line">loss_values = []</span><br><span class="line">num_epochs = <span class="number">10</span>     <span class="comment"># å®šä¹‰è®­ç»ƒçš„è½®æ¬¡</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    model.train()   <span class="comment"># å°†æ¨¡å‹è®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼</span></span><br><span class="line">    loop = tqdm(train_loader, total=<span class="built_in">len</span>(train_loader), leave=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(loop)</span><br><span class="line">    <span class="keyword">for</span> images, labels <span class="keyword">in</span> loop:</span><br><span class="line">        images, labels = images.to(device), labels.to(device)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å‰å‘æ¨ç†</span></span><br><span class="line">        outputs = model(images)</span><br><span class="line">        loss = criterion(outputs, labels)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åå‘ä¼ æ’­åŠä¼˜åŒ–</span></span><br><span class="line">        <span class="comment"># åœ¨ç”¨ PyTorchè®­ç»ƒæ¨¡å‹æ—¶, é€šå¸¸ä¼šåœ¨éå† Epochs çš„è¿‡ç¨‹ä¸­ä¾æ¬¡ç”¨åˆ° </span></span><br><span class="line">        <span class="comment"># optimizer.zero_grad() : å…ˆå°†æ¢¯åº¦å½’é›¶</span></span><br><span class="line">        <span class="comment"># loss.backward() : åå‘ä¼ æ’­è®¡ç®—å¾—åˆ°æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦å€¼</span></span><br><span class="line">        <span class="comment"># optimizer.step() : é€šè¿‡æ¢¯åº¦ä¸‹é™æ‰§è¡Œä¸€æ­¥å‚æ•°æ›´æ–°</span></span><br><span class="line">        <span class="comment"># å¯¹äºè¿™ä¸‰ä¸ªå‡½æ•°, è¿™ç¯‡åšå®¢å†™çš„å¾ˆå¥½ : https://blog.csdn.net/PanYHHH/article/details/107361827</span></span><br><span class="line">        <span class="comment"># å¯ä»¥ç®€å•é˜…è¯»ä¸€é</span></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¿å­˜è¯¥æ‰¹æ¬¡çš„æŸå¤±</span></span><br><span class="line">        loss_values.append(loss.item())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°è¿›åº¦æ¡</span></span><br><span class="line">        loop.set_description(<span class="string">f&quot;Epoch [<span class="subst">&#123;epoch + <span class="number">1</span>&#125;</span>/<span class="subst">&#123;num_epochs&#125;</span>]&quot;</span>)</span><br><span class="line">        loop.set_postfix(loss=loss.item())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åœ¨æ¯è½®ä¹‹åéªŒè¯æ¨¡å‹</span></span><br><span class="line">    model.<span class="built_in">eval</span>()    <span class="comment"># å°†æ¨¡å‹è®¾ç½®ä¸ºæ¨ç†æ¨¡å¼, æ­¤æ—¶æ¨¡å‹ä¸­çš„å‚æ•°ä¸ä¼šè¿›è¡Œæ›´æ–°, å³å®Œå…¨ç”¨äºæ¨ç†/éªŒè¯</span></span><br><span class="line">    f1_value, accuracy = evaluate(valid_loader, model)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;F1 score: <span class="subst">&#123;f1_value:<span class="number">.4</span>f&#125;</span>, Accuracy: <span class="subst">&#123;accuracy:<span class="number">.4</span>f&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜ F1 å€¼æœ€é«˜çš„æ¨¡å‹</span></span><br><span class="line">    <span class="keyword">if</span> f1_value &gt; best_f1:</span><br><span class="line">        best_f1 = f1_value</span><br><span class="line">        <span class="comment"># è¿™é‡Œå’Œä¸Šé¢ Markdown çš„ä¿å­˜æ–¹å¼ä¸åŒ, model.state_dict(), è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°, ç®€å•æ¥è¯´å‘¢æˆ‘ä»¬ä»…ä»…ä¿å­˜äº†æ¨¡å‹çš„å‚æ•°, ä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰ä¿å­˜æ¨¡å‹çš„ç»“æ„</span></span><br><span class="line">        <span class="comment"># ä¸Šé¢ Markdown çš„ä¿å­˜æ–¹å¼æ˜¯å³ä¿å­˜äº†æ•´ä¸ªæ¨¡å‹çš„ç»“æ„, ä¹Ÿä¿å­˜äº†æ¨¡å‹çš„å‚æ•°</span></span><br><span class="line">        torch.save(model.state_dict(), <span class="string">&#x27;best_model.pth&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è®­ç»ƒç»“æŸ&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç»˜å›¾å‡½æ•°ï¼Œæ¥å±•ç¤ºè¿‡ç¨‹ä¸­çš„ç›¸å…³æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">8</span>))</span><br><span class="line">plt.plot(loss_values, label=<span class="string">&#x27;Train Loss&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Loss values over epochs&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Epochs&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<ol start="6">
<li><strong>æ¨ç†æ¨¡å‹</strong><ul>
<li>å¾ˆé«˜å…´, å¦‚æœä½ åˆ°è¿™ä¸€æ­¥, ä½ çš„æ°´å¹³è‚¯å®šå·²ç»æœ‰äº†è´¨çš„é£è·ƒ, è¿™é‡Œå·²ç»æ˜¯æœ€åä¸€æ­¥äº†, ç»“æŸè¿™ä¸ªéƒ¨åˆ†, ä½ å°±è¦å¼€å§‹è‡ªå·±çš„æ¢ç´¢ä¹‹è·¯äº† </li>
<li>æ¨ç†æ¨¡å‹å¾ˆç®€å•, æˆ‘åœ¨ä¸Šé¢è¯´è¿‡, æ„é€ æ¨¡å‹æ—¶æŒ‡å®šä»€ä¹ˆè¾“å…¥ , æ¨ç†çš„æ—¶å€™å°±è¦æŒ‡å®šä»€ä¹ˆè¾“å…¥, è¿™é‡Œå°±æ˜¯å¯¹åº”çš„éƒ¨åˆ†äº†</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> torchvision.transforms <span class="keyword">import</span> ToTensor, Resize, Normalize</span><br><span class="line"></span><br><span class="line"><span class="comment"># predict_by_file è¡¨ç¤ºæ¨ç†ä¸€ä¸ªæ–‡ä»¶, æˆ‘ä»¬éœ€è¦ä¼ å…¥æ–‡ä»¶è·¯å¾„ä»¥åŠæ¨¡å‹</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">predict_by_file</span>(<span class="params">file_path, model</span>):</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    image = Image.<span class="built_in">open</span>(file_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿™é‡Œçš„ transform æœ‰ä¸æ²¡æœ‰éƒ½æ— æ‰€è°“, çº¯çœ‹å¿ƒæƒ…</span></span><br><span class="line">    transform = transforms.Compose([</span><br><span class="line">        Resize((<span class="number">256</span>, <span class="number">256</span>)),</span><br><span class="line">        ToTensor(),</span><br><span class="line">        Normalize(mean=[<span class="number">0.485</span>, <span class="number">0.456</span>, <span class="number">0.406</span>], std=[<span class="number">0.229</span>, <span class="number">0.224</span>, <span class="number">0.225</span>]),</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    image = transform(image)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿™é‡Œå’Œä¸Šé¢ä¸€æ ·, è¡¨ç¤ºåœ¨æœ€å¤–é¢åŠ ä¸€å±‚æ‹¬å·, ä½¿ [3, 256, 256] å˜ä¸º [1, 3, 256, 256]</span></span><br><span class="line">    image = image.unsqueeze(<span class="number">0</span>).to(device)</span><br><span class="line"></span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        outputs = model(image)      <span class="comment"># æ¨¡å‹æ¨ç†</span></span><br><span class="line">        <span class="comment"># torch.max(...)</span></span><br><span class="line">        <span class="comment"># input (Tensor) â€“ è¾“å…¥å¼ é‡</span></span><br><span class="line">        <span class="comment"># dim (int) â€“ æŒ‡å®šçš„ç»´åº¦</span></span><br><span class="line">        _, predicted = torch.<span class="built_in">max</span>(outputs, <span class="number">1</span>)    <span class="comment"># è¿”å›æŒ‡å®šç»´åº¦çš„æœ€å¤§å€¼, å…¶å®è¿™é‡Œåªæœ‰ä¸€ç»´</span></span><br><span class="line">        <span class="built_in">print</span>(outputs)                          <span class="comment"># tensor([[0.7360, 0.2668]], device=&#x27;cuda:0&#x27;)</span></span><br><span class="line">        <span class="built_in">print</span>(outputs.shape)                    <span class="comment"># torch.Size([1, 2])</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Fake&quot;</span> <span class="keyword">if</span> predicted.item() == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&quot;Real&quot;</span></span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;./dataset/test/real/test_real_7.jpg&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(predict_by_file(path, model))</span><br></pre></td></tr></table></figure></div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatarMyself.jpg" alt="NilEra"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">NilEra</p><p class="is-size-6 is-block">C/C++ Developer!</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Jinan Shandong</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">39</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">38</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/NilEra-K" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/NilEra-K"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">é“¾æ¥</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/NilEra-K" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">GitHub</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://nano.chemtian.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Thymol Blue</span></span><span class="level-right"><span class="level-item tag">nano.chemtian.top</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†ç±»</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/CppDev/"><span class="level-start"><span class="level-item">CppDev</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/CppDev/Gaming/"><span class="level-start"><span class="level-item">Gaming</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/QT6/"><span class="level-start"><span class="level-item">QT6</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">å¤šçº¿ç¨‹ç¼–ç¨‹</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">ç½‘ç»œç¼–ç¨‹</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/"><span class="level-start"><span class="level-item">è¯­æ³•ç‚¹</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/bind/"><span class="level-start"><span class="level-item">bind</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/enum-class/"><span class="level-start"><span class="level-item">enum class</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/%E8%99%9A%E5%87%BD%E6%95%B0/"><span class="level-start"><span class="level-item">è™šå‡½æ•°</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/%E8%BD%AF%E4%BB%B6%E6%BA%90/"><span class="level-start"><span class="level-item">è½¯ä»¶æº</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">å¤§æ•°æ®æŠ€æœ¯</span></span><span class="level-end"><span class="level-item tag">8</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/ECharts/"><span class="level-start"><span class="level-item">ECharts</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/HBase/"><span class="level-start"><span class="level-item">HBase</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/Scala/"><span class="level-start"><span class="level-item">Scala</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/Spark/"><span class="level-start"><span class="level-item">Spark</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"><span class="level-start"><span class="level-item">æ•°æ®å¯è§†åŒ–</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">é¡¹ç›®</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">å¼€å‘å·¥å…·</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Axure-RP-9/"><span class="level-start"><span class="level-item">Axure RP 9</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/VSCode/"><span class="level-start"><span class="level-item">VSCode</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">æ•°æ®ç»“æ„/ç®—æ³•</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/%E5%93%88%E5%B8%8C-Hash/"><span class="level-start"><span class="level-item">å“ˆå¸Œ(Hash)</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/%E6%A0%88-Stack/"><span class="level-start"><span class="level-item">æ ˆ(Stack)</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/%E6%A0%91-Tree/"><span class="level-start"><span class="level-item">æ ‘(Tree)</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="level-start"><span class="level-item">æ·±åº¦å­¦ä¹ </span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Kaggle/"><span class="level-start"><span class="level-item">Kaggle</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/"><span class="level-start"><span class="level-item">LLMs</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/PyTorch/"><span class="level-start"><span class="level-item">PyTorch</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E9%97%B2%E8%81%8A/"><span class="level-start"><span class="level-item">é—²èŠ</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E9%97%B2%E8%81%8A/%E8%AE%A1%E5%88%92/"><span class="level-start"><span class="level-item">è®¡åˆ’</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">è®¢é˜…æ›´æ–°</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="è®¢é˜…"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-18T02:35:39.000Z">2024-08-18</time></p><p class="title"><a href="/2024/08/18/Create-AN-Environment-of-Kaggle/">Create_AN_Environment_of_Kaggle</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-17T01:24:42.000Z">2024-08-17</time></p><p class="title"><a href="/2024/08/17/RSNA-2024/">RSNA-2024</a></p><p class="categories"><a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a> / <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Kaggle/">Kaggle</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-15T09:21:54.000Z">2024-08-15</time></p><p class="title"><a href="/2024/08/15/Virtual-Destructor-IN-Cpp/">Virtual_Destructor_IN_Cpp</a></p><p class="categories"><a href="/categories/CppDev/">CppDev</a> / <a href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/">è¯­æ³•ç‚¹</a> / <a href="/categories/CppDev/%E8%AF%AD%E6%B3%95%E7%82%B9/%E8%99%9A%E5%87%BD%E6%95%B0/">è™šå‡½æ•°</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-13T12:19:01.000Z">2024-08-13</time></p><p class="title"><a href="/2024/08/13/Deploy-LLMs-ON-Linux/">Deploy_LLMs_ON_Linux</a></p><p class="categories"><a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a> / <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-12T15:10:23.000Z">2024-08-12</time></p><p class="title"><a href="/2024/08/12/Windows-Build-llama-cpp/">Windows Build llama.cpp</a></p><p class="categories"><a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">æ·±åº¦å­¦ä¹ </a> / <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/LLMs/">LLMs</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">å½’æ¡£</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">ä¸ƒæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">å››æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">ä¸‰æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">æ ‡ç­¾</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Axure-RP-9/"><span class="tag">Axure RP 9</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-11-%E6%96%B0%E6%A0%87%E5%87%86/"><span class="tag">C++ 11 æ–°æ ‡å‡†</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CppDev/"><span class="tag">CppDev</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ECharts/"><span class="tag">ECharts</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/EasyX/"><span class="tag">EasyX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GameDev/"><span class="tag">GameDev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HBase/"><span class="tag">HBase</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hadoop/"><span class="tag">Hadoop</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JavaDev/"><span class="tag">JavaDev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kaggle/"><span class="tag">Kaggle</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LLMs/"><span class="tag">LLMs</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LM-Studio/"><span class="tag">LM-Studio</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MyBatis-Plus/"><span class="tag">MyBatis-Plus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PowerInfer/"><span class="tag">PowerInfer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyTorch/"><span class="tag">PyTorch</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QT6/"><span class="tag">QT6</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/R/"><span class="tag">R</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scala/"><span class="tag">Scala</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spark/"><span class="tag">Spark</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tomcat/"><span class="tag">Tomcat</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VSCode/"><span class="tag">VSCode</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ZooKeeper/"><span class="tag">ZooKeeper</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BC%96%E7%A8%8B/"><span class="tag">å¤šçº¿ç¨‹ç¼–ç¨‹</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/"><span class="tag">å¤§æ•°æ®æŠ€æœ¯</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><span class="tag">å¼€å‘å·¥å…·</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="tag">æ•°æ®ç»“æ„</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="tag">æœºå™¨å­¦ä¹ </span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="tag">æ·±åº¦å­¦ä¹ </span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95/"><span class="tag">ç®—æ³•</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/"><span class="tag">ç½‘ç»œç¼–ç¨‹</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AE%A1%E5%88%92/"><span class="tag">è®¡åˆ’</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%AF%AD%E6%B3%95%E7%82%B9/"><span class="tag">è¯­æ³•ç‚¹</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%BD%AF%E4%BB%B6%E6%BA%90/"><span class="tag">è½¯ä»¶æº</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%97%B2%E8%81%8A/"><span class="tag">é—²èŠ</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A1%B9%E7%9B%AE/"><span class="tag">é¡¹ç›®</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/StarLogo.svg" alt="Hello, NilEra :-)" height="28"></a><p class="is-size-7"><span>&copy; 2024 NilEra</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2024 å‰æ–¹âš¡é«˜èƒ½</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/NilEra-K"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨Cookieæ¥æ”¹å–„æ‚¨çš„ä½“éªŒã€‚",
          dismiss: "çŸ¥é“äº†ï¼",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container" id="algolia-input"></div><div id="algolia-poweredby" style="display:flex;margin:0 .5em 0 1em;align-items:center;line-height:0"></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div><div class="searchbox-footer"></div></div></div><script src="https://cdnjs.loli.net/ajax/libs/algoliasearch/4.0.3/algoliasearch-lite.umd.js" crossorigin="anonymous" defer></script><script src="https://cdnjs.loli.net/ajax/libs/instantsearch.js/4.3.1/instantsearch.production.min.js" crossorigin="anonymous" defer></script><script src="/js/algolia.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadAlgolia({"applicationId":"2TB5ZZYPCO","apiKey":"00a43f1d62ca7b24c8b78d5f0223c065","indexName":"dev_nilera_blog"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","no_result":"æœªæ‰¾åˆ°æœç´¢ç»“æœ","untitled":"(æ— æ ‡é¢˜)","empty_preview":"(æ— å†…å®¹é¢„è§ˆ)"});
        });</script></body></html>