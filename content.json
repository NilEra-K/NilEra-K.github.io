{"posts":[{"title":"[20240412] ä¸‹ä¸€æ­¥è®¡åˆ’","text":"[Date: 20240412] ä¸‹ä¸€æ­¥è®¡åˆ’ğŸ“• è®¡åˆ’ 1: å­¦ä¹  Axure RP 9ä¸»è¦æ˜¯ä¸ºäº†è®¡åˆ’2åšå‡†å¤‡ ğŸ“• è®¡åˆ’ 2: å¼€å‘è®¡åˆ’å¼€å‘ä¸€ä¸ªå¥½ç©çš„å°å·¥å…·è¿™ä¸ªå…¶å®æ˜¯ä¸€ä¸ªå¥‡æ€å¦™æƒ³å•¦ï¼Œç›®å‰è¿˜ä¸çŸ¥é“èƒ½ä¸èƒ½å®ç°ï¼Œæ€»çš„æ¥è¯´å°±æ˜¯å¸Œæœ›ç”¨æˆ·ä¸Šä¼ ä¸€å¼ æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬è½¬åŒ–æˆå‘½ä»¤è¡Œå›¾ç‰‡ã€‚å°±ä¾‹å¦‚æˆ‘ç”¨çš„ç½‘ç«™åšå®¢çš„æ¡†æ¶ï¼Œä»–èƒ½ç”¨ç¬¦å·ç»˜åˆ¶ä¸€ä¸ªå¾ˆå¥½çœ‹ç»ˆç«¯æ¬¢è¿ç•Œé¢ï¼Œæˆ‘è§‰å¾—æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘å‡†å¤‡åœ¨æ¥ä¸‹æ¥çš„ä¸€å¹´æ—¶é—´é‡Œå®ç°è¿™ä¸ªå°å·¥å…·ã€‚ç›®å‰è¿æ–‡ä»¶å¤¹éƒ½æ²¡æœ‰åˆ›å»ºï¼Œå“ˆå“ˆå“ˆ :P 12345678INFO ======================================= â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â• â•šâ•â•â•šâ•â• â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•============================================= ä½¿ç”¨ QT 6 å¼€å‘ä¸€ä¸ªå¥½ç©çš„æ¡Œé¢ç«¯åº”ç”¨åˆ·æŠ–éŸ³çš„æ—¶å€™çœ‹åˆ°äº†ï¼Œä¸€äº›å¾ˆå¥½ç©çš„è¯„è®ºï¼Œå› ä¸ºå¤§å®¶å¥½åƒè§‰å¾—å°çº¢ä¹¦æ˜¯ä¸€ä¸ªç»™å¥³å­©å­äº¤æµçš„å¹³å°ï¼Œæ‰€ä»¥ç”·å­©å­ä¹Ÿå¸Œæœ›æœ‰ä¸€ä¸ªè‡ªå·±äº¤æµçš„å¹³å°ï¼Œå¤§æ¦‚å°±æ˜¯å°è“ä¹¦çš„æ ·å­ã€‚è¿™ä¹Ÿæ˜¯ä¸ªå¾ˆå¤§çš„é¡¹ç›®äº†ï¼Œéœ€è¦å¾ˆé•¿æ—¶é—´è®¾è®¡ï¼Œä¸è¿‡æœ€èµ·ç è¦ç­‰æˆ‘å­¦å®ŒAxure RP 9 å§ï¼Œå½“ç„¶è‚¯å®šä¸æ˜¯å…¨éƒ¨å®ç°ï¼Œæˆ‘å°±æ˜¯æƒ³è¾¹å­¦è¾¹å¼€å‘ï¼Œèƒ½åšå¤šå°‘æ˜¯å¤šå°‘çš„æ ·å­ã€‚ ğŸ“• è®¡åˆ’ 3: è¯»ä¹¦","link":"/2024/04/12/20240412-%E4%B8%8B%E4%B8%80%E6%AD%A5%E8%AE%A1%E5%88%92/"},{"title":"Gitå¸¸ç”¨æŒ‡ä»¤","text":"Git å¸¸ç”¨å‘½ä»¤ åˆå§‹åŒ–ä»“åº“:git init æŸ¥çœ‹å½“å‰ä»“åº“çš„çŠ¶æ€git status åˆ‡æ¢åˆ†æ”¯ åˆ‡æ¢åˆ°å·²æœ‰ branchName åˆ†æ”¯git checkout branchName åˆ›å»ºæ–°åˆ†æ”¯ï¼Œåˆ›å»ºçš„åŒæ—¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯git checkout -b newBranch æŸ¥çœ‹æ‰€åœ¨ç›®å½•çš„åˆ†æ”¯git branch -a æ‹‰å–è¯·æ±‚git pull ä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“(GitHub) åœ¨ GitHub é…ç½® SSH_KEY æŸ¥çœ‹æœ¬åœ°æ˜¯å¦å…·æœ‰å·²å­˜åœ¨ ssh_key : ll ~/.ssh å¦‚æœä¸å­˜åœ¨åˆ™ç”Ÿæˆ ssh_key : ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot; å¦‚æœå­˜åœ¨åˆ™å¤åˆ¶ ssh_key çš„å†…å®¹ : cat ~/.ssh/id_rsa.pub åœ¨ GitHub ä¸Šæ·»åŠ å…¬é’¥ : Settings â†’ SSH and GPG Keys â†’ New SSH Key éªŒè¯æ˜¯å¦æˆåŠŸ : ssh -T git@github.com å…‹éš†è¿œç¨‹ä»“åº“ : git clone &lt;SSH_Addr&gt; æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€:git remote add origin &lt;git_addr&gt; æ·»åŠ æ–‡ä»¶ git add &lt;files&gt; æ·»åŠ æ³¨é‡Š git commit -m &quot;f&quot; æ¨é€è¯·æ±‚ git push -u origin main","link":"/2024/03/26/Git%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4/"},{"title":"Axure RP 9 äº§å“è®¾è®¡å…¥é—¨","text":"ğŸšªAxure RP 9 äº§å“è®¾è®¡å…¥é—¨Axure RP 9 è½¯ä»¶çš„å®‰è£…å¯ä»¥ç›´æ¥å®˜ç½‘ä¸‹è½½ï¼Œç„¶åå»æŸå®ä¹°ä¸€ä¸ªè´¦å·çš„æ¿€æ´»ç ï¼Œè¯¦æƒ…ä¸å†èµ˜è¿°ï¼Œå¯ä»¥è‡ªè¡Œ Bingã€‚ä¸‹è½½ç½‘å€ï¼šhttps://www.axure.com/release-history/rp9 Axure è½¯ä»¶çš„ä¸€äº›åŸºç¡€è®¾ç½® åå¥½è®¾ç½® æ–‡ä»¶ â†’ Preferencesï¼ˆé¦–é€‰é¡¹ã€åå¥½è®¾ç½®ï¼‰ ç½‘æ ¼è®¾ç½® è§†å›¾è®¾ç½® â†’ æ ‡å°ºÂ·ç½‘æ ¼Â·è¾…åŠ©çº¿ â†’ ç½‘æ ¼è®¾ç½® æˆ‘ä¸ªäººè®¤ä¸ºèˆ’æœçš„è®¾ç½®ï¼šç½‘æ ¼å¯¹é½ï¼Œé—´è· 10 åƒç´ ï¼Œæ ·å¼æ›´æ”¹ä¸ºçº¿æ®µï¼Œé¢œè‰² #F2F2F2 å¦‚ä½•é¢„è§ˆã€å‘ç»™åˆ«äººå¯ä»¥æµè§ˆçš„æ–‡ä»¶å‘å¸ƒ â†’ ç”Ÿæˆ HTML æ–‡ä»¶ï¼ˆé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¼šç”Ÿæˆå¾ˆå¤šæ–‡ä»¶ï¼Œå› æ­¤æœ€å¥½é€‰æ‹©ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶å¤¹ï¼‰ å¸¸ç”¨çš„è®¾è®¡å°ºå¯¸æ‰‹æœºç«¯ï¼š365*667 å¼€å§‹è®¾è®¡ç»˜åˆ¶ä¸€ä¸ªç®€å•çš„UIç•Œé¢ ç”¨çŸ©å½¢ç»˜åˆ¶ä¸€ä¸ªèƒŒæ™¯ï¼šä½¿ç”¨çº¿æ€§æ–¹å¼å¡«å…… ç”¨æ°´å¹³çº¿ç»˜åˆ¶éš”æ–­ ç”¨çŸ©å½¢ç»˜åˆ¶æŒ‰é’® å¦‚ä½•ç»˜åˆ¶æŒ‰é’®ä½¿ç”¨çŸ©å½¢ç»˜åˆ¶ä¸€ä¸ªæŒ‰é’® ç»˜åˆ¶çŸ©å½¢ å³é”®çŸ©å½¢ â†’ äº¤äº’æ ·å¼ ç¾åŒ–è¾“å…¥æ¡† ç»˜åˆ¶çŸ©å½¢ Ctrl + D å¤åˆ¶ä¸€ä»½ï¼Œè°ƒæ•´å¤§å° æ·»åŠ è¾“å…¥æ¡†å’Œä¸€ä¸ªæœç´¢å›¾æ ‡ æ¯ç‰ˆé€‰æ‹©ç»˜åˆ¶å¥½çš„ç»„ä»¶ï¼Œå³é”®é€‰æ‹©è½¬æ¢ä¸ºæ¯ç‰ˆ å•é€‰æ¡†çš„ä½¿ç”¨å’Œè‡ªå®šä¹‰å•é€‰æ¡†ï¼ˆç¾åŒ–æ“ä½œï¼‰ä½¿ç”¨å•é€‰æ¡†æ—¶ï¼Œéœ€è¦å¯¹å•é€‰æ¡†è¿›è¡Œç¼–ç»„ã€‚ç¼–ç»„æ–¹å¼ï¼šæ¡†é€‰å¯¹åº”ç»„çš„å•é€‰æ¡†ï¼Œå³é”®é€‰æ‹©æŒ‡å®šå•é€‰æŒ‰é’®çš„ç»„ï¼Œç„¶åå‘½åç»„åå³å¯ã€‚è‡ªå®šä¹‰å•é€‰æ¡†æ“ä½œæ­¥éª¤ï¼š ä½¿ç”¨åœ†å½¢ç»˜åˆ¶ä¸€ä¸ªå¤§åœ†ä»¥åŠä¸€ä¸ªå°åœ† å†…éƒ¨çš„å°åœ†çš„çº¿æ¡å’Œå¡«å……è®¾ç½®ä¸ºé€æ˜ å³é”®æ·»åŠ äº¤äº’æ ·å¼ï¼Œè®¾ç½®å½“é€‰ä¸­æ—¶ï¼Œå†…éƒ¨å°åœ†çš„å¡«å……å’Œçº¿æ¡æ›´æ”¹é¢œè‰²ï¼Œå¤–éƒ¨å¤§åœ†çº¿æ¡æ›´æ”¹é¢œè‰² æ·»åŠ æ–‡å­—åè¿›è¡Œç¼–ç»„ï¼Œå¯¹äºç¼–ç»„å†…å®¹è®¾ç½®äº¤äº’ï¼ˆå’Œäº¤äº’æ ·å¼ä¸åŒï¼‰ï¼Œåœ¨èœå•æ çš„å³ä¾§ï¼Œäº¤äº’é¢æ¿ æ•ˆæœå¦‚ä¸‹ï¼š","link":"/2024/04/12/Axure-RP-9-%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1%E5%85%A5%E9%97%A8/"},{"title":"PyTorchå¿«é€Ÿä¸Šæ‰‹æŒ‡å—","text":"PyTorch æ·±åº¦å­¦ä¹ æ¡†æ¶å¿«é€Ÿä¸Šæ‰‹æŒ‡å—PyTorch å¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ , å¸¸åº”ç”¨äºæ­å»ºæ·±åº¦å­¦ä¹ ç½‘ç»œ , å®Œæˆä¸€äº›æ·±åº¦å­¦ä¹ ä»»åŠ¡ (CVã€NLPé¢†åŸŸ) è¦æƒ³å¿«é€Ÿä¸Šæ‰‹ PyTorch , ä½ éœ€è¦çŸ¥é“ä»€ä¹ˆ : ä¸€ä¸ªé¡¹ç›®çš„å®Œæ•´æµç¨‹ , å³åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹ å‡ ä¸ªå¸¸ç”¨ (æˆ–è€…è¯´å¿…å¤‡çš„) ç»„ä»¶ å‰©ä¸‹çš„æ—¶é—´ä½ å°±éœ€è¦äº†è§£ , å®Œæˆä»€ä¹ˆä»»åŠ¡ , éœ€è¦ä»€ä¹ˆç½‘ç»œ , è€Œä¸”éœ€è¦ç”¨å¤§é‡çš„æ—¶é—´å»åšè¿™ä»¶äº‹æƒ… $^{(e.g.)}$ä¾‹å¦‚ : ä½ ç°åœ¨æœ‰ä¸€ä¸ªå›¾åƒåˆ†ç±»ä»»åŠ¡ , å®Œæˆè¯¥ä»»åŠ¡éœ€è¦ä»€ä¹ˆç½‘ç»œ, ä½ éœ€è¦é€šè¿‡æŸ¥æ‰¾èµ„æ–™æ¥äº†è§£éœ€è¦æŸ¥æ‰¾ä»€ä¹ˆç½‘ç»œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ , æœ‰ä¸€äº›å¸¸è¯†æ€§çš„é—®é¢˜ä½ å¿…é¡»çŸ¥é“ , ä¾‹å¦‚: å›¾åƒå±‚é¢æ— æ³•æˆ–å¾ˆéš¾ä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³• , å·ç§¯ç¥ç»ç½‘ç»œæœ€å¤šçš„æ˜¯åº”ç”¨äºå›¾åƒé¢†åŸŸç­‰ ä¸‹é¢æˆ‘å°†é€šè¿‡ä¸€ä¸ªå…·ä½“çš„åˆ†ç±»é¡¹ç›®æµç¨‹æ¥è®²è¿°åˆ°ä»€ä¹ˆç‚¹è¯¥å¹²ä»€ä¹ˆäº‹ä¸€ä¸ªå®Œæ•´çš„ PyTorch åˆ†ç±»é¡¹ç›®éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ–¹é¢: å‡†å¤‡æ•°æ®é›† åŠ è½½æ•°æ®é›† ä½¿ç”¨å˜æ¢(Transformsæ¨¡å—) æ„å»ºæ¨¡å‹ è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹ æ¨ç†æ¨¡å‹ å‡†å¤‡æ•°æ®é›† ä¸€èˆ¬æ¥è¯´ , æ¯”èµ›ä¼šç»™å‡ºä½ æ•°æ®é›†, ä¸åŒæ•°æ®é›†çš„ç»„ç»‡æ–¹å¼ä¸åŒ , æˆ‘ä»¬è¦æƒ³åŠæ³•æŠŠä»–æ„é€ æˆæˆ‘ä»¬æœŸå¾…çš„æ ·å­ åˆ†ç±»æ•°æ®é›†ä¸€èˆ¬æ¯”è¾ƒç®€å•, ä¸€èˆ¬æ˜¯å°†æŸä¸ªåˆ†ç±»çš„æ–‡ä»¶å…¨éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­, ä¾‹å¦‚: äºŒåˆ†ç±»é—®é¢˜ : Fake(æ–‡ä»¶å¤¹) / Real(æ–‡ä»¶å¤¹) å¤šåˆ†ç±»é—®é¢˜ : åˆ†ç±» 1(æ–‡ä»¶å¤¹) / åˆ†ç±» 2(æ–‡ä»¶å¤¹) / â€¦ / åˆ†ç±» N(æ–‡ä»¶å¤¹) å½“ç„¶æœ‰äº›æ—¶å€™ä»–ä»¬ä¼šç»™å‡ºå…¶ä»–æ–¹å¼ , å¦‚ UBC-OCEAN , ä»–ä»¬å°†æ‰€æœ‰çš„å›¾ç‰‡æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ , å¹¶ç”¨ csv æ–‡ä»¶å­˜å‚¨è¿™äº›æ–‡ä»¶çš„è·¯å¾„(æˆ–è€…æ˜¯æ–‡ä»¶å) , ç„¶ååœ¨ csv æ–‡ä»¶ä¸­è¿›è¡Œæ ‡æ³¨(å¦‚ä¸‹): ä»¥åä½ å¯èƒ½è¿˜ä¼šé‡åˆ°æ›´å¤æ‚çš„ç›®æ ‡æ£€æµ‹çš„æ•°æ®é›†, è¿™ç§æ•°æ®é›†ä¼šæœ‰ä¸€äº›å›ºå®šæ ¼å¼ , å¦‚ VOCæ ¼å¼ , COCOæ ¼å¼ç­‰ åœ¨æ•°æ®é›†æ–¹é¢ , éœ€è¦æ˜ç¡®ä¸‰ä¸ªæ¦‚å¿µâ€”â€”è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›† , è¯·åŠ¡å¿…æ˜ç¡®è¿™ä¸‰ä¸ªæ¦‚å¿µ , è¿™æ˜¯åŸºæœ¬ä¸­çš„åŸºæœ¬ è®­ç»ƒé›†(Train) : å­—å¦‚å…¶å , ç®€å•æ¥è¯´å°±æ˜¯çŸ¥é“æ•°æ® , ä¹ŸçŸ¥é“æ ‡ç­¾ çš„æ•°æ® , æˆ‘ä»¬ç”¨å…¶è¿›è¡Œè®­ç»ƒ éªŒè¯é›†(Valid) : éªŒè¯é›† å’Œ æµ‹è¯•é›† æ˜¯éå¸¸å®¹æ˜“æ··æ·†çš„æ¦‚å¿µ , ç®€å•æ¥è¯´ , éªŒè¯é›†å°±æ˜¯æˆ‘ä»¬ä¹ŸçŸ¥é“æ•°æ®å’Œæ ‡ç­¾ , ä½†æ˜¯æˆ‘ä»¬çš„ä¸€èˆ¬ä¸å°†è¿™äº›æ•°æ®ç”¨äºè®­ç»ƒ , è€Œæ˜¯å°†ä»–ä»¬å½“ä½œæˆ‘ä»¬çš„æµ‹è¯•é›† , å³æˆ‘ä»¬å·²ç»ç«™åœ¨äº†å‡ºé¢˜äººçš„è§’åº¦ , ç»™å‡ºå‚èµ›è€…è¾“å…¥æ•°æ® , è€Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°æ®å¯¹åº”çš„è¾“å‡º , ä½†æ˜¯æˆ‘ä»¬ä¸è®©æ¨¡å‹çŸ¥é“ æµ‹è¯•é›†(Test) : æµ‹è¯•é›†å°±æ˜¯ , æˆ‘ä»¬ä¸çŸ¥é“è¾“å…¥æ•°æ®çš„è¾“å‡ºæ ‡ç­¾ , åªæœ‰çœŸæ­£çš„å‡ºé¢˜äººçŸ¥é“ , ä¸€èˆ¬æ¥è¯´ , æˆ‘ä»¬æ— æ³•æ‹¿åˆ°æµ‹è¯•é›† , æµ‹è¯•é›†æ˜¯ç”±å‡ºé¢˜äººæŒæ§çš„ éœ€è¦æ³¨æ„çš„æ˜¯ , å¦‚æœä½ é€šè¿‡æŸç§é€”å¾„çŸ¥é“äº†æ‰€æœ‰çš„æµ‹è¯•é›†çš„æ ‡ç­¾æ—¶ , ä¸å¯ä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œè®­ç»ƒ , è¿™æ˜¯éå¸¸ä¸¥é‡çš„å­¦æœ¯ä¸ç«¯è¡Œä¸º , ä¼šè¢«å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œå”¾å¼ƒ 1234567891011# ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªæ•°æ®é›† , æˆ‘å°†ä»¥ FAKE_OR_REAL æ•°æ®é›†ä¸ºä¾‹ , å±•ç¤ºæˆ‘ä»¬æ•°æ®é›†çš„ç»“æ„# D:\\REAL_OR_FAKE\\DATASET# â”œâ”€test --------- æµ‹è¯•é›†è·¯å¾„, è¿™é‡Œå¯ä»¥æ”¾ä½ è‡ªå·±çš„æ•°æ®, ä½ ç”šè‡³å¯ä»¥å°†ä»–ä»¬åˆ†ç±», ä½†æ˜¯è¯·æ³¨æ„, å®é™…æƒ…å†µä¸‹ä½ åªèƒ½é€šè¿‡è¿™ç§æ–¹å¼æ¥â€œå¾—åˆ°â€æµ‹è¯•é›†# â”‚ â”œâ”€fake ------ ä½ è‡ªå·±åˆ†çš„ç±», å¼€å¿ƒå°±å¥½# â”‚ â””â”€real ------ åŒä¸Š# â”œâ”€train -------- è®­ç»ƒé›†è·¯å¾„, è¿™é‡Œé¢æ”¾çš„æ˜¯é¢˜ç›®ç»™å‡ºçš„æ•°æ®, ä¸‹é¢æœ‰ fake å’Œ real ä¸¤ä¸ªæ–‡ä»¶å¤¹, è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­å°±æ˜¯ä¸¤ä¸ªç±»åˆ«, æˆ‘ä»¬è¦ç”¨è¿™é‡Œé¢çš„å›¾ç‰‡è¿›è¡Œåˆ†ç±» # â”‚ â”œâ”€fake# â”‚ â””â”€real# â””â”€valid -------- éªŒè¯é›†è·¯å¾„, è¿™é‡Œé¢æ”¾çš„æ˜¯é¢˜ç›®ç»™å‡ºçš„æ•°æ®, ä¸‹é¢æœ‰ fake å’Œ real ä¸¤ä¸ªæ–‡ä»¶å¤¹, è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸­å°±æ˜¯ä¸¤ä¸ªç±»åˆ«, è¿™é‡Œé¢çš„å›¾ç‰‡ä¸éœ€è¦è¿›è¡Œè®­ç»ƒ# â”œâ”€fake# â””â”€real åŠ è½½æ•°æ®é›† è¯·åŠ¡å¿…è®°ä½ , ä¸ç®¡æ˜¯ä»€ä¹ˆæ•°æ®é›† , æ•°æ®é›†æ˜¯å¦‚ä½•æ„æˆçš„ , åœ¨ä½¿ç”¨ PyTorch æ¡†æ¶æ—¶ , æˆ‘ä»¬éƒ½è¦åƒå°½åŠæ³•å°†ä»–ä»¬åŠ è½½å…¥ Dataset ç±»ä¸­ ç®€å•æ¥è¯´ , Dataset ç±»å°±æ˜¯æè¿°äº†æˆ‘ä»¬æ•°æ®çš„ç»„æˆçš„ç±» éœ€è¦æ³¨æ„ , PyTorch å®ç°äº†è®¸å¤šè‡ªå·±çš„ Dataset ç±» , è¿™äº›ç±»å¯ä»¥è½»æ¾çš„åŠ è½½ç‰¹å®šæ ¼å¼çš„æ•°æ®é›† , ä½†æ˜¯æˆ‘å¼ºçƒˆå»ºè®®æ‰€æœ‰çš„æ•°æ®é›†éƒ½è¦è‡ªå·±ç»§æ‰¿Datasetç±» , è‡ªè¡ŒåŠ è½½ , è¿™æ ·æˆ‘ä»¬å¯ä»¥è·Ÿæ¸…æ™°çš„æŒ‡å¯¼æ•°æ®é›†çš„ç»„æˆæ–¹å¼ , ä¹Ÿå¯ä»¥ä½¿å¾—æˆ‘ä»¬åŠ è½½ä»»æ„æ ¼å¼çš„æ•°æ®é›† å®ç° DataSet ç±»éœ€è¦æˆ‘ä»¬å…ˆç»§æ‰¿ Dataset ç±» , åœ¨ç»§æ‰¿ Dataset ç±»å, æˆ‘ä»¬åªéœ€è¦å®ç°å…¶ä¸­çš„__init__ã€__len__å’Œ__getitem__ä¸‰ä¸ªæ–¹æ³• , å³å¯å®Œæˆå¯¹æ•°æ®é›†çš„åŠ è½½ , è¿™ä¸‰ä¸ªæ–¹æ³•å°±å’Œä»–çš„åå­—ä¸€æ · : __init__ æ–¹æ³•æ˜¯æ„é€ å‡½æ•° , ç”¨äºåˆå§‹åŒ– __len__ æ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å¤§å° __getitem__ æ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å…ƒç´  , æˆ‘å°†ä»ä¸‹é¢çš„ä»£ç ä¸­è¿›è¡Œæ›´è¯¦ç»†çš„è§£é‡Š æœ‰äº›æ•°æ®é›†å¹¶ä¸åˆ†åˆ«æä¾› Trainè®­ç»ƒé›† å’Œ ValidéªŒè¯é›†, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ random_split() æ–¹æ³•å¯¹æ•°æ®é›†è¿›è¡Œåˆ’åˆ† éœ€è¦æ³¨æ„çš„æ˜¯, æ¯æ¬¡é‡æ–°åˆ’åˆ†æ•°æ®é›†æ—¶, å¿…é¡»é‡æ–°è®­ç»ƒæ¨¡å‹, å› ä¸º random_split() æ–¹æ³•éšæœºæ€§, åˆ’åˆ†åçš„æ•°æ®ä¸å¯èƒ½å’Œä¹‹å‰çš„æ•°æ®å®Œå…¨é‡åˆ, å› æ­¤ä¼šå¯¼è‡´æ•°æ®äº¤å‰çš„æƒ…å†µ, ä¸‹é¢ä¸€æ®µä½¿ç”¨ random_split() è¿›è¡Œåˆ’åˆ†çš„ Python ä»£ç ç¤ºä¾‹ : 12345678# ä¸‹é¢æ¼”ç¤ºä½¿ç”¨ random_split æ¥åˆ’åˆ†æ•°æ®é›†çš„æ“ä½œ# æˆ‘ä»¬å‡è®¾å·²ç»å®šä¹‰äº† CustomImageDataSetsplit_ratio = 0.8 # è¡¨ç¤ºåˆ’åˆ†æ¯”ä¾‹ä¸º 8 : 2dataset = CustomImageDataSet(fake_dir, real_dir) # å®šä¹‰ CustomImageDataSet ç±», å‡è®¾æ­¤æ—¶æ²¡æœ‰åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†train_dataset_num = int(dataset.lens * split_ratio) # å®šä¹‰è®­ç»ƒé›†çš„å¤§å°valid_dataset_num = dataset.lens - train_dataset_num # å®šä¹‰éªŒè¯é›†çš„å¤§å°# random_split(dataset, [train_dataset_num, valid_dataset_num]) è¡¨ç¤ºå°† dataset æŒ‰ç…§ [train_dataset_num: valid_dataset_num] çš„æ¯”ä¾‹è¿›è¡Œåˆ’åˆ†train_dataset, valid_dataset = random_split(dataset, [train_dataset_num, valid_dataset_num]) å½“æ•°æ®é›†ä¸æ˜¯å¾ˆå¤§çš„æ—¶, æ¨èäººä¸ºçš„å°†æ•°æ®é›†è¿›è¡Œåˆ’åˆ†, å¯ä»¥å†™ä¸€ä¸ª Python è„šæœ¬(.py) æˆ–è€… æ‰¹å¤„ç†è„šæœ¬(.bat) æ¥å®Œæˆè¿™ä¸ªæ“ä½œ å®Œæ•´çš„æ•°æ®é›†åŠ è½½ä»£ç å¦‚ä¸‹: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051import torchfrom torch.utils.data import Datasetimport osfrom PIL import Image# è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª CustomImageDataset(...) ç±», æ‹¬å·ä¸­çš„å†…å®¹è¡¨ç¤ºæˆ‘ä»¬ç»§æ‰¿äº† ... ç±»# å› æ­¤æˆ‘ä»¬è¿™é‡Œ CustomImageDataset(Dataset): è¡¨ç¤ºæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªâ€œè‡ªå®šä¹‰å›¾ç‰‡â€ç±», è¿™ä¸ªâ€œè‡ªå®šä¹‰å›¾ç‰‡â€ç±»ç»§æ‰¿è‡ª Dataset ç±»class CustomImageDataset(Dataset): # è¿™é‡Œæˆ‘ä»¬å®ç° __init__ æ–¹æ³•, __init__ æ–¹æ³•å…¶å®å°±æ˜¯ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°, ä»–ä¹Ÿåˆ†æœ‰å‚æ„é€ å’Œæ— å‚æ„é€ , åªæ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬è¯´æ— å‚æ„é€ åŸºæœ¬æ²¡å•¥æ„ä¹‰ # å› æ­¤æˆ‘ä»¬å¸¸å¸¸å®ç°è¿™ä¸ªç±», ä½¿å¾—å¯ä»¥æŒ‡å®šè¿™ä¸ªç±»çš„è¾“å…¥è¾“å‡º # æ¯”å¦‚ä¸‹é¢æˆ‘ä»¬å†™çš„ def __init__(self, fake_dir, real_dir, transform=None): # self : è‡ªå·±, æˆ‘ä¸€èˆ¬ç›´æ¥ç†è§£ä¸º this æŒ‡é’ˆ, å¦‚æœæœ‰å…´è¶£äº†è§£æ›´æ·±å±‚çš„ä¸œè¥¿å¯ä»¥æŸ¥é˜…ä¸€äº›èµ„æ–™, è¿™ä¸ªæ˜¯å¿…å¡«çš„ # fake_dir : ç”¨äºæŒ‡å®š fake ç±»å‹å›¾ç‰‡çš„ä½ç½®çš„ # real_dir : ç”¨äºæŒ‡å®š real ç±»å‹å›¾ç‰‡çš„ä½ç½®çš„ # transform : ç”¨äºæŒ‡å®šå˜æ¢, ç®€å•æ¥è¯´å°±æ˜¯å¯¹è¾“å…¥è¿›è¡ŒæŸäº›æ“ä½œ, æˆ‘ä¼šåœ¨ä¸‹é¢çš„æ¿å—ä¸­è¿›è¡Œè¯¦ç»†å™è¿° def __init__(self, fake_dir, real_dir, transform=None): self.fake_dir = fake_dir # è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª fake_dir, å…¶å€¼ä¸ºä¼ å…¥çš„ fake_dir self.real_dir = real_dir # è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª real_dir, å…¶å€¼ä¸ºä¼ å…¥çš„ real_dir self.transform = transform # è¿™é‡Œè¡¨ç¤ºè¿™ä¸ªç±»å†…å®šä¹‰äº†ä¸€ä¸ª transform, å…¶å€¼ä¸ºä¼ å…¥çš„ transform, å½“æ²¡æœ‰ä¼ å…¥æ—¶, è¿™ä¸ªå˜é‡ä¸º None self.fake_images = os.listdir(fake_dir) # ä¼ å…¥çš„ fake_dir æ˜¯ä¸€ä¸ªè·¯å¾„, æˆ‘ä»¬ä½¿ç”¨ os.listdir(fake_dir) å¯ä»¥åŠ è½½ fake_dir æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹, ä¹Ÿå°±æ˜¯æ‰€æœ‰ fake å›¾ç‰‡ self.real_images = os.listdir(real_dir) # ä¼ å…¥çš„ real_dir æ˜¯ä¸€ä¸ªè·¯å¾„, æˆ‘ä»¬ä½¿ç”¨ os.listdir(real_dir) å¯ä»¥åŠ è½½ real_dir æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹, ä¹Ÿå°±æ˜¯æ‰€æœ‰ real å›¾ç‰‡ self.total_images = self.fake_images + self.real_images # æ€»å›¾ç‰‡åˆ—è¡¨, å°±æ˜¯å°† fake å›¾ç‰‡åˆ—è¡¨å’Œ real å›¾ç‰‡åˆ—è¡¨è¿›è¡Œç»„åˆ self.labels = [0]*len(self.fake_images) + [1]*len(self.real_images) # å¯¹å›¾ç‰‡æ‰“æ ‡ç­¾, fake ä¸º 0, real ä¸º 1 # [0] * 10 å¾—åˆ°çš„ç»“æœä¸º [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] # [1] * 10 å¾—åˆ°çš„ç»“æœä¸º [1, 1, 1, 1, 1, 1, 1, 1, 1, 1] # è¿™é‡Œæˆ‘ä»¬å®ç° __len__ æ–¹æ³•, è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æ•°æ®é›†çš„å¤§å° def __len__(self): return len(self.total_images) # è¿™é‡Œæˆ‘ä»¬ç›´æ¥è¿”å›æ€»å›¾ç‰‡åˆ—è¡¨çš„é•¿åº¦å³å¯, è¿™é‡Œçš„å®ç°æ–¹å¼ä¸å”¯ä¸€, åªè¦èƒ½åšåˆ°è¡¨ç¤ºæ•°æ®é›†å¤§å°å³å¯ # è¿™é‡Œæˆ‘ä»¬å®ç° __getitem__ æ–¹æ³•, è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æ•°æ®é›†ä¸­çš„æŸä¸ªå…ƒç´  # å…¶ä¸­ idx è¡¨ç¤ºç´¢å¼•, è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„, å½“ç„¶å¯ä»¥èµ·å…¶ä»–åå­—, ä¸è¿‡æœ€å¥½è¿˜æ˜¯ä½¿ç”¨ idx # __getitem__(self, idx) è¡¨ç¤ºè·å– idx ä½ç½®çš„å…ƒç´  def __getitem__(self, idx): # è¿™é‡Œè¡¨ç¤ºè·å–ä¸€ä¸ªå…ƒç´ çš„é€»è¾‘ # å½“ idx ä½ç½®çš„æ ‡ç­¾ä¸º 0 æ—¶, å›¾ç‰‡çš„è·¯å¾„ä¸º fake_dir + self.total_images[idx], idx å³ä¸ºå›¾ç‰‡çš„ç´¢å¼•ä½ç½® # å½“ idx ä½ç½®çš„æ ‡ç­¾ä¸º 1 æ—¶, å›¾ç‰‡çš„è·¯å¾„ä¸º real_dir + self.total_images[idx] image_path = os.path.join(self.fake_dir if self.labels[idx] == 0 else self.real_dir, self.total_images[idx]) # ä½¿ç”¨ PIL åº“åŠ è½½å›¾ç‰‡, é€šè¿‡ image_path æ‰“å¼€å›¾ç‰‡, å¹¶ä¸”å°†å›¾ç‰‡è½¬åŒ–ä¸º RGB æ ¼å¼ image = Image.open(image_path).convert('RGB') # è¿™é‡Œæ˜¯ transform, è¡¨ç¤ºå˜æ¢, å½“å…¶å€¼ä¸º None æ—¶ä¸è¿›è¡Œæ“ä½œ, å½“ä¼ å…¥è‡ªå·±çš„ transform æ—¶å³ä¸ºéç©º, å³å¯¹è¾“å…¥æ•°æ®è¿›è¡Œå˜æ¢ if self.transform: # æˆ‘ä»¬å°†å˜æ¢åçš„å›¾ç‰‡ç›´æ¥ä¿å­˜åœ¨åŸä½ç½® image = self.transform(image) # æœ€åå‡½æ•°çš„è¿”å›å€¼ä¸º image å’Œ self.labels[idx], å³è¡¨ç¤ºç´¢å¼•ä½ç½® idx å¤„çš„å›¾ç‰‡å’Œæ ‡ç­¾ return image, self.labels[idx] ä½¿ç”¨ Transforms ä¸è¦ç®€å•çš„ä½¿ç”¨åŸå§‹å›¾ç‰‡è¿›è¡Œè®­ç»ƒ , å½“ç„¶å¦‚æœä¸€å®šè¦ä½¿ç”¨åŸå§‹å›¾ç‰‡è¿›è¡Œè®­ç»ƒ, ä¹Ÿå¯ä»¥ä½¿ç”¨ transforms æ¨¡å— ä¸€èˆ¬æ¥è¯´, è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„ transforms æ˜¯ä¸åŒçš„, å› ä¸ºæˆ‘ä»¬å¸Œæœ›éªŒè¯é›†å’Œæµ‹è¯•é›†çš„å›¾ç‰‡è´´åˆçœŸå®çš„æƒ…å†µ ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å®šä¹‰ transforms åœ¨å®šä¹‰å®Œ transforms æˆ‘ä»¬å°±å¯ä»¥å®Œå…¨å®šä¹‰æˆ‘ä»¬çš„ Dataset å’Œ Dataloader äº† 123456789101112131415161718192021222324252627282930import torchfrom torchvision import transforms# å®šä¹‰transform# transforms.Compose(transforms) å®é™…ä¸Šå°±æ˜¯å°†å¤šä¸ª transform æ–¹æ³•å˜ä¸ºé€æ­¥æ‰§è¡Œ, ä¸€èˆ¬æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å¯¹å›¾ç‰‡è¿›è¡Œè¿ç»­çš„å˜æ¢train_transform = transforms.Compose([ transforms.RandomHorizontalFlip(), # éšæœºæ°´å¹³ç¿»è½¬ transforms.RandomVerticalFlip(), # éšæœºå‚ç›´ç¿»è½¬ transforms.ColorJitter(brightness=0.1, contrast=0.1, saturation=0.1), # æ”¹å˜å›¾åƒçš„å±æ€§, å°†å›¾åƒçš„brightnessäº®åº¦/contrastå¯¹æ¯”åº¦/saturationé¥±å’Œåº¦/hueè‰²ç›¸ éšæœºå˜åŒ–ä¸ºåŸå›¾äº®åº¦çš„ 10% transforms.RandomResizedCrop(224, scale=(0.8, 1.0)), # å¯¹å›¾ç‰‡å…ˆè¿›è¡Œéšæœºé‡‡é›†, ç„¶åå¯¹è£å‰ªå¾—åˆ°çš„å›¾åƒç¼©æ”¾ä¸ºåŒä¸€å¤§å°, æ„ä¹‰æ˜¯å³ä½¿åªæ˜¯è¯¥ç‰©ä½“çš„ä¸€éƒ¨åˆ†, æˆ‘ä»¬ä¹Ÿè®¤ä¸ºè¿™æ˜¯è¯¥ç±»ç‰©ä½“ transforms.RandomRotation(40), # åœ¨[-40, 40]èŒƒå›´å†…éšæœºæ—‹è½¬ transforms.RandomAffine(degrees=0, shear=10, scale=(0.8,1.2)), # éšæœºä»¿å°„å˜æ¢ transforms.ColorJitter(brightness=0.2, contrast=0.2, saturation=0.2), # è‰²å½©æŠ–åŠ¨ transforms.ToTensor(), # [é‡ç‚¹] å°†å›¾ç‰‡è½¬åŒ–ä¸º Tensor å¼ é‡, åœ¨ PyTorch ä¸­, ä¸€åˆ‡çš„è¿ç®—éƒ½åŸºäºå¼ é‡, è¯·ä¸€å®šå°†ä½ çš„è¾“å…¥æ•°æ®è½¬åŒ–ä¸ºå¼ é‡ # è¯·ç†è§£ä»€ä¹ˆæ˜¯å¼ é‡ : æˆ‘ä»¬åœ¨çº¿æ€§ä»£æ•°ä¸­æœ‰å‘é‡çš„æ¦‚å¿µ, ç®€å•æ¥è¯´å°±æ˜¯å¼ é‡å°±æ˜¯å‘é‡, åªä¸è¿‡å¼ é‡å¾€å¾€å…·æœ‰æ›´é«˜çš„ç»´åº¦ # è€Œå¤§å®¶ä¸€èˆ¬ä¹ æƒ¯å°†é«˜äºä¸‰ç»´çš„å‘é‡ç§°ä¸ºå¼ é‡, æŸäº›äºº(æ¯”å¦‚æˆ‘)ä¹Ÿä¹ æƒ¯æ‰€æœ‰çš„å‘é‡ç»Ÿç§°ä¸ºå¼ é‡ # å¯ä»¥ç®€å•çš„å°†æ•°ç»„çš„ç»´æ•°æ¥ç•Œå®šå¼ é‡çš„ç»´åº¦ # ä¾‹å¦‚ [ ] ä¸ºä¸€ç»´å¼ é‡, [[ ]] ä¸ºäºŒç»´å¼ é‡, [[[ ]]]ä¸ºä¸‰ç»´å¼ é‡, [[[[ ]]]]ä¸ºå››ç»´å¼ é‡ # å¯¹äºå›¾åƒæ¥è¯´, jpg å›¾åƒå®é™…ä¸ºä¸‰ç»´çŸ©é˜µ, png å›¾åƒå®é™…ä¸ºå››ç»´çŸ©é˜µ, è¿™ä¸ªç»´æ•°æ˜¯æ ¹æ®å›¾åƒçš„é€šé“æ•°è¿›è¡Œåˆ’åˆ†çš„ # ä¾‹å¦‚ jpg æœ‰ Rã€Gã€Bä¸‰ä¸ªé€šé“, png å…·æœ‰ transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), # å½’ä¸€åŒ–, å¯ä»¥å¯¹çŸ©é˜µè¿›è¡Œå½’ä¸€åŒ– # è¯¦ç»†æŸ¥çœ‹è¿™ä¸ªBlog : https://blog.csdn.net/qq_38765642/article/details/109779370 transforms.RandomErasing() # éšæœºæ“¦é™¤])valid_transform = transforms.Compose([ transforms.Resize((256, 256)), # Resize æ“ä½œ, å°†å›¾ç‰‡è½¬æ¢åˆ°æŒ‡å®šçš„å¤§å° transforms.ToTensor(), transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]) 12345678910111213141516171819from torch.utils.data import DataLoader# å®šä¹‰ Dataset å®ä¾‹train_dataset = CustomImageDataset(fake_dir=&quot;./dataset/train/fake&quot;, real_dir=&quot;./dataset/train/real&quot;, transform=train_transform)valid_dataset = CustomImageDataset(fake_dir=&quot;./dataset/valid/fake&quot;, real_dir=&quot;./dataset/valid/real&quot;, transform=valid_transform)# åˆ›å»º DataLoader å®ä¾‹# è¿™é‡Œå°†è¦æ¶‰åŠåˆ°è¶…å‚æ•°çš„æ¦‚å¿µ, ä»€ä¹ˆæ˜¯è¶…å‚æ•°: ç®€å•æ¥å°†, è¶…å‚æ•°å°±æ˜¯æˆ‘ä»¬è‡ªå·±èƒ½æŒ‡å®šçš„ä¸€äº›æ•°æ®, è¶…å‚æ•°çš„é€‰æ‹©å°†å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“æ¨¡å‹çš„æ€§èƒ½# å› æ­¤ æ·±åº¦å­¦ä¹ é¢†åŸŸçš„å·¥ç¨‹å¸ˆ å¸¸ç§°è‡ªå·±ä¸º ç‚¼ä¸¹å¸ˆã€è°ƒå‚å¸ˆç­‰batch_size = 32 # batch_size å°±æ˜¯ä¸€ä¸ªè¶…å‚æ•°, batch å³ä¸º â€œæ‰¹æ¬¡â€, è¡¨ç¤ºä¸€æ¬¡ä½¿ç”¨ DataLoader åŠ è½½å¤šå°‘å¼ å›¾ç‰‡è¿›è¡Œè¿ç®— # è¿™ä¸ªæ•°å€¼å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½, ä¹Ÿä¸æ˜¯è¶Šå°è¶Šå¥½, ä½†æ˜¯å¾€å¾€å¤§ä¸€äº›æ¯”è¾ƒå¥½, è¿™ä¸ªæ•°å­—æœ€å¤§èƒ½é€‰æ‹©å¤šå¤§å’Œä½ çš„å›¾ç‰‡å¤§å°å’Œæ˜¾å¡æ˜¾å­˜æœ‰å¾ˆå¤§çš„å…³ç³» # å½“å‡ºç° [Out Of Memery] é”™è¯¯æ—¶å¾€å¾€è¡¨æ˜ä½ é€‰å–äº†è¿‡å¤§çš„ batch_size, å¯¼è‡´æ˜¾å¡å‡ºç°äº†çˆ†æ˜¾å­˜çš„é—®é¢˜# batch_size : æ¯æ¬¡è®­ç»ƒæ—¶ï¼Œæ¨¡å‹æ‰€çœ‹åˆ°çš„æ•°æ®æ•°é‡ã€‚å®ƒæ˜¯å†³å®šè®­ç»ƒé€Ÿåº¦å’Œå†…å­˜ä½¿ç”¨çš„é‡è¦å‚æ•°ã€‚# shuffle : æ˜¯å¦åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸä¹‹å‰æ‰“ä¹±æ•°æ®é›†çš„é¡ºåºã€‚è¿™å¯¹äºè®¸å¤šæ¨¡å‹ï¼ˆå¦‚å·ç§¯ç¥ç»ç½‘ç»œï¼‰æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æ¨¡å‹é¿å…æ¨¡å¼è¯†åˆ«ã€‚# sampler : å®šä¹‰å¦‚ä½•ä»æ•°æ®é›†ä¸­æŠ½æ ·ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä½¿ç”¨éšæœºé‡‡æ ·ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ›´å¤æ‚çš„é‡‡æ ·ç­–ç•¥ï¼Œå¦‚å­¦ä¹ ç‡è°ƒåº¦é‡‡æ ·ã€‚# batch_sampler : ä¸samplerç±»ä¼¼ï¼Œä½†å®ƒåœ¨æ‰¹å¤„ç†çº§åˆ«ä¸Šè¿›è¡Œé‡‡æ ·ï¼Œè€Œä¸æ˜¯åœ¨æ•´ä¸ªæ•°æ®é›†ä¸Šã€‚è¿™å¯¹äºå†…å­˜ä½¿ç”¨æ•ˆç‡æ›´é«˜çš„åœºæ™¯å¾ˆæœ‰ç”¨ã€‚# num_workers : å®šä¹‰äº†å¤šå°‘ä¸ªå·¥ä½œè¿›ç¨‹ç”¨äºæ•°æ®çš„åŠ è½½ã€‚è¿™å¯ä»¥åŠ å¿«æ•°æ®åŠ è½½çš„é€Ÿåº¦ï¼Œä½†éœ€è¦æ³¨æ„å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=True)valid_loader = DataLoader(valid_dataset, batch_size=batch_size, shuffle=False) 1234567891011# æŸ¥çœ‹Dataloaderæ•°æ®# ä¸ºäº†äº†è§£Dataloaderä¸­çš„æ•°æ®, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥æŸ¥çœ‹:# ä½¿ç”¨ Python çš„ len() å‡½æ•° : æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ len() å‡½æ•°è·å– Dataloader çš„é•¿åº¦, å³æ•°æ®é›†ä¸­æ•°æ®å—çš„æ•°é‡# ä½¿ç”¨ torch.utils.data.DataLoader.len() æ–¹æ³• : è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè¿”å›Dataloaderçš„é•¿åº¦ã€‚# ä½¿ç”¨ iter() å‡½æ•°ï¼šDataloaderæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡iter()å‡½æ•°å¯¹å…¶è¿›è¡Œè¿­ä»£ï¼Œä»¥è·å–æ¯ä¸ªæ‰¹æ¬¡çš„æ•°æ®ã€‚# ä½¿ç”¨torchvision.utils.save_image()å‡½æ•° : å¦‚æœæˆ‘ä»¬æ­£åœ¨å¤„ç†çš„æ˜¯å›¾åƒæ•°æ®é›†ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥ä¿å­˜Dataloaderä¸­çš„å›¾åƒæ•°æ®ã€‚ len(train_loader) # 401len(valid_loader) # 100images, labels = next(iter(train_loader))print(images)print(labels) æ„å»ºæ¨¡å‹ æ„å»ºæ¨¡å‹æ˜¯æ¯”è¾ƒé‡è¦çš„ä¸€éƒ¨åˆ†, ä¸€èˆ¬æ¥è¯´åšå¥½æ•°æ®é›†ä¹‹å, æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯ä¿®æ”¹æ¨¡å‹, é€šè¿‡è®­ç»ƒç»“æœæ”¹è¿›æ¨¡å‹, åˆ¤æ–­è‡ªå·±çš„æ¨¡å‹çš„æ­£ç¡®æ€§, è¿™é‡Œå°±æ˜¯æ•´ä¸ªä½ è¦ç”¨åˆ°çš„ç¥ç»ç½‘ç»œçš„éƒ¨åˆ† , éœ€è¦æ³¨æ„çš„æ˜¯ , è¿™é‡ŒæŒ‡å®šä»€ä¹ˆè¾“å…¥ , æ¨ç†çš„æ—¶å€™å°±è¦æŒ‡å®šä»€ä¹ˆè¾“å…¥ ç®€å•ç”¨å‡ ä¸ªç¬¦å·è¯´æ˜ä¸€ä¸‹å°±æ˜¯: $^{Train} model (inputX, inputY, â€¦)$ â†’ $^{Valid} model (inputX, inputY, â€¦)$ å¦‚ä½•ç¡®å®šè¾“å…¥æ˜¯ä»€ä¹ˆ: çœ‹ forward() çš„è¾“å…¥æ˜¯å•¥æ¨¡å‹çš„è¾“å…¥å°±æ˜¯å•¥ æˆ‘ä¸‹é¢å±•ç°äº†æˆ‘å¤ç°çš„ ResNet50 , ç”¨è¿™ç§æ–¹å¼å¯ä»¥é¡ºä¾¿æ•™ä½ å¦‚ä½•å¤ç°ç½‘ç»œç»“æ„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140import torch.nn as nnfrom torch.nn import functional as F# è¿™é‡Œæ˜¯å¯¹ ResNet50 çš„å®ç°, è¯·å¯¹ç…§è®ºæ–‡æ¥è¿›è¡Œå¯¹ç…§é˜…è¯»# å®šä¹‰ ResNet50Basicç±», è¿™é‡Œå¹¶ä¸æ˜¯å®Œæ•´çš„æ¨¡å‹, è€Œæ˜¯æ¨¡å‹çš„ä¸€ä¸ªéƒ¨åˆ†class ResNet50BasicBlock(nn.Module): def __init__(self, in_channel, outs, kernerl_size, stride, padding): # super(ResNet50BasicBlock, self).__init__() è¿™é‡Œæ˜¯å¹²ä»€ä¹ˆçš„? # 1. é¦–å…ˆæ‰¾åˆ° ResNet50BasicBlock çš„çˆ¶ç±», è¿™é‡Œæ˜¯ nn.Module # 2. æŠŠç±» ResNet50BasicBlock çš„å¯¹è±¡selfè½¬æ¢ä¸º nn.Module çš„å¯¹è±¡ # 3. &quot;è¢«è½¬æ¢&quot;çš„ nn.Module å¯¹è±¡è°ƒç”¨è‡ªå·±çš„ init å‡½æ•° # ç®€å•ç†è§£ä¸€ä¸‹å°±æ˜¯ : å­ç±»æŠŠçˆ¶ç±»çš„ __init__ æ”¾åˆ°è‡ªå·±çš„ __init__ å½“ä¸­, è¿™æ ·å­ç±»å°±æœ‰äº†çˆ¶ç±»çš„ __init__ çš„é‚£äº›ä¸œè¥¿ super(ResNet50BasicBlock, self).__init__() # è¿™é‡Œåªæ˜¯å®šä¹‰éƒ¨åˆ†, åœ¨è¿™é‡Œçš„å®šä¹‰å¹¶ä¸ä¸€å®šä¼šåœ¨æ¨ç†è¿‡ç¨‹ä¸­ä½¿ç”¨ self.conv1 = nn.Conv2d(in_channel, outs[0], kernel_size=kernerl_size[0], stride=stride[0], padding=padding[0]) self.bn1 = nn.BatchNorm2d(outs[0]) self.conv2 = nn.Conv2d(outs[0], outs[1], kernel_size=kernerl_size[1], stride=stride[0], padding=padding[1]) self.bn2 = nn.BatchNorm2d(outs[1]) self.conv3 = nn.Conv2d(outs[1], outs[2], kernel_size=kernerl_size[2], stride=stride[0], padding=padding[2]) self.bn3 = nn.BatchNorm2d(outs[2]) # è¾“å…¥æ˜¯å•¥çœ‹ forward(), ä¾‹å¦‚è¿™é‡Œæ˜¯ forward(self, x), åˆ™è¡¨ç¤ºè¾“å…¥æ˜¯ x, ä¹Ÿå°±æ˜¯ä¸€ä¸ª def forward(self, x): # nn.Conv2d æ˜¯å·ç§¯å±‚, è¯·äº†è§£[1]ä»€ä¹ˆæ˜¯å·ç§¯å±‚, ä»¥åŠ[2]å·ç§¯å±‚æ˜¯å¹²å•¥ç”¨çš„, [3]å·ç§¯åä¼šå˜æˆä»€ä¹ˆ # å·ç§¯è¿ç®—çš„ç›®çš„æ˜¯æå–è¾“å…¥çš„ä¸åŒç‰¹å¾, ç¬¬ä¸€å±‚å·ç§¯å±‚å¯èƒ½åªèƒ½æå–ä¸€äº›ä½çº§çš„ç‰¹å¾å¦‚è¾¹ç¼˜ã€çº¿æ¡å’Œè§’ç­‰å±‚çº§, æ›´å¤šå±‚çš„ç½‘è·¯èƒ½ä»ä½çº§ç‰¹å¾ä¸­è¿­ä»£æå–æ›´å¤æ‚çš„ç‰¹å¾ out = self.conv1(x) # [*] ä»€ä¹ˆæ˜¯ ReLU, ReLUæ˜¯æ¿€æ´»å‡½æ•°, è¯·äº†è§£ [1]ä»€ä¹ˆæ˜¯æ¿€æ´»å‡½æ•°, [2]ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¿€æ´»å‡½æ•° # [*] ä»€ä¹ˆæ˜¯ Batch Normalizationå±‚, BN å±‚æ˜¯æ‰¹æ¬¡å½’ä¸€åŒ–å±‚ out = F.relu(self.bn1(out)) out = self.conv2(out) out = F.relu(self.bn2(out)) out = self.conv3(out) out = self.bn3(out) return F.relu(out + x)# å®šä¹‰ ResNet50DownBlockç±», è¿™é‡Œå¹¶ä¸æ˜¯å®Œæ•´çš„æ¨¡å‹, è€Œæ˜¯æ¨¡å‹çš„ä¸€ä¸ªéƒ¨åˆ†class ResNet50DownBlock(nn.Module): def __init__(self, in_channel, outs, kernel_size, stride, padding): super(ResNet50DownBlock, self).__init__() self.conv1 = nn.Conv2d(in_channel, outs[0], kernel_size=kernel_size[0], stride=stride[0], padding=padding[0]) self.bn1 = nn.BatchNorm2d(outs[0]) self.conv2 = nn.Conv2d(outs[0], outs[1], kernel_size=kernel_size[1], stride=stride[1], padding=padding[1]) self.bn2 = nn.BatchNorm2d(outs[1]) self.conv3 = nn.Conv2d(outs[1], outs[2], kernel_size=kernel_size[2], stride=stride[2], padding=padding[2]) self.bn3 = nn.BatchNorm2d(outs[2]) self.extra = nn.Sequential( nn.Conv2d(in_channel, outs[2], kernel_size=1, stride=stride[3], padding=0), nn.BatchNorm2d(outs[2]) ) def forward(self, x): x_shortcut = self.extra(x) out = self.conv1(x) out = self.bn1(out) out = F.relu(out) out = self.conv2(out) out = self.bn2(out) out = F.relu(out) out = self.conv3(out) out = self.bn3(out) return F.relu(x_shortcut + out)class ResNet50(nn.Module): def __init__(self): super(ResNet50, self).__init__() self.conv1 = nn.Conv2d(3, 64, kernel_size=7, stride=2, padding=3) self.maxpool = nn.MaxPool2d(kernel_size=3, stride=2, padding=1) # Sequential ç±»æ˜¯ torch.nn æ¨¡å—ä¸­çš„ä¸€ä¸ªå®¹å™¨, å¯ä»¥å°†å¤šä¸ªå±‚å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­, æ–¹ä¾¿é¡ºåºè¿æ¥ self.layer1 = nn.Sequential( ResNet50DownBlock(64, outs=[64, 64, 256], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50BasicBlock(256, outs=[64, 64, 256], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50BasicBlock(256, outs=[64, 64, 256], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ) self.layer2 = nn.Sequential( ResNet50DownBlock(256, outs=[128, 128, 512], kernel_size=[1, 3, 1], stride=[1, 2, 1, 2], padding=[0, 1, 0]), ResNet50BasicBlock(512, outs=[128, 128, 512], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50BasicBlock(512, outs=[128, 128, 512], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50DownBlock(512, outs=[128, 128, 512], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]) ) self.layer3 = nn.Sequential( ResNet50DownBlock(512, outs=[256, 256, 1024], kernel_size=[1, 3, 1], stride=[1, 2, 1, 2], padding=[0, 1, 0]), ResNet50BasicBlock(1024, outs=[256, 256, 1024], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50BasicBlock(1024, outs=[256, 256, 1024], kernerl_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50DownBlock(1024, outs=[256, 256, 1024], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50DownBlock(1024, outs=[256, 256, 1024], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50DownBlock(1024, outs=[256, 256, 1024], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]) ) self.layer4 = nn.Sequential( ResNet50DownBlock(1024, outs=[512, 512, 2048], kernel_size=[1, 3, 1], stride=[1, 2, 1, 2], padding=[0, 1, 0]), ResNet50DownBlock(2048, outs=[512, 512, 2048], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]), ResNet50DownBlock(2048, outs=[512, 512, 2048], kernel_size=[1, 3, 1], stride=[1, 1, 1, 1], padding=[0, 1, 0]) ) self.avgpool = nn.AvgPool2d(kernel_size=7, stride=1, ceil_mode=False) # self.avgpool = nn.AdaptiveAvgPool2d(output_size=(1, 1)) self.fc = nn.Linear(2048, 10) # ä½¿ç”¨å·ç§¯ä»£æ›¿å…¨è¿æ¥ self.conv11 = nn.Conv2d(2048, 10, kernel_size=1, stride=1, padding=0) def forward(self, x): out = self.conv1(x) out = self.maxpool(out) out = self.layer1(out) out = self.layer2(out) out = self.layer3(out) out = self.layer4(out) # avgpool å¹³å‡æ± åŒ–å±‚, äº†è§£ä»€ä¹ˆæ˜¯å¹³å‡æ± åŒ–å±‚ out = self.avgpool(out) out = self.conv11(out) out = out.reshape(x.shape[0], -1) # out = self.fc(out) return out# è¿™é‡Œå±•ç°äº†å¯¹ ResNet çš„ä¸€ä¸ªå…·ä½“çš„åº”ç”¨# x = torch.randn(1, 3, 224, 224) # è¿™ä¸ªæ˜¯æˆ‘ä»¬ ResNet50 æœŸå¾…çš„è¾“å…¥æ ·å­, å¯ä»¥çœ‹åˆ°ä»–æ˜¯ [1] ä¸ª [3] é€šé“, å®½åº¦ä¸º[224], é«˜åº¦ä¸º [224]çš„å¼ é‡ image_path = './dataset/test/fake/test_fake_1.png'image = Image.open(image_path).convert('RGB') # å›¾ç‰‡åŠ è½½transform = transforms.ToTensor() # å°†å›¾ç‰‡è½¬åŒ–ä¸ºå¼ é‡, æ­¤æ—¶çš„ å¼ é‡çš„å½¢çŠ¶ä¸º[3, 1024, 1024]# å½“è¾“å…¥æ•°æ®çš„ç»´åº¦ä¸è¶³æ—¶, æˆ‘ä»¬å¯ä»¥é€šè¿‡ unsqueeze() æ·»åŠ ç»´åº¦, è¿™ä¸ªä¸œè¥¿ç®€å•ç†è§£ä¸€ä¸‹å°±æ˜¯, åœ¨æŸä¸ªç»´åº¦å¤–é¢åŠ æ‹¬å·[], å³å¯æ‹“å±•å‡ºæ›´é«˜çš„ç»´åº¦img_tensor = transform(image).unsqueeze(dim=0)# print(x.shape) æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ shape æ¥æŸ¥çœ‹ä¸€ä¸ªå¼ é‡çš„å½¢çŠ¶# print(img_tensor.shape)# è¿™é‡ŒåŠ è½½æˆ‘ä»¬çš„ç½‘ç»œæ¶æ„net = ResNet50()# è¿™é‡Œè¿›è¡Œè¾“å…¥, è¾“å…¥ img_tensor, è¿›å…¥ forword() éƒ¨åˆ†, ç„¶åå¾—åˆ°æœ€ç»ˆè¾“å‡ºçš„ç»“æœout = net(img_tensor)print(out) 1234567891011121314151617181920212223242526import torchfrom torchvision import models# è¿™é‡Œä¸ºäº†æ–¹ä¾¿, æˆ‘ä»¬ç›´æ¥åŠ è½½ PyTorch é¢„è®­ç»ƒå¥½çš„ ResNet50 çš„æ¨¡å‹# PyTorch å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸å°‘å·²ç»é¢„è®­ç»ƒå¥½çš„æ¨¡å‹, æˆ‘ä»¬åªéœ€è¦åŠ è½½ä»–ä»¬ä¸è®­ç»ƒå¥½çš„æ¨¡å‹å³å¯# ä½†æ˜¯æˆ‘è¿˜æ˜¯å¸Œæœ›ä½ å¯ä»¥æŒæ¡ä¸Šé¢è¿™ç§è‡ªå®šä¹‰æ¨¡å‹çš„æ–¹æ³•, è¿™æ ·é‡åˆ° PyTorch æœªæä¾›çš„æ¨¡å‹, æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•è‡ªå·±å®ç°è¯¥æ¨¡å‹model = models.resnet50(pretrained=True)# å†»ç»“å‚æ•° : å³ä¸æ›´æ–°æ¨¡å‹çš„å‚æ•°# å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç , è¿™é‡Œè¡¨ç¤ºå†»ç»“äº†æ‰€æœ‰å±‚for param in model.parameters(): param.requires_grad = False# ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢å±‚æ¥æ¥è§¦æŸäº›å±‚çš„å†»ç»“num_ftrs = model.fc.in_features # è¿™é‡Œæ˜¯è·å– ResNet50 çš„ fc å±‚çš„è¾“å…¥ç‰¹å¾æ•°model.fc = torch.nn.Linear(num_ftrs, 2) # è¿™é‡Œæ˜¯å¯¹ fc å±‚è¿›è¡Œä¿®æ”¹, Linear(input_feather_num, output_feather_num) # è¿™é‡Œè¾“å…¥ç‰¹å¾æ•°æ˜¯ num_ftrs, è¾“å‡ºç‰¹å¾æ•°ä¸º 2 # è¿™ä¸€è¡Œå¾ˆé‡è¦, æŒ‡å®šäº†æ¨¡å‹çš„ä½ç½®, cuda å¯ä»¥ç†è§£ä¸º GPU è®¾å¤‡, cuda: 0 è¡¨ç¤ºä½¿ç”¨ç¼–å·ä¸º 0 çš„GPUè¿›è¡Œè®­ç»ƒ# å½“æœ‰å¤šå— GPU æ—¶, å¯ä»¥ç”¨å…¶ä»–çš„æ–¹å¼æŒ‡å®š GPU# model = torch.nn.DataParallel(model, device_ids=[0, 1, 2]), å½“ç„¶å‘æˆ‘ä»¬è¿™ç§å°ç™½(ç©·B), å½“ç„¶è¿˜æ˜¯å•å¡ä¸ºä¸»# ä¸ºäº†é¿å…å‡ºç°å¤šå¡çš„æƒ…å†µ, æˆ‘åœ¨ä¸‹é¢æ”¾å…¥ä¸¤ç¯‡åšå®¢, æœ‰å…´è¶£å¯ä»¥å‚è€ƒè¿™ä¸¤ç¯‡æ–‡ç« è¿›è¡Œå¤šå¡è®­ç»ƒ# https://zhuanlan.zhihu.com/p/102697821# https://blog.csdn.net/qq_34243930/article/details/106695877device = torch.device(&quot;cuda:0&quot; if torch.cuda.is_available() else &quot;cpu&quot;)model = model.to(device) è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹ è¿™é‡Œéœ€è¦ç›´æ¥å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒ , ä¸€èˆ¬æ¥è¯´ , åœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šåŠ å…¥ tqdm åº“ä½¿å¾—è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ– , æœ‰æ—¶æˆ‘ä»¬è¿˜ä¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜æ›´å¥½çš„è®­ç»ƒç»“æœ , å¹¶ä¸”è®¾ç½®æ–­ç‚¹è®­ç»ƒç­‰æ“ä½œ , æˆ‘åªä½¿ç”¨æœ€ç®€å•çš„æ–¹å¼è¿›è¡Œé¢„æµ‹ train éƒ¨åˆ†çš„ä»£ç å› äººè€Œå¼‚, åŸºæœ¬ä¸Šæ¯ä¸ªäººçš„å†™æ³•éƒ½å¯èƒ½ä¸åŒ, æ²¡æœ‰å›ºå®šçš„å†™æ³• å¯¹äºè®­ç»ƒå®Œçš„æ¨¡å‹æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œè¯„ä»·, ä¸€èˆ¬æ¥è¯´, è®­ç»ƒå’ŒéªŒè¯éƒ½æ˜¯æ”¾åœ¨ä¸€èµ·çš„, ä¸å¯åˆ†å¼€çš„ è®°å¾—ä¿å­˜ä¸€ä¸‹è®­ç»ƒåçš„æ¨¡å‹, ä½¿ç”¨å¦‚ä¸‹ä»£ç ä¿å­˜/åŠ è½½æ•´ä¸ªæ¨¡å‹123456# ä¿å­˜æ¨¡å‹model_path = &quot;xxxx.pth&quot; # xxxx è¡¨ç¤ºä¸€ä¸ªä½ å–œæ¬¢çš„åå­—torch.save(model, model_path) # ä½¿ç”¨ torch.save(model, model_path) ä¿å­˜æ¨¡å‹# åŠ è½½æ¨¡å‹model = torch.load(model_path) # ä½¿ç”¨ torch.load(model_path) å³å¯åŠ è½½æ¨¡å‹ å®Œæ•´çš„â€è®­ç»ƒæ¨¡å‹ + éªŒè¯æ¨¡å‹â€ä»£ç å¦‚ä¸‹: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970from tqdm import tqdmfrom sklearn.metrics import f1_score, accuracy_score# å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨# è¿™é‡ŒåŒ…å«äº† PyTorch çš„ 19 ç§æŸå¤±å‡½æ•° https://blog.csdn.net/qq_35988224/article/details/112911110criterion = torch.nn.CrossEntropyLoss()optimizer = torch.optim.Adam(model.parameters())# è®¡ç®— F1 å€¼å’Œ å‡†ç¡®ç‡def evaluate(loader, model): preds = [] targets = [] loop = tqdm(loader, total=len(loader), leave=True) for images, labels in loop: images, labels = images.to(device), labels.to(device) with torch.no_grad(): outputs = model(images) _, predicted = torch.max(outputs, 1) preds.extend(predicted.cpu().numpy()) targets.extend(labels.cpu().numpy()) # Update the progress bar loop.set_description(&quot;Evaluating&quot;) return f1_score(targets, preds), accuracy_score(targets, preds)# è®­ç»ƒå¾ªç¯best_f1 = 0.0loss_values = []num_epochs = 10 # å®šä¹‰è®­ç»ƒçš„è½®æ¬¡for epoch in range(num_epochs): model.train() # å°†æ¨¡å‹è®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼ loop = tqdm(train_loader, total=len(train_loader), leave=True) print(loop) for images, labels in loop: images, labels = images.to(device), labels.to(device) # å‰å‘æ¨ç† outputs = model(images) loss = criterion(outputs, labels) # åå‘ä¼ æ’­åŠä¼˜åŒ– # åœ¨ç”¨ PyTorchè®­ç»ƒæ¨¡å‹æ—¶, é€šå¸¸ä¼šåœ¨éå† Epochs çš„è¿‡ç¨‹ä¸­ä¾æ¬¡ç”¨åˆ° # optimizer.zero_grad() : å…ˆå°†æ¢¯åº¦å½’é›¶ # loss.backward() : åå‘ä¼ æ’­è®¡ç®—å¾—åˆ°æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦å€¼ # optimizer.step() : é€šè¿‡æ¢¯åº¦ä¸‹é™æ‰§è¡Œä¸€æ­¥å‚æ•°æ›´æ–° # å¯¹äºè¿™ä¸‰ä¸ªå‡½æ•°, è¿™ç¯‡åšå®¢å†™çš„å¾ˆå¥½ : https://blog.csdn.net/PanYHHH/article/details/107361827 # å¯ä»¥ç®€å•é˜…è¯»ä¸€é optimizer.zero_grad() loss.backward() optimizer.step() # ä¿å­˜è¯¥æ‰¹æ¬¡çš„æŸå¤± loss_values.append(loss.item()) # æ›´æ–°è¿›åº¦æ¡ loop.set_description(f&quot;Epoch [{epoch + 1}/{num_epochs}]&quot;) loop.set_postfix(loss=loss.item()) # åœ¨æ¯è½®ä¹‹åéªŒè¯æ¨¡å‹ model.eval() # å°†æ¨¡å‹è®¾ç½®ä¸ºæ¨ç†æ¨¡å¼, æ­¤æ—¶æ¨¡å‹ä¸­çš„å‚æ•°ä¸ä¼šè¿›è¡Œæ›´æ–°, å³å®Œå…¨ç”¨äºæ¨ç†/éªŒè¯ f1_value, accuracy = evaluate(valid_loader, model) print(f'F1 score: {f1_value:.4f}, Accuracy: {accuracy:.4f}') # ä¿å­˜ F1 å€¼æœ€é«˜çš„æ¨¡å‹ if f1_value &gt; best_f1: best_f1 = f1_value # è¿™é‡Œå’Œä¸Šé¢ Markdown çš„ä¿å­˜æ–¹å¼ä¸åŒ, model.state_dict(), è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°, ç®€å•æ¥è¯´å‘¢æˆ‘ä»¬ä»…ä»…ä¿å­˜äº†æ¨¡å‹çš„å‚æ•°, ä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰ä¿å­˜æ¨¡å‹çš„ç»“æ„ # ä¸Šé¢ Markdown çš„ä¿å­˜æ–¹å¼æ˜¯å³ä¿å­˜äº†æ•´ä¸ªæ¨¡å‹çš„ç»“æ„, ä¹Ÿä¿å­˜äº†æ¨¡å‹çš„å‚æ•° torch.save(model.state_dict(), 'best_model.pth')print('è®­ç»ƒç»“æŸ') å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ç»˜å›¾å‡½æ•°ï¼Œæ¥å±•ç¤ºè¿‡ç¨‹ä¸­çš„ç›¸å…³æ•°æ®ã€‚ 12345678910import matplotlib.pyplot as pltplt.figure(figsize=(12, 8))plt.plot(loss_values, label='Train Loss')plt.title('Loss values over epochs')plt.xlabel('Epochs')plt.ylabel('Loss')plt.legend()plt.grid(True)plt.show() æ¨ç†æ¨¡å‹ å¾ˆé«˜å…´, å¦‚æœä½ åˆ°è¿™ä¸€æ­¥, ä½ çš„æ°´å¹³è‚¯å®šå·²ç»æœ‰äº†è´¨çš„é£è·ƒ, è¿™é‡Œå·²ç»æ˜¯æœ€åä¸€æ­¥äº†, ç»“æŸè¿™ä¸ªéƒ¨åˆ†, ä½ å°±è¦å¼€å§‹è‡ªå·±çš„æ¢ç´¢ä¹‹è·¯äº† æ¨ç†æ¨¡å‹å¾ˆç®€å•, æˆ‘åœ¨ä¸Šé¢è¯´è¿‡, æ„é€ æ¨¡å‹æ—¶æŒ‡å®šä»€ä¹ˆè¾“å…¥ , æ¨ç†çš„æ—¶å€™å°±è¦æŒ‡å®šä»€ä¹ˆè¾“å…¥, è¿™é‡Œå°±æ˜¯å¯¹åº”çš„éƒ¨åˆ†äº† 1234567891011121314151617181920212223242526272829303132from torchvision.transforms import ToTensor, Resize, Normalize# predict_by_file è¡¨ç¤ºæ¨ç†ä¸€ä¸ªæ–‡ä»¶, æˆ‘ä»¬éœ€è¦ä¼ å…¥æ–‡ä»¶è·¯å¾„ä»¥åŠæ¨¡å‹def predict_by_file(file_path, model): # image = Image.open(file_path).convert('RGB') # è¿™é‡Œçš„ transform æœ‰ä¸æ²¡æœ‰éƒ½æ— æ‰€è°“, çº¯çœ‹å¿ƒæƒ… transform = transforms.Compose([ Resize((256, 256)), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), ]) image = transform(image) # è¿™é‡Œå’Œä¸Šé¢ä¸€æ ·, è¡¨ç¤ºåœ¨æœ€å¤–é¢åŠ ä¸€å±‚æ‹¬å·, ä½¿ [3, 256, 256] å˜ä¸º [1, 3, 256, 256] image = image.unsqueeze(0).to(device) model.eval() with torch.no_grad(): outputs = model(image) # æ¨¡å‹æ¨ç† # torch.max(...) # input (Tensor) â€“ è¾“å…¥å¼ é‡ # dim (int) â€“ æŒ‡å®šçš„ç»´åº¦ _, predicted = torch.max(outputs, 1) # è¿”å›æŒ‡å®šç»´åº¦çš„æœ€å¤§å€¼, å…¶å®è¿™é‡Œåªæœ‰ä¸€ç»´ print(outputs) # tensor([[0.7360, 0.2668]], device='cuda:0') print(outputs.shape) # torch.Size([1, 2]) return &quot;Fake&quot; if predicted.item() == 0 else &quot;Real&quot;path = './dataset/test/real/test_real_7.jpg'print(predict_by_file(path, model))","link":"/2024/03/20/PyTorch%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E6%8C%87%E5%8D%97/"},{"title":"VSCode C++ çš„å®‰è£…å’Œé…ç½®","text":"VSCode C++ çš„å®‰è£…å’Œé…ç½® ä¸‹è½½ VSCodeVSCodeçš„å®‰è£…åœ°å€ : https://code.visualstudio.com/ å®‰è£…å’Œé…ç½® Remote SSH è¿æ¥è¿œç¨‹çš„ Linux æœåŠ¡å™¨ åœ¨ VSCode å®‰è£…æ’ä»¶ Remote-SSH ç‚¹å‡» å·¦ä¸‹è§’â†’è¿æ¥åˆ°ä¸»æœºâ†’é…ç½®SSHä¸»æœºâ†’é€‰æ‹©è¦æ›´æ–°çš„SSHçš„é…ç½®æ–‡ä»¶(C:\\Users\\UserName\\.ssh\\config) é…ç½®æ–‡ä»¶123Host æœåŠ¡å™¨çš„ IP åœ°å€HostName æœåŠ¡å™¨çš„ IP åœ°å€User ç”¨æˆ·å è¿æ¥è¿œç¨‹æœåŠ¡å™¨, æŒ‰ç…§è¦æ±‚é€‰æ‹©æ“ä½œç³»ç»Ÿ, è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç­‰å³å¯(ç¬¬ä¸€æ¬¡è¿æ¥ä¼šè¾ƒæ…¢) é…ç½®å…å¯†ç™»å½• Windows ç³»ç»Ÿä¸‹æŸ¥çœ‹æ˜¯å¦å…·æœ‰ ssh-key : cd C:/Users/UserName/.ssh å¦‚æœæ²¡æœ‰ ssh-key åˆ™ç”Ÿæˆ ssh-key : ssh-keygen -t rsa -b 4096 å¦‚æœæœ‰ ssh-key åˆ™ä¸Šä¼ è‡³ Windows : scp id_rsa.pub UserName@IPAddr:FilePath åœ¨ Linux ç³»ç»Ÿä¸‹è¿›è¡Œç­¾å: cat pubPath &gt;&gt; authorized_keys","link":"/2024/03/27/VSCode-C-%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2024/03/17/hello-world/"}],"tags":[{"name":"é—²èŠ","slug":"é—²èŠ","link":"/tags/%E9%97%B2%E8%81%8A/"},{"name":"è®¡åˆ’","slug":"è®¡åˆ’","link":"/tags/%E8%AE%A1%E5%88%92/"},{"name":"å¼€å‘å·¥å…·","slug":"å¼€å‘å·¥å…·","link":"/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"},{"name":"Git","slug":"Git","link":"/tags/Git/"},{"name":"Axure RP 9","slug":"Axure-RP-9","link":"/tags/Axure-RP-9/"},{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","link":"/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","link":"/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"PyTorch","slug":"PyTorch","link":"/tags/PyTorch/"},{"name":"VSCode","slug":"VSCode","link":"/tags/VSCode/"}],"categories":[{"name":"é—²èŠ","slug":"é—²èŠ","link":"/categories/%E9%97%B2%E8%81%8A/"},{"name":"å¼€å‘å·¥å…·","slug":"å¼€å‘å·¥å…·","link":"/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"},{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","link":"/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"},{"name":"è®¡åˆ’","slug":"é—²èŠ/è®¡åˆ’","link":"/categories/%E9%97%B2%E8%81%8A/%E8%AE%A1%E5%88%92/"},{"name":"Git","slug":"å¼€å‘å·¥å…·/Git","link":"/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git/"},{"name":"Axure RP 9","slug":"å¼€å‘å·¥å…·/Axure-RP-9","link":"/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Axure-RP-9/"},{"name":"PyTorch","slug":"æ·±åº¦å­¦ä¹ /PyTorch","link":"/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/PyTorch/"},{"name":"VSCode","slug":"å¼€å‘å·¥å…·/VSCode","link":"/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/VSCode/"}],"pages":[]}